"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4694],{34517:function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(85893),r=n(67294),s=n(41664),a=n.n(s),l=n(73899);let ButtonLink=e=>{let{href:t,variant:n="secondary",color:r="main0",kind:s="default",size:o="md",disabled:c,children:u,...d}=e,m=(0,i.jsx)(l.zx,{as:c?void 0:"a",variant:n,color:r,kind:s,size:o,disabled:c,...d,children:u});return c?m:(0,i.jsx)(a(),{href:t,passHref:!0,legacyBehavior:!0,children:m})};ButtonLink.displayName="ButtonLink";var o=(0,r.memo)(ButtonLink)},14215:function(e,t,n){n.d(t,{Z:function(){return N}});var i=n(85893),r=n(57833),s=n(67294),a=n(73899),l=n(76696),o=n(77541),c=n(14685),u=n(11163),d=n(80380),m=n(9754),f=n(36924),h=n(36541),p=n(50586),g=n(86780),x=n(64688),v=n(57966),y=n(9911),j=n(47104),w=n(41664),Z=n.n(w);let DomainDetail=e=>{let{domainId:t,showDelete:n=!1}=e,{domain:r,status:w,rules:N,refEntity:U,handleDelete:G,disabledDelete:H,handleUpdate:W,disabledUpdate:J,handleRetry:K,handleCopyHash:V,handleCopyRef:Y}=function(e){let{domainId:t}=e,n=(0,u.useRouter)(),[{connection:{account:i}}]=(0,m.mr)(),{dispatchDeleteEntity:r}=(0,h.w)({entityName:"domain"}),{entities:l}=(0,f.d)({ids:t}),[o]=l||[],c=(0,x.S)(null==o?void 0:o.ref),j=function(e){let[t,n]=(0,s.useState)(void 0),i=(0,d.A)();return(0,s.useEffect)(()=>{if(!i||!e)return;async function request(){if(!i||!e)return;let t=await i.checkStatus(e);n(t)}request();let t=setInterval(request,1e4);return()=>clearInterval(t)},[e,i]),t}(o),w=(0,v.w)(o),Z=(0,d.A)(),{next:N,stop:S,noti:k}=(0,g.A)({}),D=(0,s.useMemo)(()=>!o,[o]),E=(0,s.useCallback)(async()=>{if(!Z)throw p.Z.ConnectYourWallet;if(!o)throw p.Z.DomainNotFound;let e=await Z.getDelSteps(),t=e.map(e=>g.n[e]),i=Z.delSteps(o);try{for(;;){let{done:e}=await i.next();if(e)break;await N(t)}r(o.id),await n.replace(y.cr.console.domain.home)}catch(i){console.error(i);let e=i.message,t=null==i?void 0:i.cause,n="string"==typeof t?t:null==t?void 0:t.message;null==k||k.add({variant:"error",title:"Error",text:e,detail:n})}finally{await S()}},[r,Z,o,N,n,S,k]),P=(0,s.useMemo)(()=>!o,[o]),R=(0,s.useCallback)(()=>{if(!o)throw p.Z.DomainNotFound;let e=new URLSearchParams({name:o.id,target:o.target,ref:o.ref});n.push("".concat(y.cr.console.domain.new,"/?").concat(e.toString()))},[n,o]),T=(0,s.useCallback)(async()=>{if(!Z)throw p.Z.ConnectYourWallet;if(!o)throw p.Z.DomainNotFound;try{await Z.retry(o),await n.replace("/")}catch(e){}},[o,Z,n]),b=(0,a.vx)((null==c?void 0:c.id)||""),C=(0,a.vx)((null==o?void 0:o.ref)||"");return{domain:o,status:j,rules:w,refEntity:c,account:i,handleDelete:E,disabledDelete:D,handleUpdate:R,disabledUpdate:P,handleRetry:T,handleCopyHash:b,handleCopyRef:C}}({domainId:t});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(S,{children:[(0,i.jsxs)(k,{children:[(0,i.jsx)(D,{name:"input-text",className:"text-main0"}),(0,i.jsx)("div",{className:"tp-body2",children:r?r.name||(0,c.zN)(r.id):(0,i.jsx)(j.Z,{width:"10rem"})}),(0,i.jsx)(E,{kind:"secondary",variant:(null==w?void 0:w.status)?"success":"error",children:(null==w?void 0:w.status)?"DOMAIN RECORDS CONFIGURED":"DOMAIN RECORDS NOT CONFIGURED"})]}),(0,i.jsxs)(P,{children:[(0,i.jsx)(a.zx,{kind:"default",variant:"tertiary",size:"md",onClick:()=>W(),disabled:J,children:"Update"}),n&&(0,i.jsx)(a.zx,{kind:"functional",variant:"error",size:"md",onClick:G,disabled:H,children:(0,i.jsx)(a.JO,{name:"trash"})})]})]}),(0,i.jsxs)(a.Jy,{children:[(0,i.jsxs)(R,{children:[(0,i.jsx)(T,{variant:"accent",children:r?y.K_[r.type]:(0,i.jsx)(j.Z,{width:"5rem",height:"1.3rem"})}),(0,i.jsxs)(b,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"NAME"}),r?(0,i.jsx)("a",{className:"tp-body1 fs-16",href:"https://".concat(r.name),target:"_blank",referrerPolicy:"no-referrer",children:(0,i.jsx)(l.Z,{iconName:"square-up-right",children:(0,i.jsx)(o.xv,{children:r.name})})}):(0,i.jsx)(o.xv,{children:(0,i.jsx)(j.Z,{width:"12rem"})})]})]}),(0,i.jsx)(o.Z0,{}),(0,i.jsxs)(C,{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"TARGET"}),(0,i.jsx)("div",{children:(0,i.jsx)(o.xv,{children:r?r.target&&y.Ni[r.target]||"-":(0,i.jsx)(j.Z,{width:"5rem"})})})]}),(0,i.jsxs)(I,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"UPDATED ON"}),(0,i.jsx)("div",{children:r?(0,i.jsx)(o.xv,{className:"fs-10 tp-body1",children:r.date}):(0,i.jsx)(j.Z,{width:"5rem"})})]})]}),(0,i.jsxs)(A,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"REF"}),(0,i.jsx)("div",{children:(0,i.jsx)(l.Z,{iconName:"copy",onClick:Y,children:(0,i.jsx)(o.xv,{children:r?r.ref:(0,i.jsx)(j.Z,{width:"12rem"})})})})]}),w&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z0,{}),(0,i.jsx)(a.DU,{type:"h7",as:"h2",color:"main0",children:"Status"}),(0,i.jsxs)(q,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"STATUS"}),(0,i.jsx)(o.xv,{children:(0,i.jsxs)(_,{children:[(0,i.jsx)(a.vo,{kind:w.status?"success":"warning",title:""}),w.status?"Properly configured":"Manual configuration is required"]})})]}),r&&!w.status&&N&&N.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(M,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"PENDING STEPS"}),N.map(e=>{let t=w.tasks_status[e.name];return(0,i.jsx)(o.xv,{children:(0,i.jsxs)(B,{children:[(0,i.jsx)(a.vo,{kind:t?"success":"warning",title:""}),(0,i.jsx)("div",{children:e.info})]})},e.name)})]}),(0,i.jsxs)(F,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"FINAL STEP"}),(0,i.jsx)(o.xv,{children:"After configuring the domain records you can retry to link them again here"})]}),(0,i.jsx)(L,{children:(0,i.jsx)(a.zx,{onClick:K,size:"md",variant:"secondary",color:"main0",kind:"default",children:"Retry"})})]})]}),r&&U?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z0,{}),(0,i.jsxs)(a.DU,{type:"h7",as:"h2",color:"main0",children:["Linked ",y.Ni[r.target]]}),(0,i.jsxs)(O,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"Target Resource"}),(0,i.jsx)(Z(),{className:"tp-body1 fs-16",href:("instance"===r.target?y.cr.console.computing.instances.home:"confidential"===r.target?y.cr.console.computing.confidentials.home:"program"===r.target?y.cr.console.computing.functions.home:y.cr.console.storage.volumes.home)+"/".concat(U.id),children:(0,i.jsx)(l.Z,{iconName:"square-up-right",children:"Details"})})]}),(0,i.jsxs)(z,{children:[(0,i.jsx)("div",{className:"tp-info text-main0",children:"ITEM HASH"}),(0,i.jsx)(l.Z,{iconName:"copy",onClick:V,children:U.id})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.Z0,{}),(0,i.jsx)(a.DU,{type:"h7",as:"h2",color:"main0",children:"Linked Resource"}),(0,i.jsx)(o.xv,{children:"The target resource is missing or has been deleted. "})]})]})]})};DomainDetail.displayName="DomainDetail";var N=(0,s.memo)(DomainDetail),S=(0,r.ZP)("div")({display:"flex",justifyContent:"space-between",paddingBottom:"1.25rem"}),k=(0,r.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center"}),D=(0,r.ZP)(a.JO)({marginRight:"1rem"}),E=(0,r.ZP)(a.__)({marginLeft:"1rem",marginTop:"0.25rem"}),P=(0,r.ZP)("div")({marginLeft:"0.5rem",display:"flex",flexWrap:"wrap",justifyContent:"flex-end",gap:"0.5rem","@media (min-width: 36rem)":{gap:"1rem"}}),R=(0,r.ZP)("div")({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),T=(0,r.ZP)(a.Vp)({marginRight:"1rem",whiteSpace:"nowrap"}),b=(0,r.ZP)("div")({flex:"1 1 auto"}),C=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex",flexDirection:"row"}),I=(0,r.ZP)("div")({paddingLeft:"3rem"}),A=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),q=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),_=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),M=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),B=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),F=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),L=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),O=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),z=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv14",componentId:"sc-1nvdr5g-0"})({marginTop:"1.25rem",marginBottom:"1.25rem"})},76696:function(e,t,n){n.d(t,{Z:function(){return u}});var i=n(85893),r=n(57833),s=n(67294),a=n(77541),l=n(73899);let o=r.ZP.div.withConfig({displayName:"styles__StyledContainer",componentId:"sc-hdgoyh-0"})(["",""],e=>{let{theme:t}=e;return(0,r.iv)([""," ","{color:",";}&:hover ","{color:",";}"],{display:"flex",cursor:"pointer",alignItems:"center"},c,t.color.purple4,c,t.color.main0)}),c=(0,r.ZP)(l.JO).withConfig({displayName:"styles__StyledIcon",componentId:"sc-hdgoyh-1"})(["",""],e=>{let{theme:t}=e;return(0,r.iv)([""," transition-property:color;transition-duration:","ms;transition-timing-function:",";"],{marginLeft:"0.5rem",cursor:"pointer"},t.transition.duration.fast,t.transition.timing)}),IconText=e=>{let{children:t,onClick:n,iconName:r}=e;return(0,i.jsxs)(o,{onClick:n,children:[(0,i.jsx)(d,{children:t}),(0,i.jsx)(m,{name:r,className:"text-purple4"})]})};IconText.displayName="IconText";var u=(0,s.memo)(IconText),d=(0,r.ZP)(a.xv)({wordBreak:"break-all"}),m=(0,r.ZP)(c).withConfig({displayName:"cmp___StyledStyledIcon",componentId:"sc-3gm8x3-0"})({marginLeft:"0.5rem",cursor:"pointer"})},47104:function(e,t,n){n.d(t,{Z:function(){return l}});var i=n(85893),r=n(67294),s=n(57833);let a=s.ZP.div.withConfig({displayName:"styles__StyledSkeleton",componentId:"sc-1mb8lh3-0"})([""," ",""],{"@keyframes pulse":{"50%":{opacity:".5"}},animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite",borderRadius:"0.375rem"},e=>{let{theme:t,$width:n,$height:i}=e;return(0,s.iv)(["background:",";width:",";height:",";"],t.color.purple3,n,i)}),Skeleton=e=>{let{width:t,height:n="1.1em"}=e;return(0,i.jsx)(a,{$width:t,$height:n})};Skeleton.displayName="Skeleton";var l=(0,r.memo)(Skeleton)},77541:function(e,t,n){n.d(t,{J3:function(){return l},Z0:function(){return s},xv:function(){return a}});var i=n(57833),r=n(73899);let s=i.ZP.hr.withConfig({displayName:"common__Separator",componentId:"sc-4t26wy-0"})([""," border:0;border-top:1px solid ",";opacity:0.3;"],{marginTop:"1.25rem",marginBottom:"1.25rem"},e=>{let{theme:t}=e;return t.color.main0}),a=i.ZP.span.attrs((0,r.PT)("tp-body1 text-text")).withConfig({displayName:"common__Text",componentId:"sc-4t26wy-1"})([""]),l=i.ZP.span.attrs((0,r.PT)("tp-body1 text-disabled")).withConfig({displayName:"common__DisabledText",componentId:"sc-4t26wy-2"})([""])},36541:function(e,t,n){n.d(t,{w:function(){return useDispatchDeleteEntityAction}});var i=n(67294),r=n(9754),s=n(9324);function useDispatchDeleteEntityAction(e){let{entityName:t}=e,[,n]=(0,r.mr)(),a=(0,i.useCallback)(e=>{n(new s.gg({name:t,keys:e}));let i=(0,s.zG)(t);i.forEach(e=>n(e))},[n,t]);return{dispatchDeleteEntity:a}}},57966:function(e,t,n){n.d(t,{w:function(){return useDomainRules}});var i=n(67294),r=n(80380);function useDomainRules(e){let[t,n]=(0,i.useState)(void 0),s=(0,r.A)(),a=null==e?void 0:e.name,l=null==e?void 0:e.target;return(0,i.useEffect)(()=>{if(s){if(!a||!l){n(void 0);return}request()}async function request(){if(!s||!a||!l)return;let e=await s.getRules({name:a,target:l});n(e)}},[a,l,s]),t}},64688:function(e,t,n){n.d(t,{S:function(){return useHashToEntity}});var i=n(67294),r=n(9754),s=n(9911),a=n(14685),l=n(1801);function useHashToEntity(e){let[t,n]=(0,i.useState)(void 0),o=function(e){let[t,n]=(0,i.useState)(void 0),r=(0,l.c)();return(0,i.useEffect)(()=>{if(!e){n(void 0);return}async function fetchMessage(e){if(!r)return;let t=await r.get(e),i=(0,a.gE)(t);n(i)}(async function(e){!function(e){let[,t,i]=e.split("/");return!!("string"==typeof t&&"string"==typeof i&&Object.values(s.py).includes(t))&&(n(t),!0)}(e)&&fetchMessage(e)})(e)},[e,r]),t}(e),c=function(e){let[t]=(0,r.mr)(),{domainManager:n,sshKeyManager:a,volumeManager:l,programManager:o,instanceManager:c,gpuInstanceManager:u,websiteManager:d,confidentialManager:m}=t.manager,f=(0,i.useMemo)(()=>({[s.py.Domain]:n,[s.py.SSHKey]:a,[s.py.Volume]:l,[s.py.Instance]:c,[s.py.GpuInstance]:u,[s.py.Program]:o,[s.py.Website]:d,[s.py.Confidential]:m}),[n,a,l,c,u,o,d,m]);if(e)return f[e]}(o);return(0,i.useEffect)(()=>{if(!e){n(void 0);return}(async function(e){if(!c)return;let t=await c.get(e);n(t)})(e)},[e,c]),t}},80380:function(e,t,n){n.d(t,{A:function(){return useDomainManager}});var i=n(9754);function useDomainManager(){let[e]=(0,i.mr)(),{domainManager:t}=e.manager;return t}},1801:function(e,t,n){n.d(t,{c:function(){return useMessageManager}});var i=n(9754);function useMessageManager(){let[e]=(0,i.mr)(),{messageManager:t}=e.manager;return t}},36924:function(e,t,n){n.d(t,{d:function(){return useRequestDomains}});var i=n(80380),r=n(77205);function useRequestDomains(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.A)();return(0,r.F)({...e,manager:t,name:"domain"})}},77205:function(e,t,n){n.d(t,{F:function(){return useRequestEntities}});var i=n(67294),r=n(9754),s=n(9324),a=n(73899);function useAppStoreEntityRequest(e){let[t,n]=(0,r.mr)();return function(e){let{state:t,dispatch:n,name:r,cacheStrategy:l="overwrite",...o}=e,c=t[r],u=(0,i.useMemo)(()=>{let{entities:e,keys:t,...n}=c;return{data:e,...n}},[c]);return(0,a.QT)({state:u,setState:e=>{switch(l){case"none":break;case"overwrite":n(new s.B9({name:r,state:e}));break;case"merge":n(new s.Wy({name:r,entities:e.data||[]}))}},...o})}({state:t,dispatch:n,...e})}let handleSingleEntityRequest=async function(e,t,n){var i;let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!r&&(null==n?void 0:null===(i=n.entities)||void 0===i?void 0:i.length)){let e=n.entities.find(e=>e.id===t);if(e)return[e]}let s=await e.get(t);return s?[s]:[]},handleMultipleEntitiesRequest=async function(e,t,n){var i;let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t.length)return[];if(!r&&(null==n?void 0:null===(i=n.entities)||void 0===i?void 0:i.length)){let e=n.entities.map(e=>e.id),i=t.every(t=>e.includes(t));if(i)return n.entities.filter(e=>t.includes(e.id))}return e.getAll({ids:t})},handleAllEntitiesRequest=async function(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!i&&(null==t?void 0:null===(n=t.entities)||void 0===n?void 0:n.length)?t.entities:e.getAll({})};function useRequestEntities(e){let{name:t,manager:n,ids:s,triggerDeps:a=[],triggerOnMount:l=!0}=e,[o]=(0,r.mr)(),{account:c}=o.connection;a=[c,s,...a];let u=(0,i.useMemo)(()=>"string"==typeof s?"single":Array.isArray(s)?"multiple":"all",[s]),d=(0,i.useMemo)(()=>{switch(u){case"single":case"multiple":return"merge";case"all":return"overwrite"}},[u]),{data:m,loading:f,request:h}=useAppStoreEntityRequest({name:t,doRequest:async()=>{if(!n)return[];let e=o[t];switch(u){case"single":return handleSingleEntityRequest(n,s,e);case"multiple":return handleMultipleEntitiesRequest(n,s,e);case"all":return handleAllEntitiesRequest(n,e)}},onSuccess:()=>null,flushData:!0,triggerOnMount:l,triggerDeps:a,cacheStrategy:d}),{request:p}=useAppStoreEntityRequest({name:t,doRequest:async()=>{if(!n)return[];let e=o[t];switch(u){case"single":return handleSingleEntityRequest(n,s,e,!0);case"multiple":return handleMultipleEntitiesRequest(n,s,e,!0);case"all":return handleAllEntitiesRequest(n,e,!0)}},onSuccess:()=>null,flushData:!0,triggerOnMount:!1,triggerDeps:[],cacheStrategy:d}),g=(0,i.useMemo)(()=>{if(!m)return m;switch(u){case"single":return m.filter(e=>e.id===s);case"multiple":return m.filter(e=>s.includes(e.id));default:return m}},[m,u,s]);return!function(e){let{entities:t=[],request:n,triggerOnMount:r}=e;(0,i.useEffect)(()=>{if(!r)return;let e=(Array.isArray(t)?t:[t]).filter(e=>!e.confirmed);if(!e.length)return;let i=setInterval(n,1e4);return()=>clearInterval(i)},[t,n,r])}({entities:g,request:h,triggerOnMount:l}),{entities:g,loading:f,refetch:p}}}}]);