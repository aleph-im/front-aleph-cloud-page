"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4215],{14215:function(e,n,i){i.d(n,{Z:function(){return Z}});var t=i(85893),r=i(57833),a=i(67294),s=i(31515),c=i(76696),l=i(77541),o=i(14685),m=i(11163),d=i(80380),h=i(9754),u=i(36924),x=i(36541),g=i(50586),f=i(86780),p=i(64688),j=i(9911),v=i(47104),y=i(41664),N=i.n(y);let DomainDetail=e=>{let{domainId:n,showDelete:i=!1}=e,{domain:r,status:y,refEntity:Z,account:Q,handleDelete:$,disabledDelete:ee,handleUpdate:en,disabledUpdate:ei,handleRetry:et,handleCopyHash:er,handleCopyRef:ea}=function(e){let{domainId:n}=e,i=(0,m.useRouter)(),[{connection:{account:t}}]=(0,h.mr)(),{dispatchDeleteEntity:r}=(0,x.w)({entityName:"domain"}),{entities:c}=(0,u.d)({ids:n}),[l]=c||[],o=(0,p.S)(null==l?void 0:l.ref),v=function(e){let[n,i]=(0,a.useState)(void 0),t=(0,d.A)();return(0,a.useEffect)(()=>{if(!t||!e)return;async function request(){if(!t||!e)return;let n=await t.checkStatus(e);i(n)}request();let n=setInterval(request,1e4);return()=>clearInterval(n)},[e,t]),n}(l),y=(0,d.A)(),{next:N,stop:Z,noti:w}=(0,f.A)({}),P=(0,a.useMemo)(()=>!l,[l]),k=(0,a.useCallback)(async()=>{if(!y)throw g.Z.ConnectYourWallet;if(!l)throw g.Z.DomainNotFound;let e=await y.getDelSteps(),n=e.map(e=>f.n[e]),t=y.delSteps(l);try{for(;;){let{done:e}=await t.next();if(e)break;await N(n)}r(l.id),await i.replace(j.cr.console.home)}catch(t){console.error(t);let e=t.message,n=null==t?void 0:t.cause,i="string"==typeof n?n:null==n?void 0:n.message;null==w||w.add({variant:"error",title:"Error",text:e,detail:i})}finally{await Z()}},[r,y,l,N,i,Z,w]),D=(0,a.useMemo)(()=>!l,[l]),T=(0,a.useCallback)(()=>{if(!l)throw g.Z.DomainNotFound;i.push("".concat(j.cr.console.settings.domain.new,"/?name=").concat(l.id))},[i,l]),C=(0,a.useCallback)(async()=>{if(!y)throw g.Z.ConnectYourWallet;if(!l)throw g.Z.DomainNotFound;try{await y.retry(l),await i.replace("/")}catch(e){}},[l,y,i]),R=(0,s.vx)((null==o?void 0:o.id)||""),E=(0,s.vx)((null==l?void 0:l.ref)||"");return{domain:l,status:v,refEntity:o,account:t,handleDelete:k,disabledDelete:P,handleUpdate:T,disabledUpdate:D,handleRetry:C,handleCopyHash:R,handleCopyRef:E}}({domainId:n});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(w,{children:[(0,t.jsxs)(P,{children:[(0,t.jsx)(k,{name:"input-text",className:"text-main0"}),(0,t.jsx)("div",{className:"tp-body2",children:r?r.name||(0,o.zN)(r.id):(0,t.jsx)(v.Z,{width:"10rem"})}),(0,t.jsx)(D,{kind:"secondary",variant:(null==y?void 0:y.status)?"success":"error",children:(null==y?void 0:y.status)?"DOMAIN RECORDS CONFIGURED":"DOMAIN RECORDS NOT CONFIGURED"})]}),(0,t.jsxs)(T,{children:[(0,t.jsx)(s.zx,{kind:"default",variant:"tertiary",size:"md",onClick:()=>en(),disabled:ei,children:"Update"}),i&&(0,t.jsx)(s.zx,{kind:"functional",variant:"error",size:"md",onClick:$,disabled:ee,children:(0,t.jsx)(s.JO,{name:"trash"})})]})]}),(0,t.jsxs)(s.Jy,{children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(R,{variant:"accent",children:r?j.K_[r.type]:(0,t.jsx)(v.Z,{width:"5rem",height:"1.3rem"})}),(0,t.jsxs)(E,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"NAME"}),r?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:"https://".concat(r.name),target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(c.Z,{iconName:"square-up-right",children:(0,t.jsx)(l.x,{children:r.name})})}):(0,t.jsx)(l.x,{children:(0,t.jsx)(v.Z,{width:"12rem"})})]})]}),(0,t.jsx)(l.Z,{}),(0,t.jsxs)(S,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"TARGET"}),(0,t.jsx)("div",{children:(0,t.jsx)(l.x,{children:r?r.target&&j.Ni[r.target]||"-":(0,t.jsx)(v.Z,{width:"5rem"})})})]}),(0,t.jsxs)(b,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"UPDATED ON"}),(0,t.jsx)("div",{children:r?(0,t.jsx)(l.x,{className:"fs-10 tp-body1",children:r.date}):(0,t.jsx)(v.Z,{width:"5rem"})})]})]}),(0,t.jsxs)(_,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"REF"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.Z,{iconName:"copy",onClick:ea,children:(0,t.jsx)(l.x,{children:r?r.ref:(0,t.jsx)(v.Z,{width:"12rem"})})})})]}),y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{}),(0,t.jsx)(s.DU,{type:"h7",as:"h2",color:"main0",children:"Status"}),(0,t.jsxs)(M,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"STATUS"}),(0,t.jsx)(l.x,{children:(0,t.jsxs)(I,{children:[(0,t.jsx)(s.vo,{kind:y.status?"success":"warning",title:""}),y.status?"Properly configured":"Manual configuration is required"]})})]}),r&&(!y.tasks_status.cname||!y.tasks_status.owner_proof)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(A,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"PENDING STEPS"}),(0,t.jsx)(l.x,{children:(0,t.jsxs)(F,{children:[(0,t.jsx)(s.vo,{kind:y.tasks_status.cname?"success":"warning",title:""}),(0,t.jsxs)("div",{children:["Create a CNAME record",(0,t.jsx)(L,{className:"text-main0",children:r.name}),"with value",r.target==j.sY.Program&&(0,t.jsxs)(O,{className:"text-main0",children:[r.name,".program.public.aleph.sh."]}),[j.sY.Instance,j.sY.Confidential].includes(r.target)&&(0,t.jsxs)(B,{className:"text-main0",children:[r.name,".instance.public.aleph.sh."]}),r.target==j.sY.IPFS&&(0,t.jsx)(q,{className:"text-main0",children:"ipfs.public.aleph.sh."})]})]})}),r.target==j.sY.IPFS&&(0,t.jsx)(l.x,{children:(0,t.jsxs)(U,{children:[(0,t.jsx)(s.vo,{kind:y.tasks_status.delegation?"success":"warning",title:""}),(0,t.jsxs)("div",{children:["Create a CNAME record",(0,t.jsxs)(z,{className:"text-main0",children:["_dnslink.",r.name]}),"with value",(0,t.jsxs)(Y,{className:"text-main0",children:["_dnslink.",r.name,".static.public.aleph.sh."]})]})]})}),(0,t.jsx)(l.x,{children:(0,t.jsxs)(G,{children:[(0,t.jsx)(s.vo,{kind:y.tasks_status.owner_proof?"success":"warning",title:""}),(0,t.jsxs)("div",{children:["Create a TXT owner proof record",(0,t.jsxs)(H,{className:"text-main0",children:["_control.",r.name]}),"with value",(0,t.jsx)(W,{className:"text-main0",children:null==Q?void 0:Q.address})]})]})})]}),(0,t.jsxs)(J,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"FINAL STEP"}),(0,t.jsx)(l.x,{children:"After configuring the domain records you can retry to link them again here"})]}),(0,t.jsx)(K,{children:(0,t.jsx)(s.zx,{onClick:et,size:"md",variant:"secondary",color:"main0",kind:"default",children:"Retry"})})]})]}),r&&Z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{}),(0,t.jsxs)(s.DU,{type:"h7",as:"h2",color:"main0",children:["Linked ",j.Ni[r.target]]}),(0,t.jsxs)(V,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"Target Resource"}),(0,t.jsx)(N(),{className:"tp-body1 fs-16",href:("instance"===r.target?j.cr.console.computing.instances.home:"confidential"===r.target?j.cr.console.computing.confidentials.home:"program"===r.target?j.cr.console.computing.functions.home:j.cr.console.storage.volumes.home)+"/".concat(Z.id),children:(0,t.jsx)(c.Z,{iconName:"square-up-right",children:"Details"})})]}),(0,t.jsxs)(X,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"ITEM HASH"}),(0,t.jsx)(c.Z,{iconName:"copy",onClick:er,children:Z.id})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{}),(0,t.jsx)(s.DU,{type:"h7",as:"h2",color:"main0",children:"Linked Resource"}),(0,t.jsx)(l.x,{children:"The target resource is missing or has been deleted. "})]})]})]})};DomainDetail.displayName="DomainDetail";var Z=(0,a.memo)(DomainDetail),w=(0,r.ZP)("div")({display:"flex",justifyContent:"space-between",paddingBottom:"1.25rem"}),P=(0,r.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center"}),k=(0,r.ZP)(s.JO)({marginRight:"1rem"}),D=(0,r.ZP)(s.__)({marginLeft:"1rem",marginTop:"0.25rem"}),T=(0,r.ZP)("div")({marginLeft:"0.5rem",display:"flex",flexWrap:"wrap",justifyContent:"flex-end",gap:"0.5rem","@media (min-width: 36rem)":{gap:"1rem"}}),C=(0,r.ZP)("div")({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),R=(0,r.ZP)(s.Vp)({marginRight:"1rem",whiteSpace:"nowrap"}),E=(0,r.ZP)("div")({flex:"1 1 auto"}),S=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex",flexDirection:"row"}),b=(0,r.ZP)("div")({paddingLeft:"3rem"}),_=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),M=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),I=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),A=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),F=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),L=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),O=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),B=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),q=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),U=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),z=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),Y=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),G=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),H=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),W=(0,r.ZP)("span")({marginLeft:"0.5rem",marginRight:"0.5rem"}),J=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),K=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),V=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),X=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv16",componentId:"sc-1nvdr5g-0"})({marginTop:"1.25rem",marginBottom:"1.25rem"})},64688:function(e,n,i){i.d(n,{S:function(){return useHashToEntity}});var t=i(67294),r=i(9754),a=i(9911),s=i(14685),c=i(1801);function useHashToEntity(e){let[n,i]=(0,t.useState)(void 0),l=function(e){let[n,i]=(0,t.useState)(void 0),r=(0,c.c)();return(0,t.useEffect)(()=>{if(!e){i(void 0);return}async function fetchMessage(e){if(!r)return;let n=await r.get(e),t=(0,s.gE)(n);i(t)}(async function(e){!function(e){let[,n,t]=e.split("/");return!!("string"==typeof n&&"string"==typeof t&&Object.values(a.py).includes(n))&&(i(n),!0)}(e)&&fetchMessage(e)})(e)},[e,r]),n}(e),o=function(e){let[n]=(0,r.mr)(),{domainManager:i,sshKeyManager:s,volumeManager:c,programManager:l,instanceManager:o,gpuInstanceManager:m,websiteManager:d,confidentialManager:h}=n.manager,u=(0,t.useMemo)(()=>({[a.py.Domain]:i,[a.py.SSHKey]:s,[a.py.Volume]:c,[a.py.Instance]:o,[a.py.GpuInstance]:m,[a.py.Program]:l,[a.py.Website]:d,[a.py.Confidential]:h}),[i,s,c,o,m,l,d,h]);if(e)return u[e]}(l);return(0,t.useEffect)(()=>{if(!e){i(void 0);return}(async function(e){if(!o)return;let n=await o.get(e);i(n)})(e)},[e,o]),n}},80380:function(e,n,i){i.d(n,{A:function(){return useDomainManager}});var t=i(9754);function useDomainManager(){let[e]=(0,t.mr)(),{domainManager:n}=e.manager;return n}},1801:function(e,n,i){i.d(n,{c:function(){return useMessageManager}});var t=i(9754);function useMessageManager(){let[e]=(0,t.mr)(),{messageManager:n}=e.manager;return n}},36924:function(e,n,i){i.d(n,{d:function(){return useRequestDomains}});var t=i(80380),r=i(77205);function useRequestDomains(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.A)();return(0,r.F)({...e,manager:n,name:"domain"})}}}]);