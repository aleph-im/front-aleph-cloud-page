"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6849],{11318:function(e,r,l){l.d(r,{p:function(){return InfoTooltipButton},Z:function(){return h}});var a=l(82729),o=l(85893),d=l(57833),c=l(67294),u=l(31515);let m=(0,d.ZP)(u.zx).attrs(e=>({...e,forwardedAs:"span",onClick:e=>e.preventDefault(),kind:"default",size:"md",variant:"textOnly",color:"main0"})).withConfig({displayName:"styles__StyledInfoTooltipButton",componentId:"sc-15cvlnj-0"})(()=>[{cursor:"help !important"}]);var p=l(43251);function _templateObject(){let e=(0,a._)(["",""]);return _templateObject=function(){return e},e}let InfoTooltipButton=e=>{let{children:r,tooltipContent:l,plain:a,align:d="right",vAlign:u="center",iconSize:m="1em",forwardedAs:h,as:v,...j}=e,[g,Z]=(0,c.useState)(!1);(0,c.useEffect)(()=>{Z(!0)},[]);let P=(0,c.useRef)(null),b=[];switch("left"===d&&b.push({order:"-1"}),u){case"top":b.push({marginBottom:"0.5rem"});break;case"bottom":b.push({marginBottom:"-0.25rem"})}let S=(0,o.jsx)(x,{name:"info-circle",size:m,$_css:b});return(0,o.jsxs)(o.Fragment,{children:[a?(0,o.jsxs)(f,{ref:P,children:[r,S]}):(0,o.jsxs)(y,{ref:P,children:[r,S]}),g&&(0,o.jsx)(p.Z,{...j,targetRef:P,content:l})]})};InfoTooltipButton.displayName="InfoTooltipButton";var h=(0,c.memo)(InfoTooltipButton),x=(0,d.ZP)(u.JO)(_templateObject(),e=>e.$_css),f=(0,d.ZP)("span")({display:"inline-flex",cursor:"help",alignItems:"center",gap:"0.625rem"}),y=(0,d.ZP)(m).withConfig({displayName:"cmp___StyledStyledInfoTooltipButton",componentId:"sc-1jqd2c1-0"})({display:"inline-flex",alignItems:"center",gap:"0.625rem"})},21836:function(e,r,l){l.d(r,{Z:function(){return a.Z}});var a=l(11318)},32424:function(e,r,l){l.d(r,{Z:function(){return b}});var a=l(85893),o=l(57833),d=l(67294),c=l(31515),u=l(28540),m=l(76696),p=l(77541),h=l(14685),x=l(11163),f=l(18395),y=l(68091),v=l(36541),j=l(50586),g=l(86780),Z=l(9911),P=l(47104);let SSHKeyDetail=e=>{let{sshKeyId:r,showDelete:l=!1}=e,{sshKey:b,theme:A,handleCopyKey:M,handleCopyLabel:H,handleDelete:R}=function(e){let{sshKeyId:r}=e,l=(0,o.Fg)(),a=(0,x.useRouter)(),{dispatchDeleteEntity:u}=(0,v.w)({entityName:"ssh"}),{entities:m}=(0,y.X)({ids:r}),[p]=m||[],h=(0,c.vx)((null==p?void 0:p.label)||""),Z=(0,c.vx)((null==p?void 0:p.key)||""),P=(0,f.p)(),{next:b,stop:S,noti:w}=(0,g.A)({}),C=(0,d.useCallback)(async()=>{if(!P)throw j.Z.ConnectYourWallet;if(!p)throw j.Z.SSHKeyNotFound;let e=await P.getDelSteps(p),r=e.map(e=>g.n[e]),l=P.delSteps(p);try{for(;;){let{done:e}=await l.next();if(e)break;await b(r)}u(p.id),await a.replace("/console")}catch(a){console.error(a);let e=a.message,r=null==a?void 0:a.cause,l="string"==typeof r?r:null==r?void 0:r.message;null==w||w.add({variant:"error",title:"Error",text:e,detail:l})}finally{await S()}},[u,P,p,b,a,S,w]);return{sshKey:p,theme:l,handleCopyLabel:h,handleCopyKey:Z,handleDelete:C}}({sshKeyId:r});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(S,{children:[(0,a.jsxs)(w,{children:[(0,a.jsx)(C,{name:"key",className:"text-main0"}),(0,a.jsx)("div",{className:"tp-body2",children:b?b.label||(0,h.zN)(b.id):(0,a.jsx)(P.Z,{width:"10rem"})}),(0,a.jsx)(k,{kind:"secondary",variant:(null==b?void 0:b.confirmed)?"success":"warning",children:b?b.confirmed?"READY":(0,a.jsxs)(N,{children:[(0,a.jsx)(E,{children:"CONFIRMING"}),(0,a.jsx)(u.s5,{strokeColor:A.color.base2,width:".8rem"})]}):"LOADING"})]}),(0,a.jsx)("div",{children:l&&(0,a.jsx)(c.zx,{kind:"functional",variant:"error",size:"md",onClick:R,children:(0,a.jsx)(c.JO,{name:"trash"})})})]}),(0,a.jsxs)(c.Jy,{children:[(0,a.jsxs)(I,{children:[(0,a.jsx)(_,{variant:"accent",children:b?Z.K_[b.type]:(0,a.jsx)(P.Z,{width:"5rem",height:"1.3rem"})}),(0,a.jsxs)(D,{children:[(0,a.jsx)("div",{className:"tp-info text-main0",children:"KEY"}),(0,a.jsx)(m.Z,{iconName:"copy",onClick:M,children:b?b.key:(0,a.jsx)(P.Z,{width:"12rem"})})]})]}),(0,a.jsx)(p.Z,{}),(null==b?void 0:b.label)&&(0,a.jsxs)(F,{children:[(0,a.jsx)("div",{className:"tp-info text-main0",children:"LABEL"}),(0,a.jsx)("div",{children:(0,a.jsx)(m.Z,{iconName:"copy",onClick:H,children:(0,a.jsx)(p.x,{children:null==b?void 0:b.label})})})]}),(0,a.jsxs)(T,{children:[(0,a.jsx)("div",{className:"tp-info text-main0",children:"EXPLORER"}),(0,a.jsx)("div",{children:b?(0,a.jsx)("a",{className:"tp-body1 fs-16",href:b.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,a.jsx)(m.Z,{iconName:"square-up-right",children:(0,a.jsx)(p.x,{children:(0,h.bs)(b.url,80)})})}):(0,a.jsx)(P.Z,{width:"10rem"})})]}),(0,a.jsxs)(O,{children:[(0,a.jsx)("div",{className:"tp-info text-main0",children:"CREATED ON"}),(0,a.jsx)("div",{children:(0,a.jsx)(p.x,{className:"fs-10 tp-body1",children:b?b.date:(0,a.jsx)(P.Z,{width:"4rem"})})})]})]})]})};SSHKeyDetail.displayName="SSHKeyDetail";var b=(0,d.memo)(SSHKeyDetail),S=(0,o.ZP)("div")({display:"flex",justifyContent:"space-between",paddingBottom:"1.25rem"}),w=(0,o.ZP)("div")({display:"flex",alignItems:"center"}),C=(0,o.ZP)(c.JO)({marginRight:"1rem"}),k=(0,o.ZP)(c.__)({marginLeft:"1rem"}),N=(0,o.ZP)("div")({display:"flex",alignItems:"center"}),E=(0,o.ZP)("div")({marginRight:"0.5rem"}),I=(0,o.ZP)("div")({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),_=(0,o.ZP)(c.Vp)({marginRight:"1rem",whiteSpace:"nowrap"}),D=(0,o.ZP)("div")({flex:"1 1 auto"}),F=(0,o.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),T=(0,o.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),O=(0,o.ZP)("div").withConfig({displayName:"cmp___StyledDiv9",componentId:"sc-1leuqyp-0"})({marginTop:"1.25rem",marginBottom:"1.25rem"})},45806:function(e,r,l){l.d(r,{Z:function(){return x}});var a=l(85893),o=l(57833),d=l(67294),c=l(31515),u=l(47104),m=l(77541),p=l(76696),h=l(33697);let EntityConnectionMethods=e=>{let{executableStatus:r}=e,{isLoading:l,formattedIPv4:o,formattedIPv6:x,formattedSSHCommand:v,handleCopyIpv4:j,handleCopyIpv6:g,handleCopyCommand:Z}=function(e){let{executableStatus:r}=e,l=!r,a=(0,d.useMemo)(()=>(null==r?void 0:r.ipv6Parsed)||"",[null==r?void 0:r.ipv6Parsed]),o=(0,d.useMemo)(()=>(null==r?void 0:r.hostIpv4)||"",[null==r?void 0:r.hostIpv4]),u=(0,d.useMemo)(()=>"ssh root@".concat(a),[a]),m=(0,c.vx)(o),p=(0,c.vx)(a),h=(0,c.vx)(u);return{isLoading:l,formattedIPv6:a,formattedIPv4:o,formattedSSHCommand:u,handleCopyIpv6:p,handleCopyIpv4:m,handleCopyCommand:h}}({executableStatus:r});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f,{className:"tp-h7 fs-24",children:"CONNECTION METHODS"}),(0,a.jsx)(c.Jy,{children:(0,a.jsxs)(y,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h.Z,{children:"SSH COMMAND"}),(0,a.jsx)("div",{children:l?(0,a.jsx)(u.Z,{width:"20rem"}):(0,a.jsx)(p.Z,{iconName:"copy",onClick:Z,children:(0,a.jsxs)(m.x,{children:[">_ ",v]})})})]}),(l||""!==o)&&(0,a.jsxs)("div",{children:[(0,a.jsx)(h.Z,{children:"IPV4"}),(0,a.jsx)("div",{children:l?(0,a.jsx)(u.Z,{width:"9rem"}):(0,a.jsx)(p.Z,{iconName:"copy",onClick:j,children:(0,a.jsx)(m.x,{children:o})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(h.Z,{children:"IPV6"}),(0,a.jsx)("div",{children:l?(0,a.jsx)(u.Z,{width:"10rem"}):(0,a.jsx)(p.Z,{iconName:"copy",onClick:g,children:(0,a.jsx)(m.x,{children:x})})})]})]})})]})};EntityConnectionMethods.displayName="EntityConnectionMethods";var x=(0,d.memo)(EntityConnectionMethods),f=(0,o.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),y=(0,o.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1tccgtt-0"})({display:"flex",flexDirection:"column",gap:"1rem"})},78436:function(e,r,l){l.d(r,{Z:function(){return T}});var a=l(85893),o=l(57833),d=l(67294),c=l(31515),u=l(77541),m=l(33697),p=l(68885),h=l(9754);function useForwardedPortsManager(){let[e]=(0,h.mr)(),{forwardedPortsManager:r}=e.manager;return r}var x=l(71251),f=l(87536),y=l(45901),v=l(56312),j=l(24959);let g={ports:[{port:"",udp:!1,tcp:!1}]},Z=y.Ry({port:y.Z_().min(1,"Port is required").refine(e=>{let r=parseInt(e,10);return!isNaN(r)&&r>0&&r<=65535},"Port must be between 1 and 65535"),tcp:y.O7(),udp:y.O7()}).refine(e=>e.tcp||e.udp,"At least one protocol (TCP or UDP) must be selected"),P=y.Ry({ports:y.IX(Z).min(1,"At least one port is required")}),b=d.memo(e=>{let{portCtrl:r,tcpCtrl:l,udpCtrl:o,handleRemove:m}=function(e){let{name:r="ports",index:l,control:a,onRemove:o}=e,c=(0,f.bc)({control:a,name:"".concat(r,".").concat(l,".port")}),u=(0,f.bc)({control:a,name:"".concat(r,".").concat(l,".tcp")}),m=(0,f.bc)({control:a,name:"".concat(r,".").concat(l,".udp")}),p=(0,d.useCallback)(()=>{o(l)},[l,o]);return{portCtrl:c,tcpCtrl:u,udpCtrl:m,handleRemove:p}}(e);return(0,a.jsx)(w,{className:"bg-background",children:(0,a.jsxs)(C,{children:[(0,a.jsxs)(k,{children:[(0,a.jsx)(u.x,{children:"Port"}),(0,a.jsx)(c.oi,{...r.field,...r.fieldState,placeholder:"8080",required:!0,width:"6em",textAlign:"center"})]}),(0,a.jsxs)(N,{children:[(0,a.jsx)(u.x,{children:"TCP"}),(0,a.jsx)(c.XZ,{...l.field,...l.fieldState})]}),(0,a.jsxs)(E,{children:[(0,a.jsx)(u.x,{children:"UDP"}),(0,a.jsx)(c.XZ,{...o.field,...o.fieldState})]}),(0,a.jsx)(I,{children:(0,a.jsx)(c.zx,{type:"button",variant:"warning",kind:"functional",onClick:m,disabled:e.disabled,children:(0,a.jsx)(c.JO,{name:"trash-xmark"})})})]})})});b.displayName="PortItem";let AddPortForm=e=>{let{onSubmit:r,onCancel:l}=e,{name:o,control:u,handleSubmit:m,fields:p,addPortField:h,removePortField:x}=function(e){let{onSubmit:r}=e,l="ports",a=(0,d.useCallback)(async e=>{r(e.ports)},[r]),{control:o,handleSubmit:c}=(0,j.c)({defaultValues:g,resolver:(0,v.F)(P),onSubmit:a}),{fields:u,append:m,remove:p}=(0,f.Dq)({control:o,name:l,shouldUnregister:!0}),h=(0,d.useCallback)(()=>{m({port:"",tcp:!1,udp:!1})},[m]),x=(0,d.useCallback)(e=>{u.length>1&&p(e)},[p,u.length]);return{name:l,control:o,fields:u,handleSubmit:c,addPortField:h,removePortField:x}}({onSubmit:r});return(0,a.jsxs)(_,{onSubmit:m,children:[p.map((e,r)=>(0,a.jsx)(b,{name:o,index:r,control:u,onRemove:x,disabled:1===p.length},e.id)),(0,a.jsxs)(D,{children:[(0,a.jsx)(c.zx,{type:"button",variant:"secondary",kind:"gradient",onClick:h,children:"Add Port"}),(0,a.jsx)(c.zx,{type:"submit",variant:"primary",kind:"gradient",children:"Save"}),(0,a.jsx)(c.zx,{type:"button",variant:"tertiary",onClick:l,children:"Cancel"})]})]})};AddPortForm.displayName="AddPortForm";var S=(0,d.memo)(AddPortForm),w=(0,o.ZP)("div")({marginTop:"0.5rem",width:"fit-content",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:"0.75rem",paddingBottom:"0.75rem"}),C=(0,o.ZP)("div")({display:"flex",alignItems:"center",gap:"1rem"}),k=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),N=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),E=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),I=(0,o.ZP)("div")({marginBottom:"0.25rem",alignSelf:"flex-end"}),_=(0,o.ZP)("form")({marginTop:"0.5rem"}),D=(0,o.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-25x9d1-0"})({marginTop:"1rem",display:"flex",gap:"0.5rem"}),F=l(21836);let EntityPortForwarding=e=>{let{entityHash:r,executableStatus:l,executableManager:o}=e,{showPortForm:f,ports:y,handleAddPort:v,handleCancelAddPort:j,handleRemovePort:g,handleSubmitNewPorts:Z}=function(){let{entityHash:e,executableStatus:r,executableManager:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[a]=(0,h.mr)(),{account:o}=a.connection,c=null==o?void 0:o.address,[u,m]=(0,d.useState)((0,x.yX)()),[f,y]=(0,d.useState)(!1),[v,j]=(0,d.useState)(!1),[g,Z]=(0,d.useState)(null),P=useForwardedPortsManager(),b=(0,d.useCallback)(async()=>{if(!e||!c||!P){m((0,x.yX)());return}try{let r=await P.getByEntityHash(e),l=(null==r?void 0:r.ports)||{},a=(0,x.gy)(e,c,l),o=(0,x.CH)(e,c,a),d=(0,x.$g)(o),u=[...(0,x.yX)(),...d];m(u),Z(null)}catch(e){console.error("Failed to load ports:",e),Z("Failed to load ports"),m((0,x.yX)())}},[e,c,P]);(0,d.useEffect)(()=>{b()},[b]),(0,d.useEffect)(()=>{(null==r?void 0:r.mappedPorts)&&m(e=>(0,x.Ph)(e,r.mappedPorts))},[null==r?void 0:r.mappedPorts]);let S=(0,d.useCallback)(e=>{m(r=>[...r,...e]),y(!1),Z(null)},[]),w=(0,d.useCallback)(e=>{m(r=>r.filter(r=>r.source!==e)),Z(null)},[]),C=(0,d.useCallback)((e,r)=>{m(l=>l.map(l=>l.source===e?{...l,isRemoving:r}:l))},[]),k=(0,d.useCallback)(e=>{m(e)},[]),N=(0,d.useCallback)(e=>{y(void 0!==e?e:e=>!e)},[]),{notifyCRNUpdate:E,scheduleNotifyCRNUpdate:I}=function(e,r,l){let a=(0,d.useRef)(),o=(0,d.useCallback)(async()=>{if(l&&e&&(null==r?void 0:r.node))try{let a=p.B.normalizeUrl(r.node.address||"");if(!a)return;await l.sendPostOperation({hostname:a,operation:"update",vmId:e,requireSignature:!1})}catch(e){console.error("Failed to notify CRN about port changes:",e)}},[l,e,null==r?void 0:r.node]),c=(0,d.useCallback)(()=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{o()},x.If)},[o]);return(0,d.useEffect)(()=>()=>{a.current&&clearTimeout(a.current)},[]),{notifyCRNUpdate:o,scheduleNotifyCRNUpdate:c}}(e,r,l),{addPorts:_,removePort:D}=function(e,r,l,a,o,c,u,m,p){let h=useForwardedPortsManager(),f=(0,d.useCallback)(async d=>{if(!e||!r||!h||l)return;let m=(0,x.FM)(d);if(0===m.length){null==o||o("No valid ports to add (system ports are reserved)");return}let p=await h.getByEntityHash(e),f=(null==p?void 0:p.ports)?Object.keys(p.ports).length:0,y=(0,x.EJ)(m,f);if(!y.isValid){null==o||o(y.errors.join(", "));return}let v=await h.validatePortConflicts(e,m),j=(0,x.z0)(e,r),g=v.conflicts.filter(e=>{let r=parseInt(e,10);return!j.includes(r)});if(g.length>0){null==o||o("Ports already exist: ".concat(g.join(", ")));return}null==c||c(!0);try{await h.addMultiplePorts(e,m);let l=(0,x.Nw)(m);(0,x.Lx)(e,r,l);let o=m.map(e=>({source:e.port,destination:void 0,tcp:e.tcp,udp:e.udp,isDeletable:!0}));null==u||u(o),null==a||a()}catch(e){console.error("Failed to add ports:",e),null==o||o("Failed to add ports")}finally{null==c||c(!1)}},[e,r,h,l,a,o,c,u]),y=(0,d.useCallback)(async d=>{if(e&&r&&h&&!l){if((0,x.MH)(d)){null==o||o("Cannot remove system port ".concat(d));return}null==p||p(d,!0);try{await h.removePort(e,d),(0,x.Ln)(e,r,parseInt(d,10)),null==m||m(d),null==a||a()}catch(e){console.error("Failed to remove port:",e),null==o||o("Failed to remove port")}finally{null==p||p(d,!1)}}},[e,r,h,l,a,o,m,p]);return{addPorts:f,removePort:y}}(e,c,v,I,Z,j,S,w,C);!function(e,r,l,a,o,c){let u=(0,d.useRef)();(0,d.useEffect)(()=>{if(u.current&&clearInterval(u.current),!l||!e||!(null==r?void 0:r.node))return;let checkForUnmappedPorts=async()=>{try{if(!a||!(0,x.Fo)(a))return;await (null==o?void 0:o());let d=p.B.normalizeUrl(r.node.address||"");if(!d)return;let u={id:e,payment:r.node},m=await l.checkStatus(u);(null==m?void 0:m.mappedPorts)&&(null==c||c(e=>e.map(e=>{var r;let l=null===(r=m.mappedPorts)||void 0===r?void 0:r[e.source];return{...e,destination:null==l?void 0:l.host.toString()}})))}catch(e){console.error("Failed to poll for unmapped ports:",e)}};return u.current=setInterval(checkForUnmappedPorts,x.g_),()=>{u.current&&clearInterval(u.current)}},[l,e,null==r?void 0:r.node,a,o,c])}(e,r,l,u,E,k);let F=(0,d.useCallback)(()=>{N(!0)},[N]),T=(0,d.useCallback)(()=>{N(!1),Z(null)},[N]),O=(0,d.useCallback)(async e=>{await D(e)},[D]),A=(0,d.useCallback)(async e=>{await _(e),g||N(!1)},[_,g,N]);return{showPortForm:f,ports:u,isLoading:v,error:g,handleAddPort:F,handleCancelAddPort:T,handleRemovePort:O,handleSubmitNewPorts:A}}({entityHash:r,executableStatus:l,executableManager:o}),P=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O,{className:"tp-body3 fs-18 text-base2",children:"IPv4 Port Forwarding Details"}),(0,a.jsx)("p",{className:"tp-body2 fs-14",children:"Randomized Source Ports:"}),(0,a.jsx)("p",{className:"tp-body1 fs-14",children:"Source (external) ports are automatically assigned and may change whenever the instance or function is reallocated. Always refer to the instance detail page to verify current mappings."}),(0,a.jsx)(A,{className:"tp-body2 fs-14",children:"Port Limits:"}),(0,a.jsx)("p",{className:"tp-body1 fs-14",children:"You can specify up to 20 internal ports per instance or function. Ensure you enter ports relevant to your service to maintain effective network security and performance."})]});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M,{className:"tp-h7 fs-24",children:(0,a.jsx)(F.Z,{plain:!0,my:"top-right",at:"top-right",vAlign:"bottom",iconSize:"0.9em",tooltipContent:P,children:"IPV4 PORT FORWARDING"})}),(0,a.jsx)(c.Jy,{children:(0,a.jsxs)(H,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(m.Z,{children:"CONFIGURED PORTS"}),(0,a.jsx)(u.x,{children:"Maximum 20 ports allowed"})]}),y.map(e=>{let{source:r,destination:l,tcp:o,udp:d,isDeletable:m,isRemoving:p}=e;return(0,a.jsxs)(R,{children:[(0,a.jsxs)(B,{children:[(0,a.jsxs)(z,{children:[(0,a.jsx)(u.x,{children:"Source"}),(0,a.jsx)(c.oi,{name:"source-port",dataView:!0,defaultValue:r,required:!0,width:"6em",textAlign:"center"})]}),(0,a.jsx)(K,{className:"text-main0 fs-18",children:"-"}),(0,a.jsxs)(V,{children:[(0,a.jsx)(u.x,{children:"Destination"}),(0,a.jsx)(c.oi,{name:"destination-port",dataView:!0,defaultValue:l,required:!0,width:"6em",textAlign:"center",loading:!l})]})]}),(0,a.jsxs)(U,{children:[(0,a.jsxs)(X,{children:[(0,a.jsx)(u.x,{children:"TCP"}),(0,a.jsx)(c.XZ,{disabled:!0,checked:o})]}),(0,a.jsxs)(q,{children:[(0,a.jsx)(u.x,{children:"UDP"}),(0,a.jsx)(c.XZ,{disabled:!0,checked:d})]}),m&&(0,a.jsx)(G,{children:(0,a.jsx)(c.zx,{variant:"warning",kind:"functional",onClick:()=>g(r),disabled:!!p,children:(0,a.jsx)(c.JO,{name:p?"spinner":"trash-xmark",spin:p})})})]})]},"port-".concat(r))}),(0,a.jsx)(J,{children:f?(0,a.jsx)(S,{onSubmit:Z,onCancel:j}):(0,a.jsx)(L,{children:(0,a.jsx)(c.zx,{variant:"secondary",kind:"gradient",onClick:v,children:"Add"})})})]})})]})};EntityPortForwarding.displayName="EntityPortForwarding";var T=(0,d.memo)(EntityPortForwarding),O=(0,o.ZP)("p")({marginBottom:"1rem"}),A=(0,o.ZP)("p")({marginTop:"1rem"}),M=(0,o.ZP)("div")({marginBottom:"0.5rem",display:"flex",alignItems:"center",textTransform:"uppercase"}),H=(0,o.ZP)("div")({display:"flex",flexDirection:"column",rowGap:"1rem"}),R=(0,o.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),B=(0,o.ZP)("div")({display:"flex",alignItems:"center",gap:"1rem"}),z=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),K=(0,o.ZP)("div")({marginBottom:"0.75rem",alignSelf:"flex-end",fontWeight:"700"}),V=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),U=(0,o.ZP)("div")({display:"flex",alignItems:"center",gap:"1rem"}),X=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),q=(0,o.ZP)("div")({display:"flex",flexDirection:"column",gap:"0.75rem"}),G=(0,o.ZP)("div")({alignSelf:"flex-end"}),J=(0,o.ZP)("div")({marginTop:"0.5rem"}),L=(0,o.ZP)("div").withConfig({displayName:"cmp___StyledDiv11",componentId:"sc-12viyya-0"})({marginTop:"0.5rem"})},1131:function(e,r,l){l.d(r,{Z:function(){return f}});var a=l(85893),o=l(57833),d=l(67294),c=l(31515),u=l(47104),m=l(77541),p=l(29159),h=l(9911),x=l(33697);let EntitySSHKeys=e=>{let{sshKeys:r,onSSHKeyClick:l}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y,{className:"tp-h7 fs-24",children:"SSH KEYS"}),(0,a.jsx)(c.Jy,{children:(0,a.jsx)(v,{children:r.length?r.map(e=>e&&(0,a.jsxs)(p.Z,{onClick:()=>{l(e)},children:[(0,a.jsx)(j,{id:h.DA[h.py.SSHKey],color:"base2",size:"2.5rem"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x.Z,{children:"SSH KEY NAME"}),(0,a.jsx)(m.x,{children:e.label})]}),(0,a.jsx)(g,{name:"eye",className:"openEntityIcon"})]},null==e?void 0:e.id)):(0,a.jsxs)(Z,{children:[(0,a.jsx)(P,{id:h.DA[h.py.SSHKey],color:"main0",size:"2.5rem"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x.Z,{children:"SSH KEY NAME"}),(0,a.jsx)(m.x,{children:(0,a.jsx)(u.Z,{width:"9rem"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x.Z,{children:"CREATED ON"}),(0,a.jsx)(m.x,{children:(0,a.jsx)(u.Z,{width:"14rem"})})]})]})})})]})};EntitySSHKeys.displayName="EntitySSHKeys";var f=(0,d.memo)(EntitySSHKeys),y=(0,o.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),v=(0,o.ZP)("div")({display:"flex",flexWrap:"wrap",gap:"1rem"}),j=(0,o.ZP)(c._7)({minHeight:"3rem",minWidth:"3rem"}),g=(0,o.ZP)(c.JO)({position:"absolute",right:"0.5rem",top:"0.5rem"}),Z=(0,o.ZP)("div")({display:"flex",alignItems:"center",gap:"1.5rem"}),P=(0,o.ZP)(c._7).withConfig({displayName:"cmp___StyledObjectImg2",componentId:"sc-1wen0ti-0"})({minHeight:"3rem",minWidth:"3rem"})},84427:function(e,r,l){l.d(r,{Z:function(){return y}});var a=l(85893),o=l(57833),d=l(67294),c=l(31515),u=l(47104),m=l(76696),p=l(77541),h=l(14685),x=l(9911),f=l(33697);let InstanceEntityDetails=e=>{let{entity:r,title:l="INSTANCE"}=e,o=(0,c.vx)((null==r?void 0:r.id)||"");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(v,{className:"tp-h7 fs-24",children:[l," DETAILS"]}),(0,a.jsx)(c.Jy,{children:(0,a.jsxs)(j,{children:[(0,a.jsx)(g,{id:x.DA[x.py.Instance],color:"main0",size:"6rem"}),(0,a.jsxs)(Z,{children:[(0,a.jsxs)(P,{children:[(0,a.jsx)(f.Z,{children:"ITEM HASH"}),r?(0,a.jsx)(m.Z,{iconName:"copy",onClick:o,children:r.id}):(0,a.jsx)(u.Z,{width:"100%"})]}),(0,a.jsxs)(b,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(f.Z,{children:"CORES"}),(0,a.jsx)("div",{children:(0,a.jsx)(S,{children:(null==r?void 0:r.resources)?"".concat(r.resources.vcpus," x86 64bit"):(0,a.jsx)(u.Z,{width:"7rem"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.Z,{children:"RAM"}),(0,a.jsx)("div",{children:(0,a.jsx)(p.x,{children:(null==r?void 0:r.resources)?(0,h.Fx)(r.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0}):(0,a.jsx)(u.Z,{width:"4rem"})})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.Z,{children:"HDD"}),(0,a.jsx)("div",{children:(0,a.jsx)(p.x,{children:r?(0,h.Fx)(r.size,{from:"MiB",to:"GiB",displayUnit:!0}):(0,a.jsx)(u.Z,{width:"6rem"})})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.Z,{children:"EXPLORER"}),(0,a.jsx)("div",{children:r?(0,a.jsx)("a",{className:"tp-body1 fs-16",href:r.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,a.jsx)(m.Z,{iconName:"square-up-right",children:(0,a.jsx)(p.x,{children:(0,h.bs)(r.url,80)})})}):(0,a.jsx)(u.Z,{width:"20rem"})})]})]})]})})]})};InstanceEntityDetails.displayName="InstanceEntityDetails";var y=(0,d.memo)(InstanceEntityDetails),v=(0,o.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),j=(0,o.ZP)("div")({display:"flex",gap:"1rem"}),g=(0,o.ZP)(c._7)({minHeight:"7rem",minWidth:"7rem"}),Z=(0,o.ZP)("div")({display:"flex",width:"100%",flexDirection:"column",gap:"1rem"}),P=(0,o.ZP)("div")({width:"100%"}),b=(0,o.ZP)("div")({display:"flex",flexWrap:"wrap",gap:"1rem"}),S=(0,o.ZP)(p.x).withConfig({displayName:"cmp___StyledText",componentId:"sc-nylz7s-0"})({display:"flex",alignItems:"center",gap:"0.25rem"})},98897:function(e,r,l){l.d(r,{a:function(){return useManageInstanceEntity}});var a=l(11163),o=l(67294),d=l(57125),c=l(60566),u=l(14685),m=l(37850),p=l(50090),h=l(63831),x=l(68091);function useManageInstanceEntity(e){let{entity:r,entityManager:l}=e,f=(0,a.useRouter)(),[y,v]=(0,o.useState)("detail"),j="log"===y,g=(0,d.y)({executable:r,manager:l,subscribeLogs:j}),{streamDetails:Z,logs:P}=g,b=(0,o.useMemo)(()=>{var e;return r?(null==r?void 0:null===(e=r.metadata)||void 0===e?void 0:e.name)||(0,u.zN)(r.id):""},[r]),S=(0,o.useMemo)(()=>(null==r?void 0:r.time)?Math.floor(Date.now()-1e3*r.time)/1e3:void 0,[null==r?void 0:r.time]),{handleDownloadLogs:w,isDownloadingLogs:C}=(0,m.Z)({fileName:b,logs:P}),k=(0,o.useCallback)(()=>{f.push(".")},[f]),{entities:N}=(0,x.X)(),E=(0,o.useMemo)(()=>(null==r?void 0:r.authorized_keys)&&N?r.authorized_keys.map(e=>N.find(r=>r.key===e)):[],[r,N]),{persistentVolumes:I,immutableVolumes:_}=(0,p.Z)({volumes:null==r?void 0:r.volumes}),{customDomains:D}=(0,h.Z)({entityId:null==r?void 0:r.id}),F=(0,o.useCallback)(e=>{B({isOpen:!0,type:"domain",selectedDomain:e})},[]),[T,O]=(0,o.useState)(),[A,M]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let fetchCost=async()=>{if((null==r?void 0:r.payment)&&l){M(!0);try{let e=await l.getTotalCostByHash(r.payment.type,r.id);O(e)}catch(e){console.error("Error fetching cost:",e)}finally{M(!1)}}};fetchCost()},[r,l]);let H=(0,o.useMemo)(()=>{var e,l;switch(null==r?void 0:null===(e=r.payment)||void 0===e?void 0:e.type){case c.uG.hold:return[{cost:T,paymentType:c.uG.hold,runningTime:S,startTime:r.time,blockchain:r.payment.chain,loading:A}];case c.uG.superfluid:if(null==Z?void 0:null===(l=Z.streams)||void 0===l?void 0:l.length)return Z.streams.map(e=>{var l;return{cost:e.flow,paymentType:c.uG.superfluid,runningTime:S,startTime:null==r?void 0:r.time,blockchain:null==r?void 0:null===(l=r.payment)||void 0===l?void 0:l.chain,loading:!1,receiver:e.receiver}});default:return[{paymentType:c.uG.hold,loading:!0}]}},[T,null==r?void 0:r.payment,S,null==r?void 0:r.time,null==Z?void 0:Z.streams,A]),[R,B]=(0,o.useState)({isOpen:!1}),z=(0,o.useCallback)(e=>{B({isOpen:!0,type:"volume",selectedVolume:e})},[]),K=(0,o.useCallback)(e=>{B({isOpen:!0,type:"sshKey",selectedSSHKey:e})},[]),V=(0,o.useCallback)(()=>{B(e=>({...e,isOpen:!1}))},[]),U=(0,o.useMemo)(()=>"log"===y?1:0,[y]);return{...g,mappedKeys:E,customDomains:D,handleCustomDomainClick:F,setTabId:v,handleBack:k,handleDownloadLogs:w,isDownloadingLogs:C,paymentData:H,immutableVolumes:_,persistentVolumes:I,name:b,sliderActiveIndex:U,sidePanel:R,handleImmutableVolumeClick:z,handleSSHKeyClick:K,closeSidePanel:V}}},24959:function(e,r,l){l.d(r,{c:function(){return useForm}});var a=l(31515),o=l(67294),d=l(87536),c=l(79711),u=l(50586);function useForm(e){let{onSubmit:r,onSuccess:l,onError:m,readyDeps:p=[],...h}=e,x=(0,d.cI)(h);(0,o.useEffect)(()=>{"object"==typeof h.defaultValues&&x.reset(h.defaultValues)},[...p]);let[f,y]=(0,o.useState)({data:void 0,error:void 0,loading:!1}),[v,{onLoad:j,onSuccess:g,onError:Z}]=(0,a.g7)({flushData:!0,state:f,setState:y,onSuccess:l,onError:m}),P=(0,o.useCallback)(async e=>{try{j();let l=await r(e);g(l)}catch(r){let e=r instanceof c.jm?u.Z.ValidationError:(null==r?void 0:r.cause)||r;x.setError("root.serverError",{...e,message:null==e?void 0:e.message}),Z(e)}},[x,Z,j,r,g]),b=(0,o.useCallback)(async e=>{let r;if(console.log(e),!r){let l=function getFirstError(e){let[r]=Object.entries(e);if(!r)return;let[l,a]=r;if(Array.isArray(a)){let e=a[a.length-1];return getFirstError(e)}return[l,a]}(e);if(l){let[e,a]=l,o="string"==typeof a?a:(null==a?void 0:a.message)?": ".concat(a.message):(null==a?void 0:a.type)?': "'.concat(null==a?void 0:a.type,'" validation not satisfied'):"";r=u.Z.FieldError(e,o)}}r||(r=u.Z.ValidationError),Z(r)},[Z]),S=(0,o.useMemo)(()=>x.handleSubmit(P,b),[x,P,b]);return{...x,requestState:v,handleSubmit:S}}},18395:function(e,r,l){l.d(r,{p:function(){return useSSHKeyManager}});var a=l(9754);function useSSHKeyManager(){let[e]=(0,a.mr)(),{sshKeyManager:r}=e.manager;return r}},68091:function(e,r,l){l.d(r,{X:function(){return useRequestSSHKeys}});var a=l(18395),o=l(77205);function useRequestSSHKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,a.p)();return(0,o.F)({...e,manager:r,name:"ssh"})}},56312:function(e,r,l){l.d(r,{F:function(){return t}});var a=l(87536);let s=(e,r,l)=>{if(e&&"reportValidity"in e){let o=(0,a.U2)(l,r);e.setCustomValidity(o&&o.message||""),e.reportValidity()}},resolvers_o=(e,r)=>{for(let l in r.fields){let a=r.fields[l];a&&a.ref&&"reportValidity"in a.ref?s(a.ref,l,e):a.refs&&a.refs.forEach(r=>s(r,l,e))}},resolvers_r=(e,r)=>{r.shouldUseNativeValidation&&resolvers_o(e,r);let l={};for(let o in e){let d=(0,a.U2)(r.fields,o),c=Object.assign(e[o]||{},{ref:d&&d.ref});if(i(r.names||Object.keys(e),o)){let e=Object.assign({},(0,a.U2)(l,o));(0,a.t8)(e,"root",c),(0,a.t8)(l,o,e)}else(0,a.t8)(l,o,c)}return l},i=(e,r)=>e.some(e=>e.startsWith(r+"."));var n=function(e,r){for(var l={};e.length;){var o=e[0],d=o.code,c=o.message,u=o.path.join(".");if(!l[u]){if("unionErrors"in o){var m=o.unionErrors[0].errors[0];l[u]={message:m.message,type:m.code}}else l[u]={message:c,type:d}}if("unionErrors"in o&&o.unionErrors.forEach(function(r){return r.errors.forEach(function(r){return e.push(r)})}),r){var p=l[u].types,h=p&&p[o.code];l[u]=(0,a.KN)(u,r,l,d,h?[].concat(h,o.message):o.message)}e.shift()}return l},t=function(e,r,l){return void 0===l&&(l={}),function(a,o,d){try{return Promise.resolve(function(o,c){try{var u=Promise.resolve(e["sync"===l.mode?"parse":"parseAsync"](a,r)).then(function(e){return d.shouldUseNativeValidation&&resolvers_o({},d),{errors:{},values:l.raw?a:e}})}catch(e){return c(e)}return u&&u.then?u.then(void 0,c):u}(0,function(e){if(Array.isArray(null==e?void 0:e.errors))return{values:{},errors:resolvers_r(n(e.errors,!d.shouldUseNativeValidation&&"all"===d.criteriaMode),d)};throw e}))}catch(e){return Promise.reject(e)}}}}}]);