(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{13190:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/computing/instance/[hash]",function(){return n(86871)}])},99978:function(e,i,n){"use strict";n.d(i,{U:function(){return useInstanceManager}});var t=n(55640);function useInstanceManager(){let[e]=(0,t.mr)(),{instanceManager:i}=e.manager;return i}},18395:function(e,i,n){"use strict";n.d(i,{p:function(){return useSSHKeyManager}});var t=n(55640);function useSSHKeyManager(){let[e]=(0,t.mr)(),{sshKeyManager:i}=e.manager;return i}},96370:function(e,i,n){"use strict";n.d(i,{u:function(){return useRequestInstances}});var t=n(99978),a=n(77205);function useRequestInstances(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,t.U)();return(0,a.F)({...e,manager:i,name:"instance"})}},86871:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return ManageInstance}});var t=n(85893),a=n(19521),r=n(34517),s=n(76696),l=n(79632),c=n(9911),d=n(11163),o=n(67294),m=n(99978),p=n(55640),h=n(18395),f=n(45520),x=n(59658),u=n(18735),v=n(76175),g=n(96370),y=n(9324),_=n(86780),j=n(50586),w=n(83474),N=n(93787),C=n(49107),S=n(70150),Z=n(5598),I=n(11505),q=n(41664),D=n.n(q),P=n(93788);function ManageInstance(){var e;let{instance:i,status:n,mappedKeys:q,crn:er,nodeDetails:es,handleRetryAllocation:el,handleCopyHash:ec,handleCopyConnect:ed,handleCopyIpv6:eo,handleDelete:em,handleBack:ep}=function(){let[e,i]=(0,p.mr)(),{account:n,blockchain:t}=e.connection,{handleConnect:a}=(0,x.R)({triggerOnMount:!1}),r=(0,d.useRouter)(),{hash:s}=r.query,{entities:c}=(0,g.u)({ids:s}),[C]=c||[],[S,Z]=(0,o.useState)([]),I=function(e){let[i,n]=(0,o.useState)(void 0),t=(0,m.U)();return(0,o.useEffect)(()=>{if(!t||!e||i)return;async function request(){if(!t||!e)return;let i=await t.checkStatus(e);n(i)}i||request();let a=setInterval(request,1e4);return()=>clearInterval(a)},[i,e,t]),i}(C),q=(0,l.vx)((null==C?void 0:C.id)||""),D=(0,l.vx)((null==I?void 0:I.vm_ipv6)||""),P=(0,l.vx)("ssh root@".concat(null==I?void 0:I.vm_ipv6)),k=(0,m.U)(),R=(0,N.z)(),E=(0,h.p)(),{next:b,stop:B}=(0,_.A)({});(0,o.useEffect)(()=>{if(!C||!E)return;let getMapped=async()=>{let e=await (null==E?void 0:E.getByValues(C.authorized_keys||[]));Z(e)};getMapped()},[E,C]);let M=(0,o.useCallback)(async()=>{var e;let i;if(C){if((null===(e=C.payment)||void 0===e?void 0:e.type)===u.uG.superfluid){if(t!==w.Ek.AVAX||!(n instanceof v.Bp))throw a({blockchain:w.Ek.AVAX}),j.Z.ConnectYourPaymentWallet;return i=(0,f.vG)(n),await i.init(),i}if(t!==w.Ek.ETH)throw a({blockchain:w.Ek.ETH}),j.Z.ConnectYourPaymentWallet}},[n,t,a,C]),T=(0,o.useCallback)(async()=>{if(!k)throw j.Z.ConnectYourWallet;if(!C)throw j.Z.InstanceNotFound;try{let e=await M(),n=await k.getDelSteps(C),t=n.map(e=>_.n[e]),a=k.delSteps(C,e);for(;;){let{done:e}=await a.next();if(e)break;await b(t)}i(new y.gg({name:"instance",keys:[C.id]})),await r.replace("/")}catch(e){}finally{await B()}},[i,M,C,k,b,r,B]),A=(0,l.lm)(),[F,U]=(0,o.useState)();(0,o.useEffect)(()=>{!async function(){try{var e;if(!R||!C||(null===(e=C.payment)||void 0===e?void 0:e.type)!==u.uG.superfluid)throw Error();let{receiver:i}=C.payment||{};if(!i)throw Error();let n=await R.getCRNByStreamRewardAddress(i);U(n)}catch(e){U(void 0)}}()},[C,R]);let H=(0,o.useCallback)(async()=>{if(!k)throw j.Z.ConnectYourWallet;if(!C)throw j.Z.InstanceNotFound;try{if(await M(),!F)throw j.Z.ConnectYourPaymentWallet;await k.notifyCRNExecution(F,C.id)}catch(e){null==A||A.add({variant:"error",title:"Error",text:null==e?void 0:e.message})}},[F,M,C,k,A]),z=(0,o.useMemo)(()=>(null==I?void 0:I.node)?{name:I.node.node_id,url:I.node.url}:F?{name:F.name||F.hash,url:F.address||""}:void 0,[F,null==I?void 0:I.node]);return{instance:C,status:I,mappedKeys:S,crn:F,nodeDetails:z,handleRetryAllocation:H,handleCopyHash:q,handleCopyConnect:P,handleCopyIpv6:D,handleDelete:T,handleBack:()=>{r.push(".")}}}(),eh=(0,a.Fg)();if(!i)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{handleBack:ep}),(0,t.jsx)(S.W2,{children:(0,t.jsx)(k,{children:"Loading..."})})]});let ef=(null==i?void 0:null===(e=i.metadata)||void 0===e?void 0:e.name)||(0,C.zN)(i.id),ex=c.K_[i.type],eu=i.volumes;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Z,{handleBack:ep}),(0,t.jsx)(R,{children:(0,t.jsxs)(S.W2,{children:[(0,t.jsxs)(E,{children:[(0,t.jsxs)(b,{children:[(0,t.jsx)(B,{name:"alien-8bit",className:"text-main0"}),(0,t.jsx)("div",{className:"tp-body2",children:ef}),(0,t.jsx)(M,{kind:"secondary",variant:i.time<Date.now()-45e3&&(null==n?void 0:n.vm_ipv6)?"success":"warning",children:(null==n?void 0:n.vm_ipv6)?"READY":(0,t.jsxs)(T,{children:[(0,t.jsx)(A,{children:"CONFIRMING"}),(0,t.jsx)(I.s5,{strokeColor:eh.color.base2,width:".8rem"})]})})]}),(0,t.jsxs)(F,{children:[!(null==n?void 0:n.vm_ipv6)&&er&&(0,t.jsx)(l.zx,{kind:"functional",variant:"warning",size:"md",onClick:el,children:"Reallocate"}),(0,t.jsx)(l.zx,{kind:"functional",variant:"warning",size:"md",onClick:em,children:"Delete"})]})]}),(0,t.jsxs)(l.Jy,{children:[(0,t.jsxs)(U,{children:[(0,t.jsx)(H,{variant:"accent",children:ex}),(0,t.jsxs)(z,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"ITEM HASH"}),(0,t.jsx)(s.Z,{iconName:"copy",onClick:ec,children:i.id})]})]}),(0,t.jsx)(S.Z0,{}),(0,t.jsxs)(O,{children:[(0,t.jsxs)(W,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"CORES"}),(0,t.jsx)("div",{children:(0,t.jsxs)(S.xv,{children:[i.resources.vcpus," x86 64bit"]})})]}),(0,t.jsxs)(L,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"RAM"}),(0,t.jsx)("div",{children:(0,t.jsx)(S.xv,{children:(0,C.Fx)(i.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0})})})]}),(0,t.jsxs)(Y,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"HDD"}),(0,t.jsx)("div",{children:(0,t.jsx)(S.xv,{children:(0,C.Fx)(i.size,{from:"MiB",to:"GiB",displayUnit:!0})})})]})]}),(0,t.jsxs)(G,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"EXPLORER"}),(0,t.jsx)("div",{children:(0,t.jsx)("a",{className:"tp-body1 fs-16",href:i.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(S.xv,{children:(0,C.bs)(i.url,80)})})})})]}),(0,t.jsx)(S.Z0,{}),(0,t.jsxs)(X,{children:[(0,t.jsx)(l.DU,{type:"h7",as:"h2",color:"main0",children:"Connection methods"}),(0,t.jsxs)(K,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"SSH COMMAND"}),(0,t.jsx)("div",{children:n?(0,t.jsx)(s.Z,{iconName:"copy",onClick:ed,children:(0,t.jsxs)(S.xv,{children:[">_ ssh root@",n.vm_ipv6]})}):(0,t.jsxs)(V,{children:[(0,t.jsx)(J,{className:"tp-body1 fs-16 text-main2",children:"Allocating"}),(0,t.jsx)(I.g4,{width:".8rem",height:"1rem",color:eh.color.main2})]})})]}),(0,t.jsxs)(Q,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"IPv6"}),(0,t.jsx)("div",{children:n&&(0,t.jsx)(s.Z,{iconName:"copy",onClick:eo,children:(0,t.jsx)(S.xv,{children:n.vm_ipv6})})})]})]}),(0,t.jsxs)($,{children:[(0,t.jsx)(l.DU,{type:"h7",as:"h2",color:"main0",children:"Accessible for"}),(0,t.jsx)(ee,{children:q.map((e,i)=>e&&(0,t.jsxs)(ei,{children:[(0,t.jsxs)("div",{className:"tp-info text-main0",children:["SSH KEY #",i+1]}),(0,t.jsx)(D(),{className:"tp-body1 fs-16",href:"/settings/ssh/".concat(e.id),children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(S.xv,{children:e.label})})})]},null==e?void 0:e.id))})]}),es&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z0,{}),(0,t.jsx)(l.DU,{type:"h7",as:"h2",color:"main0",children:"Current CRN"}),(0,t.jsxs)(en,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"NAME"}),(0,t.jsx)("div",{children:(0,t.jsx)(S.xv,{children:es.name})})]}),(0,t.jsxs)(et,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"URL"}),(0,t.jsx)("div",{children:(0,t.jsx)("a",{className:"tp-body1 fs-16",href:es.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(S.xv,{children:(0,C.bs)(es.url,80)})})})})]})]}),eu.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.Z0,{}),(0,t.jsx)(l.DU,{type:"h7",as:"h2",color:"main0",children:"Linked Storage(s)"}),(0,t.jsx)(Z.Z,{volumes:eu})]})]}),(0,t.jsx)(ea,{children:(0,t.jsx)(r.Z,{variant:"primary",href:"/computing/instance/new",children:"Create new instance"})})]})})]})}var k=(0,a.ZP)(l.Jy).withConfig({displayName:"cmp___StyledNoisyContainer",componentId:"sc-104qfl5-0"})({marginTop:"1rem",marginBottom:"1rem"}),R=(0,a.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-104qfl5-1"})({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}}),E=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-104qfl5-2"})({display:"flex",flexDirection:"column",flexWrap:"wrap",justifyContent:"space-between",gap:"1rem",paddingBottom:"1.25rem","@media (min-width: 48rem)":{flexDirection:"row"}}),b=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-104qfl5-3"})({display:"flex",alignItems:"center"}),B=(0,a.ZP)(l.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-104qfl5-4"})({marginRight:"1rem"}),M=(0,a.ZP)(l.__).withConfig({displayName:"cmp___StyledLabel",componentId:"sc-104qfl5-5"})({marginLeft:"1rem"}),T=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-104qfl5-6"})({display:"flex",alignItems:"center"}),A=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-104qfl5-7"})({marginRight:"0.5rem"}),F=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-104qfl5-8"})({display:"flex",flexDirection:"column",gap:"1rem","@media (min-width: 48rem)":{flexDirection:"row"}}),U=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-104qfl5-9"})({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),H=(0,a.ZP)(l.Vp).withConfig({displayName:"cmp___StyledTag",componentId:"sc-104qfl5-10"})({marginRight:"1rem",whiteSpace:"nowrap"}),z=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-104qfl5-11"})({flex:"1 1 auto"}),O=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv8",componentId:"sc-104qfl5-12"})({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex"}),W=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv9",componentId:"sc-104qfl5-13"})({marginRight:"1.25rem"}),L=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv10",componentId:"sc-104qfl5-14"})({marginRight:"1.25rem"}),Y=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv11",componentId:"sc-104qfl5-15"})({marginRight:"1.25rem"}),G=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv12",componentId:"sc-104qfl5-16"})({marginRight:"1.25rem"}),X=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv13",componentId:"sc-104qfl5-17"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),K=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv14",componentId:"sc-104qfl5-18"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),V=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv15",componentId:"sc-104qfl5-19"})({display:"flex",alignItems:"flex-end"}),J=(0,a.ZP)("span").withConfig({displayName:"cmp___StyledSpan",componentId:"sc-104qfl5-20"})({marginRight:"0.25rem"}),Q=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv16",componentId:"sc-104qfl5-21"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),$=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv17",componentId:"sc-104qfl5-22"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),ee=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv18",componentId:"sc-104qfl5-23"})({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex"}),ei=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv19",componentId:"sc-104qfl5-24"})({marginRight:"1.25rem"}),en=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv20",componentId:"sc-104qfl5-25"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),et=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv21",componentId:"sc-104qfl5-26"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),ea=(0,a.ZP)("div").withConfig({displayName:"cmp___StyledDiv22",componentId:"sc-104qfl5-27"})({marginTop:"5rem",textAlign:"center"})}},function(e){e.O(0,[371,774,888,179],function(){return e(e.s=13190)}),_N_E=e.O()}]);