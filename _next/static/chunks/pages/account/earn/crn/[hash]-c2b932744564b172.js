(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8512],{98983:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/earn/crn/[hash]",function(){return t(68560)}])},36538:function(e,n,t){"use strict";t.d(n,{Z:function(){return s}});var i=t(85893),r=t(57833),a=t(67294);let o=r.ZP.div.withConfig({displayName:"styles__StyledDotIcon",componentId:"sc-yqbriy-0"})(e=>{let{theme:n,$active:t}=e,i=t?n.color.success:n.color.disabled2;return[{height:"0.75rem",width:"0.5rem"},(0,r.iv)(["background-color:",";"],i)]}),NodeDecentralization=e=>{let{decentralization:n}=e,step=e=>(e+1)*.3;return(0,i.jsx)(l,{children:(0,i.jsx)(d,{children:Array.from({length:3},(e,t)=>(0,i.jsx)(o,{$active:n>=step(t)},t))})})};NodeDecentralization.displayName="NodeDecentralization";var s=(0,a.memo)(NodeDecentralization),l=(0,r.ZP)("div")({display:"inline-flex",alignItems:"center",gap:"0.75rem"}),d=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-4pdcek-0"})({display:"flex",alignItems:"stretch",gap:"0.125rem"})},69325:function(e,n,t){"use strict";t.d(n,{d:function(){return useHostingProviderTop}});var i=t(67294);function useHostingProviderTop(e){let{nodes:n}=e,t=(0,i.useMemo)(()=>{let e=n||Array.from({length:4},(e,n)=>({metricsData:{as_name:"Provider ".concat(n)}}));return e.reduce((e,n)=>{var t;let i=(null===(t=n.metricsData)||void 0===t?void 0:t.as_name)||"others";return e[i]=(e[i]||0)+1,e},{others:0})},[n]),r=(0,i.useMemo)(()=>Object.values(t).reduce((e,n)=>e+n,0),[t]),a=(0,i.useMemo)(()=>{let e=Object.entries(t).filter(e=>{let[n]=e;return"others"!==n}).sort((e,n)=>{let[,t]=e,[,i]=n;return i-t}),n=e.slice(0,3),i=e.slice(3),a=["others",t.others+i.reduce((e,n)=>{let[,t]=n;return e+t},0)];return[...n,a].map((e,n)=>{let[t,i]=e,a=i/r;return{tier:n+1,name:t,count:i,percentage:a,color:0===n?"error":1===n?"main2":2===n?"main0":"main1"}})},[t,r]);return{total:r,buckets:t,top:a}}},16112:function(e,n,t){"use strict";t.d(n,{h:function(){return useUserCoreChannelNode}});var i=t(9754),r=t(67294),a=t(5783);function useUserCoreChannelNode(){let{nodes:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n]=(0,i.mr)(),{entities:t}=n.ccns,{userNodes:o}=(0,a.M)({nodes:e||t}),s=(0,r.useMemo)(()=>null==o?void 0:o[0],[o]);return{userNode:s}}},60539:function(e,n,t){"use strict";t.d(n,{O:function(){return useRequestCRNSpecs}});var i=t(67294),r=t(93787);function useRequestCRNSpecs(e){let n=(0,r.z)(),{nodes:t}=e||{},[a,o]=(0,i.useState)({}),[s,l]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{if(t){let loadNodeSpecs=async()=>{await Promise.allSettled(t.map(async e=>{let t=await n.getCRNspecs(e);o(n=>({...n,[e.hash]:{data:t,loading:!1,error:void 0}}))})),l(!1)};loadNodeSpecs()}},[n,t]),(0,i.useEffect)(()=>{if(!t){let loadAllSpecs=async()=>{let e=await n.getAllCRNsSpecs();e.forEach(e=>{o(n=>({...n,[e.hash]:{data:e,loading:!1,error:void 0}}))}),l(!1)};loadAllSpecs()}},[n,t]),{specs:a,loading:s}}},68560:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eb}});var i=t(85893),r=t(57833),a=t(67294),o=t(9008),s=t.n(o),l=t(9754),d=t(68885),c=t(11163),u=t.n(c),m=t(50721),h=t(16112),v=t(24959),p=t(87536),x=t(56312),f=t(73899),g=t(9324),j=t(93787),C=t(68518),y=t(69325),w=t(60539),P=t(14685),N=t(20109),b=t(72077),R=t(72882),S=t(81990),E=t(84550),D=t(41664),k=t.n(D),T=t(90255),Z=t(16434),M=t(36538),A=t(64885),_=t(44270),O=t(16451),I=t(25675),H=t.n(I),z=t(91489),U=t(34517),B=t(28540),L=t(33910);let OverviewTabContent=e=>{var n,t,r,o,s,c,u,m,h;let{theme:v,node:p,nodesOnSameASN:x,baseLatency:g,lastMetricsCheck:j,calculatedRewards:C,creationDate:y,isOwner:w,rewardCtrl:N,streamRewardCtrl:E,addressCtrl:D,asnTier:I,nodeSpecs:F,nodeIssue:el,createInstanceUrl:ed,isLinked:ec,isLinkableByUser:eu,isUnlinkableByUser:em,handleLink:eh,handleUnlink:ev}=e,{apiServer:ep}=(0,O.r)(),[ex]=(0,l.mr)(),{blockchain:ef}=ex.connection,eg=(0,a.useMemo)(()=>ef===b.Ek.ETH,[ef]),ej=(0,a.useMemo)(()=>{var e;return ef?null===(e=b.DR[ef])||void 0===e?void 0:e.name:"Current network"},[ef]);return(0,i.jsx)(W,{children:(0,i.jsxs)(J,{children:[(0,i.jsxs)(G,{children:[(0,i.jsxs)(T.ZP,{title:"GENERAL INFO",children:[(0,i.jsx)(Z.Z,{status:null==p?void 0:p.status,score:null==p?void 0:p.score}),(0,i.jsx)(T.HC,{name:"NAME",value:null==p?void 0:p.name}),(0,i.jsx)(T.HC,{name:"ASN",value:null==p?void 0:null===(n=p.metricsData)||void 0===n?void 0:n.as_name}),(0,i.jsx)(T.HC,{name:"OWNER",value:(0,i.jsx)(_.Z,{href:(0,P.tz)({address:null==p?void 0:p.owner}),isOwner:!1,textToCopy:null==p?void 0:p.owner,children:(null==p?void 0:p.owner)&&(0,P.zN)(null==p?void 0:p.owner)}),big:!0}),(0,i.jsx)(T.HC,{name:"REWARD ADDRESS",value:(0,i.jsx)(A.Z,{...N.field,...N.fieldState,placeholder:"reward address",isOwner:w,children:(0,i.jsx)(_.Z,{href:(0,P.tz)({tokenAddress:N.field.value}),isOwner:w,textToCopy:N.field.value,children:N.field.value&&(0,P.zN)(N.field.value)})}),big:!0}),(0,i.jsx)(T.HC,{name:"STREAM REWARD ADDRESS",value:(0,i.jsx)(A.Z,{...E.field,...E.fieldState,placeholder:"PAYG reward address",isOwner:w,children:(0,i.jsx)(_.Z,{href:(0,P.gl)({tokenAddress:E.field.value}),isOwner:w,textToCopy:E.field.value,children:E.field.value&&(0,P.zN)(E.field.value)})}),big:!0}),(0,i.jsx)(T.HC,{name:"ADDRESS",value:(0,i.jsx)(A.Z,{...D.field,...D.fieldState,placeholder:"address",isOwner:w,children:(0,i.jsx)(_.Z,{href:null==p?void 0:p.address,isOwner:w,textToCopy:null==p?void 0:p.address,children:null==p?void 0:p.address})}),big:!0})]}),(0,i.jsxs)(T.ZP,{title:"HARDWARE",children:[(0,i.jsx)(T.HC,{name:"CPU",value:null==F?void 0:null===(t=F.properties)||void 0===t?void 0:t.cpu.vendor}),(0,i.jsx)(T.HC,{name:"CPU ARCHITECTURE",value:null==F?void 0:null===(r=F.properties)||void 0===r?void 0:r.cpu.architecture}),(0,i.jsx)(T.HC,{name:"CPU COUNT",value:null==F?void 0:null===(o=F.cpu)||void 0===o?void 0:o.count}),(0,i.jsx)(T.HC,{name:"CPU FREQUENCY",value:"".concat((((null==F?void 0:null===(s=F.cpu)||void 0===s?void 0:s.core_frequencies.max)||0)/1024).toFixed(2)," GHz")}),(0,i.jsx)(T.HC,{name:"RAM",value:(0,P.eB)(null==F?void 0:null===(c=F.mem)||void 0===c?void 0:c.total_kB,"KiB")}),(0,i.jsx)(T.HC,{name:"HDD",value:(0,P.eB)(null==F?void 0:null===(u=F.disk)||void 0===u?void 0:u.total_kB,"KiB")}),(0,i.jsxs)(Y,{children:[(0,i.jsx)(U.Z,{href:ed||"#",kind:"gradient",variant:"primary",size:"md",disabled:!ed,children:(0,i.jsxs)(i.Fragment,{children:["Create Instance",void 0===el&&(0,i.jsx)(B.g4,{width:"1em",height:"1em",color:v.color.background})]})}),!ed&&(0,i.jsx)(q,{className:"fs-10",children:el?(0,i.jsx)(f.u,{my:"top-center",at:"bottom-center",content:(0,i.jsxs)("div",{className:"tp-body1 fs-12",children:[(0,i.jsx)("div",{className:"tp-body3 fs-16",children:"Why is my node unavailable?"}),(0,i.jsx)("div",{children:"A node may be not eligible for PAYG for the following reasons:"}),(0,i.jsxs)(V,{children:[el===d.r.IPV6&&(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"IPv6 Egress Issue:"})," The node's compute resource (CRN) is unable to establish an IPv6 egress connection."]}),el===d.r.MinSpecs&&(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Minimum Specifications:"})," The node does not meet the required minimum hardware or software specifications."]}),el===d.r.Version&&(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Version Compatibility:"})," Only nodes with version 0.4.0 or higher are eligible for selection."]}),el===d.r.RewardAddress&&(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Stream Reward Configuration:"})," ","The node lacks a configured stream reward address, which is necessary for operation."]})]})]}),children:(0,i.jsxs)(K,{children:["Not eligible for pay-as-you-go (PAYG)",(0,i.jsx)(X,{name:"exclamation-circle"})]})}):(0,i.jsx)($,{children:"Not eligible for pay-as-you-go (PAYG)"})})]})]})]}),(0,i.jsxs)(Q,{children:[(0,i.jsxs)(T.ZP,{title:"REWARD INDICATORS",children:[(0,i.jsx)(T.HC,{name:"LAST CHECK",value:j}),(0,i.jsx)(T.HC,{name:"NODES ON ASN",value:(0,i.jsxs)(ee,{className:I&&"text-".concat(I.color),children:[x,!!I&&(0,i.jsx)(f.JO,{name:"hexagon-exclamation",color:I.color})]})}),(0,i.jsx)(T.HC,{name:"VERSION",value:null==p?void 0:null===(m=p.metricsData)||void 0===m?void 0:m.version}),(0,i.jsx)(T.HC,{name:"BASE LATENCY",value:g})]}),(0,i.jsx)(T.ZP,{title:"POTENTIAL REWARD",children:(0,i.jsx)(T.HC,{name:"ESTIMATED MONTHLY REWARD",value:(0,i.jsx)(z.Z,{value:C})})})]}),(0,i.jsxs)(en,{children:[(0,i.jsx)(T.ZP,{title:"LINKED CORE NODE",children:(0,i.jsx)(et,{children:ec?(0,i.jsxs)(i.Fragment,{children:[(null==p?void 0:p.parentData)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L.Rr,{$score:p.parentData.score}),(0,i.jsx)(k(),{href:"/account/earn/ccn/".concat(p.parentData.hash),legacyBehavior:!0,children:(0,i.jsx)(eo,{hash:p.parentData.hash,name:p.parentData.name,picture:p.parentData.picture,apiServer:ep,ImageCmp:H()})})]}),em&&(0,i.jsx)(R.ZP,{kind:"flat",variant:"textOnly",onClick:ev,disabled:!eg,tooltipContent:eg?void 0:(0,S.P)(ej),tooltipPosition:{my:"bottom-center",at:"top-center"},children:(0,i.jsx)(f.JO,{name:"trash",color:"error"})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(L.Rr,{}),(0,i.jsx)(ei,{}),(0,i.jsx)(er,{className:"fs-10",children:eu?(0,i.jsx)(R.ZP,{color:"main0",size:"md",kind:"gradient",variant:"textOnly",onClick:eh,disabled:!eg,tooltipContent:eg?void 0:(0,S.P)(ej),tooltipPosition:{my:"bottom-center",at:"top-center"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)(ea,{name:"link"})," link now"]})}):(0,i.jsx)(i.Fragment,{children:"not linked"})})]})})}),(0,i.jsxs)(T.ZP,{title:"DECENTRALIZED SCORE",children:[(0,i.jsxs)(es,{className:I&&"text-".concat(I.color),children:[(0,i.jsx)(M.Z,{decentralization:(null==p?void 0:null===(h=p.scoreData)||void 0===h?void 0:h.decentralization)||0}),!!I&&(0,i.jsx)(f.JO,{name:"hexagon-exclamation",color:I.color})]}),!!I&&(0,i.jsxs)("p",{className:"tp-body3 fs-10",children:["There are ",x," nodes on this ASN. Please consider to migrate your node to a different ASN."]})]}),(0,i.jsx)(T.ZP,{title:"PERFORMANCE",children:(0,i.jsx)(T.HC,{name:"CREATION TIME",value:y})})]})]})})};OverviewTabContent.displayName="OverviewTabContent";var F=(0,a.memo)(OverviewTabContent),W=(0,r.ZP)("section")({marginTop:"2rem"}),J=(0,r.ZP)("div")({display:"flex",flexWrap:"wrap",gap:"2.25rem"}),G=(0,r.ZP)("div")({display:"flex",width:"33.333333%",minWidth:"20rem",flex:"1 1 0%",flexDirection:"column",gap:"2.25rem"}),Y=(0,r.ZP)("div")({paddingTop:"1.5rem",textAlign:"center"}),q=(0,r.ZP)("div")({marginTop:"1rem"}),V=(0,r.ZP)("ul")({marginTop:"1rem",marginBottom:"1rem",listStyleType:"disc",paddingLeft:"1.5rem"}),K=(0,r.ZP)("div")({display:"flex",cursor:"help",alignItems:"center",justifyContent:"center"}),X=(0,r.ZP)(f.JO)({marginLeft:"0.5rem"}),$=(0,r.ZP)("div")({textAlign:"center"}),Q=(0,r.ZP)("div")({display:"flex",width:"33.333333%",minWidth:"20rem",flex:"1 1 0%",flexDirection:"column",gap:"2.25rem"}),ee=(0,r.ZP)("div")({display:"flex",alignItems:"center",gap:"0.75rem"}),en=(0,r.ZP)("div")({display:"flex",width:"33.333333%",minWidth:"20rem",flex:"1 1 0%",flexDirection:"column",gap:"2.25rem"}),et=(0,r.ZP)("div")({display:"flex",alignItems:"center",gap:"0.75rem"}),ei=(0,r.ZP)("div")({height:"1.5rem",width:"1.5rem",borderRadius:"9999px",backgroundColor:"#C4C4C433"}),er=(0,r.ZP)("div")({lineHeight:"1rem"}),ea=(0,r.ZP)(f.JO)({height:"0.875rem",width:"0.875rem"}),eo=(0,r.ZP)(f.tJ)({marginRight:"auto",width:"auto",cursor:"pointer"}),es=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv11",componentId:"sc-1dnj60j-0"})({display:"flex",alignItems:"center",gap:"0.75rem"}),el=t(93161),ed=t(4031),ec=t(60566),eu=t(56979);let PoliciesTabContent=e=>{let{isOwner:n,documentName:t,documentCID:r,documentLink:o,termsAndConditionsCtrl:s,isLoadingHistoryMessages:d,policiesHistory:c,fileValue:u,removePoliciesDisabled:m,isCurrentVersion:h,handleFileChange:v,handleDownloadFile:p,handleRemovePolicies:x}=function(e){let{node:n,termsAndConditionsCtrl:t,handleRemovePolicies:i,...r}=e,{apiServer:o}=(0,O.r)(),{field:{onChange:s,value:l}}=t,[d,c]=(0,a.useState)(),[u,m]=(0,a.useState)(!0),[h,v]=(0,a.useState)(),[p,x]=(0,a.useState)(!0),f=(0,a.useMemo)(()=>new ed.U,[]),g=(0,a.useMemo)(()=>new eu.p,[]),j=(0,a.useMemo)(()=>{if(!h)return;let e=null==h?void 0:h.entries().next().value;if(e)return e[1]},[h]),C=(0,a.useMemo)(()=>p?"":(null==j?void 0:j.name)||" ",[p,j]),y=(0,a.useMemo)(()=>p?"":(null==j?void 0:j.cid)||" ",[p,j]),w=(0,a.useMemo)(()=>p?"":j?"".concat(o,"/api/v0/storage/raw/").concat(null==j?void 0:j.cid):" ",[p,j,o]),P=(0,a.useMemo)(()=>!(null==h?void 0:h.size),[h]),N=(0,a.useMemo)(()=>{if(l instanceof File)return l},[l]),b=(0,a.useCallback)(e=>!!j&&e===j,[j]),R=(0,a.useCallback)(e=>{let n=Array.isArray(e)?e[0]:e;s(n)},[s]),S=(0,a.useCallback)(async(e,n)=>{let t=await g.downloadFile(e),i=window.URL.createObjectURL(t),r=document.createElement("a");r.href=i,r.download=n,document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(i)},[g]);return(0,a.useEffect)(()=>{let fetchMessages=async()=>{if(m(!0),!f||!n)return c(void 0);try{let{messages:e}=await (null==f?void 0:f.getAll({messageTypes:[ec.Cs.post],refs:[n.hash],addresses:[n.owner]}));c(e)}catch(e){console.error(e)}finally{m(!1)}};fetchMessages()},[f,n]),(0,a.useEffect)(()=>{let fetchMessages=async()=>{if(x(!0),u||!f||!d)return v(void 0);try{let i=new Map;for(let r of d){var e,n,t;let a;let o=null===(n=r.content)||void 0===n?void 0:null===(e=n.content)||void 0===e?void 0:e.details.terms_and_conditions;if(!o)break;try{let{content:e}=await (null==f?void 0:f.get(o));a=e}catch(e){console.error(e)}a&&i.set(o,{time:new Date(1e3*r.content.time),cid:a.item_hash,name:null===(t=a.metadata)||void 0===t?void 0:t.name})}let r=new Map(Array.from(i).sort((e,n)=>{let[,{time:t}]=e,[,{time:i}]=n;return i.getTime()-t.getTime()}));v(r)}catch(e){console.error(e)}finally{x(!1)}};fetchMessages()},[d,u,f]),{documentName:C,documentCID:y,documentLink:w,policiesHistory:h,termsAndConditionsCtrl:t,isLoadingHistoryMessages:p,fileValue:N,removePoliciesDisabled:P,isCurrentVersion:b,handleFileChange:R,handleDownloadFile:S,handleRemovePolicies:i,...r}}(e),[g]=(0,l.mr)(),{blockchain:j}=g.connection,C=(0,a.useMemo)(()=>j===b.Ek.ETH,[j]),y=(0,a.useMemo)(()=>{var e;return j?null===(e=b.DR[j])||void 0===e?void 0:e.name:"Current network"},[j]);return(0,i.jsx)(eh,{children:(0,i.jsxs)(f.X2,{count:1,xl:5,xlGap:"2rem",children:[(0,i.jsxs)(f.JX,{span:3,children:[(0,i.jsxs)(T.ZP,{title:"CURRENT VERSION",children:[(0,i.jsx)(T.HC,{name:"DOCUMENT NAME",value:t}),(0,i.jsx)(T.HC,{name:"CID",value:r}),(0,i.jsx)(T.HC,{name:"LINK",value:o})]}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ev,{kind:"flat",variant:"secondary",size:"md",color:"error",onClick:x,disabled:m||!C,tooltipContent:C?void 0:(0,S.P)(y),tooltipPosition:{my:"bottom-center",at:"top-center"},children:[(0,i.jsx)(f.JO,{name:"trash",color:m||!C?"":"error",size:"lg"}),"remove policies"]}),(0,i.jsx)(f.S2,{...s.field,...s.fieldState,value:u,onChange:v}),(0,i.jsx)(ep,{className:"tp-info text-base",children:"Max. file size is 100 MB"})]})]}),(0,i.jsxs)(f.JX,{span:2,children:[(0,i.jsx)(ex,{className:"tp-h7",children:"History"}),d?(0,i.jsx)(f.$j,{}):c&&(0,i.jsx)("ol",{children:Array.from(c).map((e,n)=>{let[,t]=e;return(0,i.jsxs)(ef,{children:[(0,i.jsx)(eg,{className:"fs-12",children:h(t)?"Now":t.time.toLocaleDateString()}),(0,i.jsx)(el.Z,{text:t.name||(0,f.bs)(t.cid,12,6),href:"#",onClick:()=>p(t.cid,t.name||t.cid),target:"_self"}),n<c.size-1&&(0,i.jsx)(ej,{})]},t.cid)})})]})]})})};PoliciesTabContent.displayName="PoliciesTabContent";var em=(0,a.memo)(PoliciesTabContent),eh=(0,r.ZP)("section")({marginTop:"2rem"}),ev=(0,r.ZP)(R.ZP)({marginTop:"2rem !important",marginBottom:"2rem !important"}),ep=(0,r.ZP)("div")({marginTop:"0.5rem",width:"100%",paddingRight:"1.75rem",textAlign:"right",opacity:"0.7"}),ex=(0,r.ZP)("div")({marginTop:"2rem",marginBottom:"2rem"}),ef=(0,r.ZP)("li")({marginTop:"0.5rem"}),eg=(0,r.ZP)("div")({marginBottom:"0.125rem",fontWeight:"400",fontStyle:"italic",opacity:"0.4"}),ej=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-cwh146-0"})({position:"relative",marginLeft:"0.25rem",marginTop:"0.5rem",height:"2rem",borderInlineStartWidth:"1px"}),eC=t(99983);let ComputeResourceNodeDetailPage=()=>{let{theme:e,node:n,nodesOnSameASN:t,baseLatency:o,lastMetricsCheck:D,calculatedRewards:k,creationDate:T,nameCtrl:Z,descriptionCtrl:M,bannerCtrl:A,pictureCtrl:_,isOwner:O,isDirty:I,rewardCtrl:H,streamRewardCtrl:z,addressCtrl:U,termsAndConditionsCtrl:B,asnTier:L,nodeSpecs:W,nodeIssue:J,createInstanceUrl:G,isLinked:Y,isLinkableByUser:q,isUnlinkableByUser:V,tabId:K,setTabId:X,tabs:$,handleRemovePolicies:Q,handleRemove:ee,handleSubmit:en,handleLink:et,handleUnlink:ei}=function(){let e=(0,r.Fg)(),n=(0,c.useRouter)(),{hash:t}=n.query,[i]=(0,l.mr)(),{connection:{account:o},crns:{entities:s}}=i,b=(0,j.z)(),{node:R}=function(e){let{hash:n}=e,[t]=(0,l.mr)(),{entities:i}=t.crns,r=(0,a.useMemo)(()=>{if(i)return i.filter(e=>e.hash===n)},[i,n]),[o]=r||[];return{node:o}}({hash:t}),{userNode:S}=(0,h.h)(),E=(0,a.useMemo)(()=>new N.S(o),[o]),D=(0,a.useMemo)(()=>R?E.CRNRewardsPerDay(R)*(365/12):0,[R,E]),k=(0,m._)({node:R,nodes:s}),[T,Z]=(0,a.useState)("overview"),M=(0,a.useMemo)(()=>[{id:"overview",name:"Overview"},{id:"policies",name:"Policies"}],[]),{isLinked:A,isLinkableByUser:_,isUnlinkableByUser:O,handleLink:I,handleUnlink:H}=(0,C.i)(),z=(0,a.useMemo)(()=>R&&A(R),[A,R]),U=(0,a.useMemo)(()=>R&&S&&_(R,S),[_,R,S]),B=(0,a.useMemo)(()=>R&&O(R),[O,R]),L=(0,a.useCallback)(async()=>{if(!R||!S)return!1;let e=await I(R.hash,S.hash);return e&&S&&n.replace("/account/earn/ccn/".concat(S.hash)),e},[I,n,R,S]),F=(0,a.useCallback)(async()=>{if(!R)return!1;let e=await H(R.hash);return e&&S&&n.replace("/account/earn/ccn/".concat(null==S?void 0:S.hash)),e},[H,n,R,S]),{top:W}=(0,y.d)({nodes:s}),J=W.find(e=>{var n;return e.name===(null==R?void 0:null===(n=R.metricsData)||void 0===n?void 0:n.as_name)}),G=(0,a.useMemo)(()=>{if(R)return[R]},[R]),{specs:Y}=(0,w.O)({nodes:G}),{ips:q}=function(e){let{nodes:n}=e,t=(0,j.z)(),[i,r]=(0,a.useState)({}),[o,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let load=async()=>{n&&(await Promise.allSettled(n.filter(e=>!t.isStreamPaymentNotSupported(e)).map(async e=>{if(i[e.hash])return;let n=await t.getCRNips(e);r(t=>({...t,[e.hash]:{data:n,loading:!1,error:void 0}}))})),s(!1))};load()},[i,t,n]),{ips:i,loading:o}}({nodes:G}),V=(0,a.useMemo)(()=>({cpu:1,ram:(0,P.Fx)(2,{from:"GiB",to:"MiB"}),storage:(0,P.Fx)(20,{from:"GiB",to:"MiB"})}),[]),K=(0,a.useMemo)(()=>{if(G)return G.reduce((e,n)=>{var t,i;let r=b.isStreamPaymentNotSupported(n);if(r)return e[n.hash]=r,e;let a=null===(t=Y[n.hash])||void 0===t?void 0:t.data;if(a){let t=b.validateMinNodeSpecs(V,a);if(!t)return e[n.hash]=d.r.MinSpecs,e}let o=null===(i=q[n.hash])||void 0===i?void 0:i.data;if(o){let t=!!o.vm;if(!t)return e[n.hash]=d.r.IPV6,e}return a&&o&&(e[n.hash]=d.r.Valid),e},{})},[G,b,Y,q,V]),X=(0,a.useMemo)(()=>{var e;if(R)return null===(e=Y[R.hash])||void 0===e?void 0:e.data},[Y,R]),$=(0,a.useMemo)(()=>{if(R)return null==K?void 0:K[R.hash]},[K,R]),Q=(0,a.useMemo)(()=>{if(!R)return;let e=void 0===$;return e||$?void 0:"/console/computing/instance/new?crn=".concat(R.hash)},[R,$]),ee=(0,a.useMemo)(()=>({hash:null==R?void 0:R.hash,name:null==R?void 0:R.name,description:null==R?void 0:R.description,reward:null==R?void 0:R.reward,stream_reward:null==R?void 0:R.stream_reward,authorized:null==R?void 0:R.authorized,locked:null==R?void 0:R.locked,registration_url:null==R?void 0:R.registration_url,picture:null==R?void 0:R.picture,banner:null==R?void 0:R.banner,address:null==R?void 0:R.address,terms_and_conditions:null==R?void 0:R.terms_and_conditions}),[R]),en=function(e){let{defaultValues:n}=e,[t,i]=(0,l.mr)(),{connection:{account:r},crns:{entities:o}}=t,s=(0,j.z)(),c=(0,f.lm)(),u=(0,a.useCallback)(async e=>{if(!s)throw Error("Manager not ready");if(!r)throw Error("Invalid account");let[,n]=await s.updateComputeResourceNode(e),t=null==o?void 0:o.find(e=>e.hash===n.hash),i=function(e,n){let t={...e||{},...n,virtual:Date.now()};return t}(t,n);return i},[r,s,o]),m=(0,a.useCallback)(async e=>{if(!c)throw Error("Notification not ready");c.add({variant:"success",title:"Success",text:'Your node "'.concat(e.hash,'" was updated successfully.')}),i(new g.Wy({name:"crns",entities:[e]}))},[i,c]),{control:h,handleSubmit:C,formState:{errors:y,isDirty:w}}=(0,v.c)({defaultValues:n,onSubmit:u,onSuccess:m,resolver:(0,x.F)(d.B.updateCRNSchema),readyDeps:[n]}),P=(0,p.qo)({control:h}),N=(0,p.bc)({control:h,name:"name"}),b=(0,p.bc)({control:h,name:"description"}),R=(0,p.bc)({control:h,name:"address"}),S=(0,p.bc)({control:h,name:"picture"}),E=(0,p.bc)({control:h,name:"banner"}),D=(0,p.bc)({control:h,name:"reward"}),k=(0,p.bc)({control:h,name:"stream_reward"}),T=(0,p.bc)({control:h,name:"authorized"}),Z=(0,p.bc)({control:h,name:"locked"}),M=(0,p.bc)({control:h,name:"registration_url"}),A=(0,p.bc)({control:h,name:"terms_and_conditions"});return{values:P,control:h,nameCtrl:N,descriptionCtrl:b,addressCtrl:R,pictureCtrl:S,bannerCtrl:E,rewardCtrl:D,streamRewardCtrl:k,authorizedCtrl:T,lockedCtrl:Z,registrationUrlCtrl:M,termsAndConditionsCtrl:A,errors:y,isDirty:w,handleSubmit:C}}({defaultValues:ee}),et=(0,a.useCallback)(async()=>{await b.updateComputeResourceNode({...en.values,terms_and_conditions:""}),u().reload()},[en.values,b]);return{theme:e,nodes:s,node:R,userNode:S,calculatedRewards:D,asnTier:J,nodeSpecs:X,nodeIssue:$,createInstanceUrl:Q,isLinked:z,isLinkableByUser:U,isUnlinkableByUser:B,tabs:M,tabId:T,setTabId:Z,handleRemovePolicies:et,handleLink:L,handleUnlink:F,...en,...k}}(),[er]=(0,l.mr)(),{blockchain:ea}=er.connection,eo=(0,a.useMemo)(()=>ea===b.Ek.ETH,[ea]),es=(0,a.useMemo)(()=>{var e;return ea?null===(e=b.DR[ea])||void 0===e?void 0:e.name:"Current network"},[ea]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s(),{children:[(0,i.jsx)("title",{children:"Account | CRN Detail | Aleph Cloud"}),(0,i.jsx)("meta",{name:"description",content:"Aleph Cloud Compute Resource Node"}),(0,i.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),(0,i.jsx)(eC.F,{$variant:"xl",children:(0,i.jsxs)(ew,{children:[(0,i.jsx)(E.Z,{node:n,nameCtrl:Z,descriptionCtrl:M,bannerCtrl:A,pictureCtrl:_,isOwner:O}),O&&(0,i.jsxs)(eP,{children:[(0,i.jsxs)(R.ZP,{kind:"flat",variant:"textOnly",size:"md",color:"error",onClick:ee,disabled:!eo,tooltipContent:eo?void 0:(0,S.P)(es),tooltipPosition:{my:"bottom-center",at:"top-center"},children:[(0,i.jsx)(f.JO,{name:"trash",color:"error",size:"lg"}),"remove node"]}),(0,i.jsx)(R.ZP,{kind:"gradient",variant:"primary",size:"md",color:"main0",onClick:en,disabled:!I||!eo,tooltipContent:eo?void 0:(0,S.P)(es),tooltipPosition:{my:"bottom-center",at:"top-center"},children:"save changes"})]}),(0,i.jsx)(eN,{children:(0,i.jsx)(f.mQ,{selected:K,tabs:$,onTabChange:X})}),"overview"===K?(0,i.jsx)(F,{theme:e,node:n,nodesOnSameASN:t,baseLatency:o,lastMetricsCheck:D,calculatedRewards:k,creationDate:T,isOwner:O,rewardCtrl:H,streamRewardCtrl:z,addressCtrl:U,asnTier:L,nodeSpecs:W,nodeIssue:J,createInstanceUrl:G,isLinked:Y,isLinkableByUser:q,isUnlinkableByUser:V,handleLink:et,handleUnlink:ei}):"policies"===K?(0,i.jsx)(em,{node:n,isOwner:O,termsAndConditionsCtrl:B,handleRemovePolicies:Q}):""]})})]})};ComputeResourceNodeDetailPage.displayName="ComputeResourceNodeDetailPage";var ey=(0,a.memo)(ComputeResourceNodeDetailPage),ew=(0,r.ZP)("section")({paddingTop:"0px"}),eP=(0,r.ZP)("div")({marginTop:"2rem",marginBottom:"2rem",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"1.75rem"}),eN=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1pc7550-0"})({marginTop:"2rem",marginBottom:"2rem",display:"flex"}),eb=ey}},function(e){e.O(0,[7536,1093,5675,6946,9774,2888,179],function(){return e(e.s=98983)}),_N_E=e.O()}]);