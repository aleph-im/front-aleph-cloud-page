(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{37313:function(e,l,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/storage/volume/new",function(){return r(67828)}])},36846:function(e,l,r){"use strict";r.d(l,{LY:function(){return x},nx:function(){return h}});var d=r(85893),s=r(19521),u=r(67294),m=r(79632),c=r(93396),p=r(65148),f=r(49107);let v=(0,u.memo)(e=>{let{onRemove:l}=e;return(0,d.jsx)(j,{children:(0,d.jsx)(m.zx,{type:"button",kind:"functional",variant:"warning",size:"md",onClick:l,children:"Remove"})})});v.displayName="RemoveVolume";let h=(0,u.memo)(e=>{let{isStandAlone:l,fileCtrl:r,mountPathCtrl:s,useLatestCtrl:u,handleRemove:p}=(0,c.Yl)(e);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(b,{children:"Create and configure new volumes for your web3 function by either uploading a dependency file or a squashfs volume. Volumes play a crucial role in managing dependencies and providing a volume within your application."}),(0,d.jsxs)("div",{children:[l?(0,d.jsx)(m.Jy,{children:(0,d.jsx)(m.S2,{...r.field,...r.fieldState,label:"Upload volume file",required:!0})}):(0,d.jsx)(N,{children:(0,d.jsx)(m.S2,{...r.field,...r.fieldState})}),!l&&(0,d.jsx)(P,{children:(0,d.jsx)(m.oi,{...s.field,...s.fieldState,required:!0,label:"Mount",placeholder:"/mount/opt"})}),!l&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(S,{children:(0,d.jsx)(m.XZ,{...u.field,...u.fieldState,label:"Always update to the latest version"})}),p&&(0,d.jsx)(v,{onRemove:p})]})]})]})});h.displayName="AddNewVolume";let g=(0,u.memo)(e=>{let{refHashCtrl:l,mountPathCtrl:r,useLatestCtrl:s,volumeSize:u,handleRemove:p}=(0,c.Ox)(e);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(V,{children:"Link existing volumes to your web3 function by pasting the reference hash associated with each volume. Volumes are an essential component for managing dependencies within your application."}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{children:(0,d.jsx)(m.oi,{...r.field,...r.fieldState,required:!0,label:"Mount",placeholder:"/mount/opt"})}),(0,d.jsx)(C,{children:(0,d.jsx)(m.oi,{...l.field,...l.fieldState,required:!0,label:"Item hash",placeholder:"3335ad270a571b..."})}),l.field.value&&u&&(0,d.jsx)(q,{children:(0,d.jsx)(m.oi,{label:"Size",name:"size",value:u,disabled:!0})}),(0,d.jsx)(T,{children:(0,d.jsx)(m.XZ,{...s.field,...s.fieldState,checked:!!s.field.value,label:"Always update to the latest version"})}),p&&(0,d.jsx)(v,{onRemove:p})]})]})});g.displayName="AddExistingVolume";let y=(0,u.memo)(e=>{let{nameCtrl:l,mountPathCtrl:r,sizeCtrl:s,sizeValue:u,sizeHandleChange:p,handleRemove:f}=(0,c.BB)(e);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(B,{children:"Create and configure persistent storage for your web3 functions, enabling your application to maintain data across multiple invocations or sessions. You can set up a customized storage solution tailored to your application's requirements."}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{children:(0,d.jsx)(m.oi,{...l.field,...l.fieldState,required:!0,label:"Volume name",placeholder:"Redis volume"})}),(0,d.jsx)(Z,{children:(0,d.jsx)(m.oi,{...r.field,...r.fieldState,required:!0,label:"Mount",placeholder:"/mount/opt"})}),(0,d.jsx)(A,{children:(0,d.jsx)(m.oi,{...s.field,...s.fieldState,value:u,onChange:p,required:!0,type:"number",label:"Size (GB)",placeholder:"0"})}),f&&(0,d.jsx)(v,{onRemove:f})]})]})});y.displayName="AddPersistentVolume";let x=(0,u.memo)(e=>{let{size:l}=e,r=(0,f.Fx)(l,{from:"MiB",to:"GiB",displayUnit:!1});return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(E,{children:"This system volume is included with your setup. You can easily expand your storage capacity to meet your application's requirements by adding additional volumes below."}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{children:(0,d.jsx)(m.oi,{name:"system_volume_name",required:!0,label:"Volume name",placeholder:"Redis volume",value:"System Volume",dataView:!0})}),(0,d.jsx)(I,{children:(0,d.jsx)(m.oi,{name:"system_volume_mount",required:!0,label:"Mount",placeholder:"/mount/opt",value:"/",dataView:!0})}),(0,d.jsx)(k,{children:(0,d.jsx)(m.oi,{name:"system_volume_size",required:!0,type:"number",label:"Size (GB)",placeholder:"0",value:r,dataView:!0})})]})]})});x.displayName="InstanceSystemVolume";let w={[p.lf.New]:h,[p.lf.Existing]:g,[p.lf.Persistent]:y},_=(0,u.memo)(e=>{let{volumeTypeCtrl:l,defaultValue:r,...s}=(0,c.Kn)(e),f=l.field.value,v=(0,u.useMemo)(()=>w[f],[f]),h=(0,u.useMemo)(()=>[{id:p.lf.New,name:"New volume"},{id:p.lf.Existing,name:"Existing volume"},{id:p.lf.Persistent,name:"Persistent Storage"}],[]);return(0,d.jsxs)(z,{className:"bg-base1",children:[(0,d.jsx)(M,{children:(0,d.jsx)(m.mQ,{selected:f,align:"left",onTabChange:l.field.onChange,tabs:h})}),(0,d.jsx)("div",{role:"tabpanel",children:(0,d.jsx)(v,{...s,defaultValue:r})})]})});_.displayName="AddVolume",l.ZP=_;var j=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-de6qwa-0"})({marginTop:"1rem",paddingTop:"1.5rem",textAlign:"right"}),b=(0,s.ZP)("p").withConfig({displayName:"cmp___StyledP",componentId:"sc-de6qwa-1"})({marginBottom:"1.5rem",marginTop:"0.25rem"}),N=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-de6qwa-2"})({paddingTop:"1rem",paddingBottom:"1rem"}),P=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-de6qwa-3"})({marginTop:"1rem"}),S=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-de6qwa-4"})({marginTop:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}),V=(0,s.ZP)("p").withConfig({displayName:"cmp___StyledP2",componentId:"sc-de6qwa-5"})({marginBottom:"1.5rem",marginTop:"0.25rem"}),C=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-de6qwa-6"})({marginTop:"1rem"}),q=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-de6qwa-7"})({marginTop:"1rem"}),T=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-de6qwa-8"})({marginTop:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}),B=(0,s.ZP)("p").withConfig({displayName:"cmp___StyledP3",componentId:"sc-de6qwa-9"})({marginBottom:"1.5rem"}),Z=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv8",componentId:"sc-de6qwa-10"})({marginTop:"1rem"}),A=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv9",componentId:"sc-de6qwa-11"})({marginTop:"1rem"}),E=(0,s.ZP)("p").withConfig({displayName:"cmp___StyledP4",componentId:"sc-de6qwa-12"})({marginBottom:"1.5rem"}),I=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv10",componentId:"sc-de6qwa-13"})({marginTop:"1rem"}),k=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv11",componentId:"sc-de6qwa-14"})({marginTop:"1rem"}),z=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv12",componentId:"sc-de6qwa-15"})({padding:"1.5rem"}),M=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv13",componentId:"sc-de6qwa-16"})({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"0.75rem"})},34747:function(e,l,r){"use strict";r.d(l,{Z:function(){return d.ZP},n:function(){return d.nx}});var d=r(36846)},93396:function(e,l,r){"use strict";r.d(l,{BB:function(){return useAddPersistentVolumeProps},Kn:function(){return useAddVolume},Ox:function(){return useAddExistingVolumeProps},Yl:function(){return useAddNewVolumeProps},Yz:function(){return c}});var d=r(67294),s=r(49107),u=r(65148),m=r(87536);let c={volumeType:u.lf.New};function useAddNewVolumeProps(e){let{name:l="",index:r,control:d,defaultValue:s,onRemove:u}=e,c=void 0===r,p=c?l:"".concat(l,".").concat(r),f=(0,m.bc)({control:d,name:"".concat(p,".file"),defaultValue:null==s?void 0:s.file}),v=(0,m.bc)({control:d,name:"".concat(p,".mountPath"),defaultValue:null==s?void 0:s.mountPath}),h=(0,m.bc)({control:d,name:"".concat(p,".useLatest"),defaultValue:null==s?void 0:s.useLatest});return{isStandAlone:void 0===r,fileCtrl:f,mountPathCtrl:v,useLatestCtrl:h,handleRemove:u}}function useAddExistingVolumeProps(e){let{name:l="",index:r,control:c,defaultValue:p,onRemove:f}=e,v=(0,m.bc)({control:c,name:"".concat(l,".").concat(r,".refHash"),defaultValue:null==p?void 0:p.refHash}),h=(0,m.bc)({control:c,name:"".concat(l,".").concat(r,".mountPath"),defaultValue:null==p?void 0:p.mountPath}),g=(0,m.bc)({control:c,name:"".concat(l,".").concat(r,".useLatest"),defaultValue:null==p?void 0:p.useLatest}),{value:y}=v.field,[x,w]=(0,d.useState)("");return(0,d.useEffect)(()=>{(async function(){let e=await u.l8.getVolumeSize({volumeType:u.lf.Existing,refHash:y}),l=(0,s.eB)(e,"MiB");w(l)})()},[y]),{refHashCtrl:v,mountPathCtrl:h,useLatestCtrl:g,volumeSize:x,handleRemove:f}}function useAddPersistentVolumeProps(e){let{name:l="",index:r,control:u,defaultValue:c,onRemove:p}=e,f=(0,m.bc)({control:u,name:"".concat(l,".").concat(r,".name"),defaultValue:null==c?void 0:c.name}),v=(0,m.bc)({control:u,name:"".concat(l,".").concat(r,".mountPath"),defaultValue:null==c?void 0:c.mountPath}),h=(0,m.bc)({control:u,name:"".concat(l,".").concat(r,".size"),defaultValue:null==c?void 0:c.size}),g=(0,d.useCallback)(e=>{let l=Number(e.target.value),r=(0,s.Fx)(l,{from:"GiB",to:"MiB",displayUnit:!1});h.field.onChange(r)},[h.field]),y=(0,d.useMemo)(()=>h.field.value?(0,s.Fx)(h.field.value,{from:"MiB",to:"GiB",displayUnit:!1}):void 0,[h.field]);return{nameCtrl:f,mountPathCtrl:v,sizeCtrl:h,sizeValue:y,sizeHandleChange:g,handleRemove:p}}function useAddVolume(e){let{name:l="volumes",index:r,control:s,defaultValue:c,onRemove:p}=e,f=void 0===r,v=f?l:"".concat(l,".").concat(r),h=(0,m.bc)({control:s,name:"".concat(v,".volumeType"),defaultValue:u.lf.New}),g=(0,d.useCallback)(()=>{p&&p(r)},[r,p]);return{name:l,index:r,control:s,volumeTypeCtrl:h,defaultValue:c,onRemove:g}}},67828:function(e,l,r){"use strict";r.r(l),r.d(l,{default:function(){return B}});var d=r(85893),s=r(19521),u=r(67294),m=r(9911),c=r(11163),p=r(65148),f=r(55032),v=r(24959),h=r(90805),g=r(87536),y=r(56312),x=r(37419),w=r(86780),_=r(9324),j=r(50586);let b={volumeType:p.lf.New};var N=r(79632),P=r(68805),S=r(93963),V=r(34747),C=r(75650),q=r(49531),T=r(93788),B=u.memo(function(){let{control:e,address:l,accountBalance:r,isCreateButtonDisabled:s,errors:B,cost:A,handleSubmit:E,handleBack:I}=function(){let e=(0,c.useRouter)(),[l,r]=(0,f.mr)(),{account:d,balance:s=0}=l.connection,N=(0,h.B)(),{next:P,stop:S}=(0,w.A)({}),V=(0,u.useCallback)(async l=>{if(!N)throw j.Z.ConnectYourWallet;let d=await N.getAddSteps(l),s=d.map(e=>w.n[e]),u=N.addSteps(l);try{let l;for(;!l;){let{value:e,done:r}=await u.next();if(r){l=e[0];break}await P(s)}r(new _.Wy({name:"volume",entities:l})),await e.replace("/")}finally{await S()}},[r,N,P,e,S]),{control:C,handleSubmit:q,formState:{errors:T}}=(0,v.c)({defaultValues:b,onSubmit:V,resolver:(0,y.F)(p.l8.addSchema)}),B=(0,g.qo)({control:C}),Z=(0,u.useMemo)(()=>B,[B]),A=(0,u.useMemo)(()=>({entityType:m.py.Volume,props:{volume:Z}}),[Z]),E=(0,x.F)(A),I=s>=((null==E?void 0:E.cost)||Number.MAX_SAFE_INTEGER);return{address:(null==d?void 0:d.address)||"",accountBalance:s,isCreateButtonDisabled:!I,values:B,control:C,errors:T,cost:E,handleSubmit:q,handleBack:()=>{e.push("/storage/")}}}();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(T.Z,{handleBack:I}),(0,d.jsxs)(C.l,{onSubmit:E,errors:B,children:[(0,d.jsx)(Z,{children:(0,d.jsxs)(S.Z,{children:[(0,d.jsx)(q.N,{number:"1",children:"Add volume"}),(0,d.jsx)(V.n,{control:e})]})}),(0,d.jsx)(P.Z,{address:l,cost:A,unlockedAmount:r,paymentMethod:m.XL.Hold,description:(0,d.jsx)(d.Fragment,{children:"This amount needs to be present in your wallet until the volume is removed. Tokens won 't be locked nor consumed. The volume will be garbage collected once funds are removed from the wallet."}),button:(0,d.jsx)(N.zx,{type:"submit",color:"main0",kind:"default",size:"lg",variant:"primary",disabled:s,children:"Create volume"})})]})]})}),Z=(0,s.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-1soo596-0"})({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}})},56312:function(e,l,r){"use strict";r.d(l,{F:function(){return zod_t}});var d=r(87536),t=function(e,l,r){if(e&&"reportValidity"in e){var s=(0,d.U2)(r,l);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},resolvers_i=function(e,l){var i=function(r){var d=l.fields[r];d&&d.ref&&"reportValidity"in d.ref?t(d.ref,r,e):d.refs&&d.refs.forEach(function(l){return t(l,r,e)})};for(var r in l.fields)i(r)},n=function(e,l){l.shouldUseNativeValidation&&resolvers_i(e,l);var r={};for(var s in e){var u=(0,d.U2)(l.fields,s),m=Object.assign(e[s]||{},{ref:u&&u.ref});if(a(l.names||Object.keys(e),s)){var c=Object.assign({},o((0,d.U2)(r,s)));(0,d.t8)(c,"root",m),(0,d.t8)(r,s,c)}else(0,d.t8)(r,s,m)}return r},o=function(e){return Array.isArray(e)?e.filter(Boolean):[]},a=function(e,l){return e.some(function(e){return e.startsWith(l+".")})},zod_n=function(e,l){for(var r={};e.length;){var s=e[0],u=s.code,m=s.message,c=s.path.join(".");if(!r[c]){if("unionErrors"in s){var p=s.unionErrors[0].errors[0];r[c]={message:p.message,type:p.code}}else r[c]={message:m,type:u}}if("unionErrors"in s&&s.unionErrors.forEach(function(l){return l.errors.forEach(function(l){return e.push(l)})}),l){var f=r[c].types,v=f&&f[s.code];r[c]=(0,d.KN)(c,l,r,u,v?[].concat(v,s.message):s.message)}e.shift()}return r},zod_t=function(e,l,r){return void 0===r&&(r={}),function(d,s,u){try{return Promise.resolve(function(s,m){try{var c=Promise.resolve(e["sync"===r.mode?"parse":"parseAsync"](d,l)).then(function(e){return u.shouldUseNativeValidation&&resolvers_i({},u),{errors:{},values:r.raw?d:e}})}catch(e){return m(e)}return c&&c.then?c.then(void 0,m):c}(0,function(e){if(null!=e.errors)return{values:{},errors:n(zod_n(e.errors,!u.shouldUseNativeValidation&&"all"===u.criteriaMode),u)};throw e}))}catch(e){return Promise.reject(e)}}}}},function(e){e.O(0,[536,406,774,888,179],function(){return e(e.s=37313)}),_N_E=e.O()}]);