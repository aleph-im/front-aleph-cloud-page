(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5162],{15877:function(e,r,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/permissions/new",function(){return o(7422)}])},19584:function(e,r,o){"use strict";var a=o(85893),l=o(57833),d=o(73899);r.Z=e=>{let{handleBack:r}=e;return(0,a.jsx)(d.zx,{kind:"functional",variant:"textOnly",onClick:r,children:(0,a.jsxs)(c,{className:"tp-info text-base2",children:[(0,a.jsx)(d.JO,{name:"arrow-left"})," Back"]})})};var c=(0,l.ZP)("p").withConfig({displayName:"cmp___StyledP",componentId:"sc-1jijf1x-0"})({display:"flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",textAlign:"center"})},93788:function(e,r,o){"use strict";o.d(r,{Z:function(){return BackButtonSection_cmp}});var a=o(85893),l=o(57833),d=o(19584),c=o(99983),BackButtonSection_cmp=e=>{let{handleBack:r}=e;return(0,a.jsx)(u,{children:(0,a.jsx)(c.F,{children:(0,a.jsx)(d.Z,{handleBack:r})})})},u=(0,l.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-o42jnx-0"})({paddingTop:"0px !important",paddingBottom:"0px !important",paddingLeft:"0px",paddingRight:"0px","@media (min-width: 48rem)":{paddingTop:"2.5rem !important"}})},72882:function(e,r,o){"use strict";o.d(r,{ZP:function(){return f}});var a=o(85893),l=o(67294),d=o(73899),c=o(43251),u=o(57833);let p=(0,u.ZP)(d.JO).attrs(e=>{let{buttonSize:r}=e;return{size:(()=>{switch(r){case"xs":return"xs";case"sm":return"sm";case"lg":return"md-lg";case"xl":return"lg";default:return"md"}})()}}).withConfig({displayName:"styles__InfoIcon",componentId:"sc-15zds0b-0"})(["opacity:0.8;"]),m=(0,l.forwardRef)((e,r)=>{let{tooltipContent:o,tooltipPosition:u,children:m,disabled:f,size:h,...g}=e,[x,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{v(!0)},[]);let y=(0,l.useRef)(null),b=r||y;return(0,a.jsxs)("div",{className:"inline-flex relative",children:[(0,a.jsx)(d.zx,{ref:b,disabled:f,size:h,...g,children:(0,a.jsxs)(a.Fragment,{children:[m,f&&o&&(0,a.jsx)(p,{name:"info-circle",buttonSize:h})]})}),x&&f&&o&&(0,a.jsx)(c.Z,{my:(null==u?void 0:u.my)||"bottom-center",at:(null==u?void 0:u.at)||"top-center",targetRef:b,content:o})]})});m.displayName="ButtonWithInfoTooltip";var f=m},99983:function(e,r,o){"use strict";o.d(r,{F:function(){return c}});var a=o(57833);let l={xl:90,lg:60.0625,md:44.6875},d=a.ZP.div.withConfig({displayName:"styles__StyledContainer",componentId:"sc-1bpjbi2-0"})(["",""],e=>{let{$variant:r="lg"}=e;return(0,a.iv)([""," max-width:","rem;"],{marginLeft:"auto",marginRight:"auto",width:"100%",paddingLeft:"1.5rem",paddingRight:"1.5rem","@media (min-width: 62rem)":{paddingLeft:"4rem",paddingRight:"4rem"}},l[r])});var c=d},49531:function(e,r,o){"use strict";o.d(r,{N:function(){return c}});var a=o(85893),l=o(67294),d=o(73899);let SectionTitle=e=>{let{forwardedAs:r,...o}=e;return(0,a.jsx)(d.NP,{as:"h2",color:"main0",numberColor:"main0",...o})};SectionTitle.displayName="SectionTitle";var c=(0,l.memo)(SectionTitle)},43251:function(e,r,o){"use strict";o.d(r,{Z:function(){return u}});var a=o(85893),l=o(57833),d=o(67294),c=o(73899);let ResponsiveTooltip=e=>{let{forwardedAs:r,as:o,...l}=e,d=(0,c._K)("md");return(0,a.jsx)(p,{...l,$_css:d?{position:"fixed !important",left:"0px !important",top:"0px !important",zIndex:"20 !important",margin:"1.5rem",height:"calc(100% - 3rem) !important",width:"calc(100% - 3rem) !important",maxWidth:"100% !important",transform:"none !important"}:""})};ResponsiveTooltip.displayName="ResponsiveTooltip";var u=(0,d.memo)(ResponsiveTooltip),p=(0,l.ZP)(c.u).withConfig({displayName:"cmp___StyledTooltip",componentId:"sc-vdmo8c-0"})(["",""],e=>e.$_css)},20665:function(e,r,o){"use strict";o.d(r,{Z:function(){return u}});var a=o(57833),l=o(73899);let d=(0,a.F4)(["0%,100%{transform:translateY(-50%) scale(1);}14%{transform:translateY(-50%) scale(1.08);}28%{transform:translateY(-50%) scale(1);}42%{transform:translateY(-50%) scale(1.05);}56%{transform:translateY(-50%) scale(1);}"]),c=(0,a.ZP)(l.iA).attrs((0,l.PT)("tp-body3")).withConfig({displayName:"styles__StyledTable",componentId:"sc-1rehsz-0"})(["",""],e=>{let{theme:r,clickableRows:o=!1,rowBackgroundColors:l=["light0","purple1"],hoverHighlight:c=!0}=e,{duration:u,timing:p}=r.transition,[m,f]=l;return(0,a.iv)([".check-button{transition:all "," ","ms 0ms;background:",";color:",";width:3.75rem;height:2rem;min-height:2rem;visibility:hidden;opacity:0;&::after{display:none;}&:disabled{background:",";}}border-collapse:separate;border-spacing:0 1rem;thead{color:",";background:",";th > div{opacity:1 !important;}}tbody{tr{cursor:",";background:",";height:4rem;td{transition:all "," ","ms 0ms;background:",";&.fx-noise-light{background:",";}}&:hover,&._active{.check-button{visibility:visible;opacity:1;}}"," &._active{cursor:not-allowed;td{background:",";}}&._disabled{td{color:",";background:inherit;opacity:0.8;cursor:not-allowed;}}&._spotlight{box-shadow:0px 4px 24px ","26;border-radius:0.5rem;td{box-shadow:inset 0 4px 0 0 ",",inset 0 -4px 0 0 ",";}td:first-child{position:relative;border-radius:0.5rem 0 0 0.5rem;box-shadow:inset 4px 0 0 0 ",",inset 0 4px 0 0 ",",inset 0 -4px 0 0 ",";}td:last-child{border-radius:0 0.5rem 0.5rem 0;box-shadow:inset -4px 0 0 0 ",",inset 0 4px 0 0 ",",inset 0 -4px 0 0 ",";}.spotlight-label{position:absolute;left:0.5rem;top:0;transform:translateY(-50%);background:",";color:",";border:4px solid ",";font-family:",";font-size:0.75rem;font-weight:800;font-style:italic;text-transform:uppercase;letter-spacing:0.05em;padding:0.25rem 0.75rem;border-radius:1rem;white-space:nowrap;pointer-events:none;z-index:1;animation:"," 1.8s ease-in-out infinite;}}}}td,th{","}"],p,u.fast,r.color.purple0,r.color.main0,r.color.purple0,r.color.text,e=>{let{theme:r}=e;return r.color.purple1},o?"pointer":"default",r.color[f],p,u.fast,r.color[m],r.color.light1,c&&(0,a.iv)(["&:hover{td{background:","50;}}"],r.color.purple4),r.color.purple4,r.color.disabled,r.color.main0,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple4,r.color.purple0,r.color.error,r.color.error,r.font.family.head,d,{width:"0px",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingLeft:"1.5rem",paddingRight:"1.5rem",paddingTop:"0.25rem",paddingBottom:"0.25rem"})});var u=c},77205:function(e,r,o){"use strict";o.d(r,{F:function(){return useRequestEntities}});var a=o(67294),l=o(25093),d=o(9324),c=o(73899);function useAppStoreEntityRequest(e){let[r,o]=(0,l.mr)();return function(e){let{state:r,dispatch:o,name:l,cacheStrategy:u="overwrite",...p}=e,m=r[l],f=(0,a.useMemo)(()=>{let{entities:e,keys:r,...o}=m;return{data:e,...o}},[m]);return(0,c.QT)({state:f,setState:e=>{switch(u){case"none":break;case"overwrite":o(new d.B9({name:l,state:e}));break;case"merge":o(new d.Wy({name:l,entities:e.data||[]}))}},...p})}({state:r,dispatch:o,...e})}let handleSingleEntityRequest=async function(e,r,o){var a;let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!l&&(null==o?void 0:null===(a=o.entities)||void 0===a?void 0:a.length)){let e=o.entities.find(e=>e.id===r);if(e)return[e]}let d=await e.get(r);return d?[d]:[]},handleMultipleEntitiesRequest=async function(e,r,o){var a;let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!r.length)return[];if(!l&&(null==o?void 0:null===(a=o.entities)||void 0===a?void 0:a.length)){let e=o.entities.map(e=>e.id),a=r.every(r=>e.includes(r));if(a)return o.entities.filter(e=>r.includes(e.id))}return e.getAll({ids:r})},handleAllEntitiesRequest=async function(e,r){var o;let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!a&&(null==r?void 0:null===(o=r.entities)||void 0===o?void 0:o.length)?r.entities:e.getAll({})};function useRequestEntities(e){let{name:r,manager:o,ids:d,triggerDeps:c=[],triggerOnMount:u=!0}=e,[p]=(0,l.mr)(),{account:m}=p.connection;c=[m,d,...c];let f=(0,a.useMemo)(()=>"string"==typeof d?"single":Array.isArray(d)?"multiple":"all",[d]),h=(0,a.useMemo)(()=>{switch(f){case"single":case"multiple":return"merge";case"all":return"overwrite"}},[f]),{data:g,loading:x,request:v}=useAppStoreEntityRequest({name:r,doRequest:async()=>{if(!o)return[];let e=p[r];switch(f){case"single":return handleSingleEntityRequest(o,d,e);case"multiple":return handleMultipleEntitiesRequest(o,d,e);case"all":return handleAllEntitiesRequest(o,e)}},onSuccess:()=>null,flushData:!0,triggerOnMount:u,triggerDeps:c,cacheStrategy:h}),{request:y}=useAppStoreEntityRequest({name:r,doRequest:async()=>{if(!o)return[];let e=p[r];switch(f){case"single":return handleSingleEntityRequest(o,d,e,!0);case"multiple":return handleMultipleEntitiesRequest(o,d,e,!0);case"all":return handleAllEntitiesRequest(o,e,!0)}},onSuccess:()=>null,flushData:!0,triggerOnMount:!1,triggerDeps:[],cacheStrategy:h}),b=(0,a.useMemo)(()=>{if(!g)return g;switch(f){case"single":return g.filter(e=>e.id===d);case"multiple":return g.filter(e=>d.includes(e.id));default:return g}},[g,f,d]);return!function(e){let{entities:r=[],request:o,triggerOnMount:l}=e;(0,a.useEffect)(()=>{if(!l)return;let e=(Array.isArray(r)?r:[r]).filter(e=>!e.confirmed);if(!e.length)return;let a=setInterval(o,1e4);return()=>clearInterval(a)},[r,o,l])}({entities:b,request:v,triggerOnMount:u}),{entities:b,loading:x,refetch:y}}},7422:function(e,r,o){"use strict";o.r(r),o.d(r,{default:function(){return NewInstancePage}});var a=o(85893),l=o(57833),d=o(67294),c=o(9008),u=o.n(c),p=o(73899),m=o(72882),f=o(99983),h=o(11163),g=o(24959),x=o(87536),v=o(86780),y=o(72648),b=o(50586),w=o(75968),j=o(43459),_=o(60566),R=o(56312),S=o(27107),k=o(9911),N=o(75650),C=o(49531),P=o(93788),T=o(85661),E=o(35464),Z=o(16031);let A=d.memo(e=>{let{disabled:r,title:o="Save permissions",tooltipContent:l,isFooter:c,handleSubmit:u}=e,p=(0,d.useRef)(null);return(0,a.jsx)(m.ZP,{ref:p,type:"submit",color:"main0",kind:"default",size:"lg",variant:"primary",disabled:r,tooltipContent:l,tooltipPosition:{my:c?"bottom-right":"bottom-center",at:c?"top-right":"top-center"},onClick:u,children:o})});function NewInstancePage(e){let{mainRef:r}=e,{createPermissionDisabled:o,createPermissionDisabledMessage:l,createPermissionButtonTitle:c,control:m,errors:L,handleSubmit:D,handleBack:V,addressCtrl:Y,aliasCtrl:U,isDirty:W}=function(){let{account:e}=(0,y.R)({triggerOnMount:!1}),r=(0,h.useRouter)(),o=(0,d.useCallback)(()=>{r.push(".")},[r]),l=(0,w.o)(),{refetch:c}=(0,S.M)({triggerOnMount:!1}),{noti:u,next:p,stop:m}=(0,v.A)({}),f=(0,d.useCallback)(async r=>{if(!l)throw b.Z.ConnectYourWallet;if(!e)throw b.Z.InvalidAccount;let o={id:r.address,alias:r.alias,channels:r.permissions.channels,messageTypes:r.permissions.messageTypes,revoked:!1},a=await l.getAddSteps(),d=a.map(e=>v.n[e]),c=l.addNewAccountPermissionSteps(o);try{let e;for(;!e;){let{value:r,done:o}=await c.next();if(o){e=r;break}await p(d)}}finally{await m()}},[l,e,p,m]),N=(0,d.useCallback)(async()=>{null==u||u.add({variant:"info",title:"Permission created",text:"Redirecting to permissions page..."}),await new Promise(e=>setTimeout(e,2e3)),await c(),r.push(k.cr.console.permissions.home)},[r,u,c]),C=(0,d.useMemo)(()=>({address:"",alias:"",permissions:{channels:[],messageTypes:[{type:_.Cs.post,postTypes:[],authorized:!1},{type:_.Cs.aggregate,aggregateKeys:[],authorized:!1},{type:_.Cs.instance,authorized:!1},{type:_.Cs.program,authorized:!1},{type:_.Cs.store,authorized:!1}]}}),[]),{control:P,handleSubmit:T,formState:{errors:E,isDirty:Z}}=(0,g.c)({defaultValues:C,onSubmit:f,onSuccess:N,resolver:(0,R.F)(j.x.addSchema),readyDeps:[]}),A=(0,x.qo)({control:P}),q=(0,x.bc)({control:P,name:"address"}),B=(0,x.bc)({control:P,name:"alias"}),I=(0,d.useMemo)(()=>{if(!e)return function(e){let{title:r,description:o}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"tp-body3 fs-18 text-base2",children:r}),(0,a.jsx)("p",{className:"tp-body1 fs-14 text-base2",children:o})]})}({title:"Account connection required",description:"Please connect your account to ".concat("create a new permission",".\n                  Connect your wallet using the top-right button to access all features.")})},[e]),z=(0,d.useMemo)(()=>e?"Save permissions":"Connect",[e]),M=(0,d.useMemo)(()=>"Save permissions"!==z||!!I,[z,I]);return{createPermissionDisabled:M,createPermissionDisabledMessage:I,createPermissionButtonTitle:z,values:A,control:P,errors:E,handleSubmit:T,handleBack:o,addressCtrl:q,aliasCtrl:B,isDirty:Z}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u(),{children:[(0,a.jsx)("title",{children:"Console | New Permission | Aleph Cloud"}),(0,a.jsx)("meta",{name:"description",content:"Delegate permissions to your resources in Aleph Cloud"})]}),(0,a.jsx)(P.Z,{handleBack:V}),(0,a.jsxs)(N.Z,{onSubmit:D,errors:L,children:[l&&(0,a.jsx)(q,{children:(0,a.jsx)(f.F,{children:(0,a.jsx)(T.Z,{$color:"warning",children:l})})}),(0,a.jsx)(B,{children:(0,a.jsxs)(f.F,{children:[(0,a.jsx)(C.N,{number:1,children:"Recipient"}),(0,a.jsx)(I,{children:(0,a.jsx)(p.Jy,{children:(0,a.jsxs)(z,{className:"bg-light1",children:[(0,a.jsx)(p.oi,{...Y.field,...Y.fieldState,label:"Recipient account address",required:!0,placeholder:"Wallet address 0x..."}),(0,a.jsx)(p.oi,{...U.field,...U.fieldState,label:"Account alias",required:!0,placeholder:"Alias (for your reference)"})]})})})]})}),(0,a.jsx)(M,{children:(0,a.jsxs)(f.F,{children:[(0,a.jsx)(C.N,{number:2,children:"Permissions"}),(0,a.jsx)("p",{className:"tp-body1",children:"Select what this account may do and revoke access at any time."}),(0,a.jsx)(F,{children:(0,a.jsx)(Z.Z,{control:m})})]})}),(0,a.jsx)(E.Z,{containerRef:r,shouldHide:!1,shouldRender:W,children:(0,a.jsx)(O,{children:(0,a.jsx)(A,{disabled:o,title:c,tooltipContent:l,isFooter:!0,handleSubmit:D})})})]})]})}A.displayName="CheckoutButton";var q=(0,l.ZP)("section")({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}}),B=(0,l.ZP)("section")({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}}),I=(0,l.ZP)("div")({position:"relative",marginBottom:"1.5rem",marginTop:"3rem",minHeight:"6rem",paddingLeft:"0px",paddingRight:"0px"}),z=(0,l.ZP)("div")({display:"flex",flexDirection:"column",rowGap:"1rem",padding:"1.5rem"}),M=(0,l.ZP)("section")({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}}),F=(0,l.ZP)("div")({marginTop:"1.5rem"}),O=(0,l.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-1r36ivm-0"})({display:"flex",width:"100%",alignItems:"center",justifyContent:"flex-end",paddingLeft:"1.5rem",paddingRight:"1.5rem",paddingTop:"1rem",paddingBottom:"1rem"})},56312:function(e,r,o){"use strict";o.d(r,{F:function(){return t}});var a=o(87536);let s=(e,r,o)=>{if(e&&"reportValidity"in e){let l=(0,a.U2)(o,r);e.setCustomValidity(l&&l.message||""),e.reportValidity()}},resolvers_o=(e,r)=>{for(let o in r.fields){let a=r.fields[o];a&&a.ref&&"reportValidity"in a.ref?s(a.ref,o,e):a.refs&&a.refs.forEach(r=>s(r,o,e))}},resolvers_r=(e,r)=>{r.shouldUseNativeValidation&&resolvers_o(e,r);let o={};for(let l in e){let d=(0,a.U2)(r.fields,l),c=Object.assign(e[l]||{},{ref:d&&d.ref});if(i(r.names||Object.keys(e),l)){let e=Object.assign({},(0,a.U2)(o,l));(0,a.t8)(e,"root",c),(0,a.t8)(o,l,e)}else(0,a.t8)(o,l,c)}return o},i=(e,r)=>e.some(e=>e.startsWith(r+"."));var n=function(e,r){for(var o={};e.length;){var l=e[0],d=l.code,c=l.message,u=l.path.join(".");if(!o[u]){if("unionErrors"in l){var p=l.unionErrors[0].errors[0];o[u]={message:p.message,type:p.code}}else o[u]={message:c,type:d}}if("unionErrors"in l&&l.unionErrors.forEach(function(r){return r.errors.forEach(function(r){return e.push(r)})}),r){var m=o[u].types,f=m&&m[l.code];o[u]=(0,a.KN)(u,r,o,d,f?[].concat(f,l.message):l.message)}e.shift()}return o},t=function(e,r,o){return void 0===o&&(o={}),function(a,l,d){try{return Promise.resolve(function(l,c){try{var u=Promise.resolve(e["sync"===o.mode?"parse":"parseAsync"](a,r)).then(function(e){return d.shouldUseNativeValidation&&resolvers_o({},d),{errors:{},values:o.raw?a:e}})}catch(e){return c(e)}return u&&u.then?u.then(void 0,c):u}(0,function(e){if(Array.isArray(null==e?void 0:e.errors))return{values:{},errors:resolvers_r(n(e.errors,!d.shouldUseNativeValidation&&"all"===d.criteriaMode),d)};throw e}))}catch(e){return Promise.reject(e)}}}}},function(e){e.O(0,[7536,2243,9774,2888,179],function(){return e(e.s=15877)}),_N_E=e.O()}]);