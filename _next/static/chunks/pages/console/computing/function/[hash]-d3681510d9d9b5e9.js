(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1273],{56383:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/computing/function/[hash]",function(){return i(95357)}])},33223:function(e,n,i){"use strict";i.d(n,{k:function(){return useProgramManager}});var t=i(9754);function useProgramManager(){let[e]=(0,t.mr)(),{programManager:n}=e.manager;return n}},16368:function(e,n,i){"use strict";i.d(n,{n:function(){return useRequestPrograms}});var t=i(33223),s=i(77205);function useRequestPrograms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.k)();return(0,s.F)({...e,manager:n,name:"program"})}},95357:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return ManageFunction}});var t=i(85893),s=i(19521),l=i(9008),o=i.n(l),d=i(9911),a=i(79632),r=i(67294),c=i(11163),m=i(33223),u=i(16368),p=i(50586),h=i(57125),x=i(49107),y=i(37850),g=i(36286),j=i(50090),f=i(63831),v=i(1712),_=i(69429),b=i(25491),C=i(2334),w=i(98642),k=i(47104),Z=i(76696),I=i(77541),D=i(33697);let ProgramDetails=e=>{let{program:n}=e,i=(0,a.vx)((null==n?void 0:n.id)||"");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P,{className:"tp-h7 fs-24",children:"FUNCTION DETAILS"}),(0,t.jsx)(a.Jy,{children:(0,t.jsxs)(E,{children:[(0,t.jsx)(S,{id:d.DA[d.py.Program],color:"main0",size:"6rem"}),(0,t.jsxs)(M,{children:[(0,t.jsxs)(O,{children:[(0,t.jsx)(D.Z,{children:"ITEM HASH"}),n?(0,t.jsx)(Z.Z,{iconName:"copy",onClick:i,children:n.id}):(0,t.jsx)(k.Z,{width:"100%"})]}),(0,t.jsxs)(R,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"CORES"}),(0,t.jsx)("div",{children:(0,t.jsx)(T,{children:(null==n?void 0:n.resources)?"".concat(n.resources.vcpus," x86 64bit"):(0,t.jsx)(k.Z,{width:"7rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"RAM"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:(null==n?void 0:n.resources)?(0,x.Fx)(n.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0}):(0,t.jsx)(k.Z,{width:"4rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"TIMEOUT"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:n?"".concat(n.resources.seconds,"s"):(0,t.jsx)(k.Z,{width:"6rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"SIZE"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:n?(0,x.eB)(n.size||0,"MiB"):(0,t.jsx)(k.Z,{width:"6rem"})})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"EXPLORER"}),(0,t.jsx)("div",{children:n?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:n.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(Z.Z,{iconName:"square-up-right",children:(0,t.jsx)(I.x,{children:(0,x.bs)(n.url,80)})})}):(0,t.jsx)(k.Z,{width:"20rem"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"API ENTRYPOINT"}),(0,t.jsx)("div",{children:n?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:n.urlVM,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(Z.Z,{iconName:"square-up-right",children:(0,t.jsx)(I.x,{children:(0,x.bs)(n.urlVM,80)})})}):(0,t.jsx)(k.Z,{width:"20rem"})})]})]})]})})]})};ProgramDetails.displayName="ProgramDetails";var N=(0,r.memo)(ProgramDetails),P=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-1naknab-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),E=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1naknab-1"})({display:"flex",gap:"1rem"}),S=(0,s.ZP)(a._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-1naknab-2"})({minHeight:"7rem",minWidth:"7rem"}),M=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-1naknab-3"})({display:"flex",width:"100%",flexDirection:"column",gap:"1rem"}),O=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-1naknab-4"})({width:"100%"}),R=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-1naknab-5"})({display:"flex",flexWrap:"wrap",gap:"1rem"}),T=(0,s.ZP)(I.x).withConfig({displayName:"cmp___StyledText",componentId:"sc-1naknab-6"})({display:"flex",alignItems:"center",gap:"0.25rem"}),V=i(29159);let EntityLinkedRuntime=e=>{let{loading:n,runtimeVolumeId:i,comment:s,onRuntimeVolumeClick:l}=e,o=(0,a.vx)(i||""),c=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A,{className:"tp-h7 fs-24",children:"LINKED RUNTIME"}),(0,t.jsx)(a.Jy,{children:(0,t.jsx)(F,{children:(0,t.jsxs)(B,{children:[(0,t.jsxs)(V.Z,{disabled:!i,onClick:()=>i&&l(i),children:[(0,t.jsx)(J,{id:d.DA[d.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsx)(W,{children:(0,t.jsx)("div",{className:"tp-info",children:n?(0,t.jsx)(k.Z,{width:"12rem"}):null!=s?s:(0,x.bs)(i,6,12)})}),(0,t.jsx)(H,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(C.L,{onClick:c,disabled:!i,children:[(0,t.jsx)(a.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedRuntime.displayName="EntityLinkedRuntime";var L=(0,r.memo)(EntityLinkedRuntime),A=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-1kb32yd-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),F=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1kb32yd-1"})({display:"flex",flexDirection:"column",gap:"1rem"}),B=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-1kb32yd-2"})({display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),J=(0,s.ZP)(a._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-1kb32yd-3"})({minHeight:"3rem",minWidth:"3rem"}),W=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-1kb32yd-4"})({display:"flex",flexDirection:"column",alignItems:"flex-start"}),H=(0,s.ZP)(a.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-1kb32yd-5"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),q=i(62394),z=i(27917),G=i(14215);let EntityLinkedCodebase=e=>{let{loading:n,codebaseVolumeId:i,entrypoint:s,onCodebaseVolumeClick:l}=e,o=(0,a.vx)(i||""),c=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X,{className:"tp-h7 fs-24",children:"LINKED CODEBASE"}),(0,t.jsx)(a.Jy,{children:(0,t.jsx)(Y,{children:(0,t.jsxs)(K,{children:[(0,t.jsxs)(V.Z,{disabled:!i,onClick:()=>i&&l(i),children:[(0,t.jsx)(Q,{id:d.DA[d.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(D.Z,{children:"ENTRYPOINT"}),(0,t.jsx)(I.x,{children:!s||n?(0,t.jsx)(k.Z,{width:"6rem"}):s})]}),(0,t.jsx)($,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(C.L,{onClick:c,disabled:!i,children:[(0,t.jsx)(a.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedCodebase.displayName="EntityLinkedCodebase";var U=(0,r.memo)(EntityLinkedCodebase),X=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-beir4t-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),Y=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-beir4t-1"})({display:"flex",flexDirection:"column",gap:"1rem"}),K=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-beir4t-2"})({marginTop:"-0.5rem",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),Q=(0,s.ZP)(a._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-beir4t-3"})({minHeight:"3rem",minWidth:"3rem"}),$=(0,s.ZP)(a.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-beir4t-4"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),ee=i(91986),en=i(21204),ei=i(73635),et=i(40256),es=i(24541);function ManageFunction(){var e,n;let{program:i,name:s,labelVariant:l,isPersistent:k,isAllocated:Z,nodeDetails:I,immutableVolumes:D,persistentVolumes:P,customDomains:E,handleCustomDomainClick:S,paymentData:M,logs:O,logsDisabled:R,handleDownloadLogs:T,isDownloadingLogs:V,stopDisabled:A,handleStop:F,startDisabled:B,handleStart:J,rebootDisabled:W,handleReboot:H,deleteDisabled:X,handleDelete:Y,downloadDisabled:K,handleDownload:Q,setTabId:$,sliderActiveIndex:ed,sidePanel:ea,closeSidePanel:er,handleRuntimeVolumeClick:ec,handleCodebaseVolumeClick:em,handleImmutableVolumeClick:eu,handleBack:ep}=function(){let e=(0,c.useRouter)(),{hash:n}=e.query,{entities:i}=(0,u.n)({ids:n}),[t]=i||[],s=(0,m.k)(),[l,o]=(0,r.useState)("detail"),d="log"===l,a=(0,h.y)({executable:t,manager:s,subscribeLogs:d}),{logs:v,logsDisabled:_}=a,b=(0,r.useMemo)(()=>!!(null==t?void 0:t.on.persistent),[t]),C=(0,r.useMemo)(()=>b?a.isAllocated:!!(null==t?void 0:t.confirmed),[a,t,b]),w=(0,r.useMemo)(()=>!t||!C||_,[C,_,t]),{customDomains:k}=(0,f.Z)({entityId:null==t?void 0:t.id}),Z=(0,r.useCallback)(e=>{D({title:"Custom Domain",isOpen:!0,type:"domain",selectedDomain:e})},[]),[I,D]=(0,r.useState)({title:"",isOpen:!1}),N=(0,r.useMemo)(()=>{var e;return t?(null==t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.name)||(0,x.zN)(t.id):""},[t]),P=(0,r.useMemo)(()=>t&&t.time<Date.now()-45e3&&C?"success":"warning",[t,C]),E=(0,r.useMemo)(()=>"log"===l?1:0,[l]),{persistentVolumes:S,immutableVolumes:M}=(0,j.Z)({volumes:null==t?void 0:t.volumes}),[O,R]=(0,r.useState)(),[T,V]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let fetchCost=async()=>{if((null==t?void 0:t.payment)&&s){V(!0);try{let e=await s.getTotalCostByHash(t.payment.type,t.id);R(e)}catch(e){console.error("Error fetching cost:",e)}finally{V(!1)}}};fetchCost()},[t,s]);let L=(0,r.useMemo)(()=>(null==t?void 0:t.time)?Math.floor(Date.now()-1e3*t.time)/1e3:void 0,[null==t?void 0:t.time]),A=(0,r.useMemo)(()=>{var e;return(null==t?void 0:null===(e=t.payment)||void 0===e?void 0:e.type)===g.uG.hold?[{cost:O,paymentType:g.uG.hold,runningTime:L,startTime:t.time,blockchain:t.payment.chain,loading:T}]:[{paymentType:g.uG.hold,loading:!0}]},[O,null==t?void 0:t.payment,L,null==t?void 0:t.time,T]),F=(0,r.useCallback)(async()=>{if(!s)throw p.Z.ConnectYourWallet;if(!t)throw p.Z.FunctionNotFound;await s.download(t)},[s,t]),B=(0,r.useMemo)(()=>!s||!t,[t,s]),J=(0,r.useCallback)(e=>{let{title:n,id:i}=e;D({title:n,isOpen:!0,type:"volume",selectedVolumeId:i})},[D]),W=(0,r.useCallback)(e=>{J({title:"Runtime Volume",id:e})},[J]),H=(0,r.useCallback)(e=>{J({title:"Codebase Volume",id:e})},[J]),q=(0,r.useCallback)(e=>{J({title:"Immutable Volume",id:e})},[J]),z=(0,r.useCallback)(()=>{D(e=>({...e,isOpen:!1}))},[]),{handleDownloadLogs:G,isDownloadingLogs:U}=(0,y.Z)({fileName:N,logs:v});return{...a,program:t,name:N,labelVariant:P,isPersistent:b,isAllocated:C,immutableVolumes:M,persistentVolumes:S,customDomains:k,handleCustomDomainClick:Z,paymentData:A,logsDisabled:w,handleDownloadLogs:G,isDownloadingLogs:U,handleDownload:F,downloadDisabled:B,setTabId:o,sliderActiveIndex:E,sidePanel:I,closeSidePanel:z,handleRuntimeVolumeClick:W,handleCodebaseVolumeClick:H,handleImmutableVolumeClick:q,handleBack:()=>{e.push(".")}}}();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("title",{children:"Console | Manage Function | Aleph Cloud"}),(0,t.jsx)("meta",{name:"description",content:"Manage your serverless function on Aleph Cloud"})]}),(0,t.jsx)(v.Z,{entity:i,name:s,type:d.py.Program,labelVariant:l,isAllocated:Z,showStart:k,startDisabled:B,onStart:J,showDelete:!0,deleteDisabled:X,onDelete:Y,showStop:k,stopDisabled:A,onStop:F,showReboot:k,rebootDisabled:W,onReboot:H,showDownload:!0,downloadDisabled:K,onDownload:Q,onBack:ep}),(0,t.jsxs)(_.i,{activeIndex:ed,children:[(0,t.jsx)(_.M,{children:(0,t.jsx)(b.Z,{leftColumnElements:[(0,t.jsx)(N,{program:i},"function-details"),k&&(0,t.jsx)(w.V,{onViewLogs:()=>$("log"),onDownloadLogs:T,downloadingLogs:V,disabled:R},"instance-logs-control"),(0,t.jsx)(ee.Z,{payments:M},"instance-payment")],rightColumnElements:[I&&(0,t.jsx)(en.Z,{nodeDetails:I,termsAndConditionsHash:null==i?void 0:null===(n=i.requirements)||void 0===n?void 0:null===(e=n.node)||void 0===e?void 0:e.terms_and_conditions},"instance-hosting-crn"),(0,t.jsx)(L,{loading:!i,runtimeVolumeId:null==i?void 0:i.runtime.ref,comment:null==i?void 0:i.runtime.comment,onRuntimeVolumeClick:ec},"function-runtime"),(0,t.jsx)(U,{loading:!i,codebaseVolumeId:null==i?void 0:i.code.ref,entrypoint:null==i?void 0:i.code.entrypoint,onCodebaseVolumeClick:em},"function-runtime"),D.length&&(0,t.jsx)(ei.Z,{linkedVolumes:D,onImmutableVolumeClick:eu},"instance-linked-volumes"),P.length&&(0,t.jsx)(et.Z,{persistentVolumes:P},"instance-persistent-storage"),E.length&&(0,t.jsx)(es.Z,{customDomains:E,onCustomDomainClick:S},"function-custom-domains")]})}),(0,t.jsx)(_.M,{children:(0,t.jsxs)(el,{children:[(0,t.jsx)(C.L,{onClick:()=>$("detail"),children:(0,t.jsx)(a.JO,{name:"angle-left",size:"1.3em"})}),(0,t.jsx)(eo,{children:(0,t.jsx)(w.W,{logs:O})})]})})]}),(0,t.jsx)(q.Z,{title:ea.title,isOpen:ea.isOpen,onClose:er,children:"volume"===ea.type?ea.selectedVolumeId&&(0,t.jsx)(z.Z,{volumeId:ea.selectedVolumeId}):"domain"===ea.type?ea.selectedDomain&&(0,t.jsx)(G.Z,{domainId:ea.selectedDomain.id}):(0,t.jsx)(t.Fragment,{children:"ERROR"})})]})}var el=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-gkjpjs-0"})({display:"flex",width:"100%",gap:"2rem",paddingLeft:"3rem",paddingRight:"3rem",paddingTop:"1.5rem",paddingBottom:"1.5rem"}),eo=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-gkjpjs-1"})({display:"flex",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.75rem"})}},function(e){e.O(0,[7536,1505,8684,4215,1185,2334,9774,2888,179],function(){return e(e.s=56383)}),_N_E=e.O()}]);