(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1273],{56383:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/computing/function/[hash]",function(){return i(2190)}])},58317:function(e,n,i){"use strict";i.d(n,{Z:function(){return t.Z}});var t=i(62394)},33223:function(e,n,i){"use strict";i.d(n,{k:function(){return useProgramManager}});var t=i(9754);function useProgramManager(){let[e]=(0,t.mr)(),{programManager:n}=e.manager;return n}},16368:function(e,n,i){"use strict";i.d(n,{n:function(){return useRequestPrograms}});var t=i(33223),l=i(77205);function useRequestPrograms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.k)();return(0,l.F)({...e,manager:n,name:"program"})}},2190:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return ManageFunction}});var t=i(85893),l=i(57833),s=i(9008),o=i.n(s),r=i(31515),d=i(67294),a=i(11163),c=i(33223),m=i(16368),u=i(50586),h=i(57125),x=i(14685),p=i(37850),j=i(60566),y=i(50090),g=i(63831),f=i(30425);let v=l.ZP.div.withConfig({displayName:"styles__StyledSlide",componentId:"sc-1qzr443-0"})([""]),Z=l.ZP.div.withConfig({displayName:"styles__StyledSlider",componentId:"sc-1qzr443-1"})(["",""],e=>{let{theme:n,slidesCount:i,activeIndex:t}=e;return(0,l.iv)(["display:flex;width:","%;transform:translateX(-","%);transition:all ","ms ",";","{flex:0 0 ","%;}"],100*i,t*(100/i),n.transition.duration.normal,n.transition.timing,v,100/i)}),Slider=e=>{let{activeIndex:n,children:i}=e,l=d.Children.count(i);return(0,t.jsx)(b,{children:(0,t.jsx)(Z,{slidesCount:l,activeIndex:n,children:i})})};Slider.displayName="Slider";let Slide=e=>{let{children:n}=e;return(0,t.jsx)(v,{children:n})};var C=(0,d.memo)(Slider),b=(0,l.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-tu70y8-0"})({width:"100%",overflow:"hidden"}),w=i(25491),k=i(85786),P=i(47104),D=i(76696),I=i(77541),N=i(9911),_=i(33697);let ProgramDetails=e=>{let{program:n}=e,i=(0,r.vx)((null==n?void 0:n.id)||"");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S,{className:"tp-h7 fs-24",children:"FUNCTION DETAILS"}),(0,t.jsx)(r.Jy,{children:(0,t.jsxs)(M,{children:[(0,t.jsx)(R,{id:N.DA[N.py.Program],color:"main0",size:"6rem"}),(0,t.jsxs)(T,{children:[(0,t.jsxs)(L,{children:[(0,t.jsx)(_.Z,{children:"ITEM HASH"}),n?(0,t.jsx)(D.Z,{iconName:"copy",onClick:i,children:n.id}):(0,t.jsx)(P.Z,{width:"100%"})]}),(0,t.jsxs)(O,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"CORES"}),(0,t.jsx)("div",{children:(0,t.jsx)(V,{children:(null==n?void 0:n.resources)?"".concat(n.resources.vcpus," x86 64bit"):(0,t.jsx)(P.Z,{width:"7rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"RAM"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:(null==n?void 0:n.resources)?(0,x.Fx)(n.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0}):(0,t.jsx)(P.Z,{width:"4rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"TIMEOUT"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:n?"".concat(n.resources.seconds,"s"):(0,t.jsx)(P.Z,{width:"6rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"SIZE"}),(0,t.jsx)("div",{children:(0,t.jsx)(I.x,{children:n?(0,x.eB)(n.size||0,"MiB"):(0,t.jsx)(P.Z,{width:"6rem"})})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"EXPLORER"}),(0,t.jsx)("div",{children:n?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:n.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(D.Z,{iconName:"square-up-right",children:(0,t.jsx)(I.x,{children:(0,x.bs)(n.url,80)})})}):(0,t.jsx)(P.Z,{width:"20rem"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"API ENTRYPOINT"}),(0,t.jsx)("div",{children:n?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:n.urlVM,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(D.Z,{iconName:"square-up-right",children:(0,t.jsx)(I.x,{children:(0,x.bs)(n.urlVM,80)})})}):(0,t.jsx)(P.Z,{width:"20rem"})})]})]})]})})]})};ProgramDetails.displayName="ProgramDetails";var E=(0,d.memo)(ProgramDetails),S=(0,l.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),M=(0,l.ZP)("div")({display:"flex",gap:"1rem"}),R=(0,l.ZP)(r._7)({minHeight:"7rem",minWidth:"7rem"}),T=(0,l.ZP)("div")({display:"flex",width:"100%",flexDirection:"column",gap:"1rem"}),L=(0,l.ZP)("div")({width:"100%"}),O=(0,l.ZP)("div")({display:"flex",flexWrap:"wrap",gap:"1rem"}),V=(0,l.ZP)(I.x).withConfig({displayName:"cmp___StyledText",componentId:"sc-1naknab-0"})({display:"flex",alignItems:"center",gap:"0.25rem"}),A=i(29159),F=i(95029);let EntityLinkedRuntime=e=>{let{loading:n,runtimeVolumeId:i,comment:l,onRuntimeVolumeClick:s}=e,o=(0,r.vx)(i||""),a=(0,d.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{className:"tp-h7 fs-24",children:"LINKED RUNTIME"}),(0,t.jsx)(r.Jy,{children:(0,t.jsx)(z,{children:(0,t.jsxs)(J,{children:[(0,t.jsxs)(A.Z,{disabled:!i,onClick:()=>i&&s(i),children:[(0,t.jsx)(W,{id:N.DA[N.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsx)(H,{children:(0,t.jsx)("div",{className:"tp-info",children:n?(0,t.jsx)(P.Z,{width:"12rem"}):null!=l?l:(0,x.bs)(i,6,12)})}),(0,t.jsx)(G,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(F.Z,{onClick:a,disabled:!i,children:[(0,t.jsx)(r.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedRuntime.displayName="EntityLinkedRuntime";var B=(0,d.memo)(EntityLinkedRuntime),q=(0,l.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),z=(0,l.ZP)("div")({display:"flex",flexDirection:"column",gap:"1rem"}),J=(0,l.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),W=(0,l.ZP)(r._7)({minHeight:"3rem",minWidth:"3rem"}),H=(0,l.ZP)("div")({display:"flex",flexDirection:"column",alignItems:"flex-start"}),G=(0,l.ZP)(r.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-1kb32yd-0"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),U=i(58317),X=i(27917),Y=i(14215);let EntityLinkedCodebase=e=>{let{loading:n,codebaseVolumeId:i,entrypoint:l,onCodebaseVolumeClick:s}=e,o=(0,r.vx)(i||""),a=(0,d.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Q,{className:"tp-h7 fs-24",children:"LINKED CODEBASE"}),(0,t.jsx)(r.Jy,{children:(0,t.jsx)($,{children:(0,t.jsxs)(ee,{children:[(0,t.jsxs)(A.Z,{disabled:!i,onClick:()=>i&&s(i),children:[(0,t.jsx)(en,{id:N.DA[N.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(_.Z,{children:"ENTRYPOINT"}),(0,t.jsx)(I.x,{children:!l||n?(0,t.jsx)(P.Z,{width:"6rem"}):l})]}),(0,t.jsx)(ei,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(F.Z,{onClick:a,disabled:!i,children:[(0,t.jsx)(r.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedCodebase.displayName="EntityLinkedCodebase";var K=(0,d.memo)(EntityLinkedCodebase),Q=(0,l.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),$=(0,l.ZP)("div")({display:"flex",flexDirection:"column",gap:"1rem"}),ee=(0,l.ZP)("div")({marginTop:"-0.5rem",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),en=(0,l.ZP)(r._7)({minHeight:"3rem",minWidth:"3rem"}),ei=(0,l.ZP)(r.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-beir4t-0"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),et=i(91986),el=i(21204),es=i(73635),eo=i(36943),er=i(24541);function ManageFunction(){var e,n;let{program:i,name:l,isPersistent:s,calculatedStatus:v,isAllocated:Z,nodeDetails:b,immutableVolumes:P,persistentVolumes:D,customDomains:I,handleCustomDomainClick:N,paymentData:_,logs:S,logsDisabled:M,handleDownloadLogs:R,isDownloadingLogs:T,stopDisabled:L,stopLoading:O,handleStop:V,startDisabled:A,startLoading:q,handleStart:z,rebootDisabled:J,rebootLoading:W,handleReboot:H,deleteDisabled:G,deleteLoading:Q,handleDelete:$,downloadDisabled:ee,downloadLoading:en,handleDownload:ei,setTabId:ec,sliderActiveIndex:em,sidePanel:eu,closeSidePanel:eh,handleRuntimeVolumeClick:ex,handleCodebaseVolumeClick:ep,handleImmutableVolumeClick:ej,handleBack:ey}=function(){let e=(0,a.useRouter)(),{hash:n}=e.query,{entities:i}=(0,m.n)({ids:n}),[t]=i||[],l=(0,c.k)(),[s,o]=(0,d.useState)("detail"),r="log"===s,f=(0,h.y)({executable:t,manager:l,subscribeLogs:r}),{logs:v,logsDisabled:Z}=f,C=(0,d.useMemo)(()=>!!(null==t?void 0:t.on.persistent),[t]),b=(0,d.useMemo)(()=>C?f.isAllocated:!!(null==t?void 0:t.confirmed),[f,t,C]),w=(0,d.useMemo)(()=>!t||!b||Z,[b,Z,t]),{customDomains:k}=(0,g.Z)({entityId:null==t?void 0:t.id}),P=(0,d.useCallback)(e=>{I({title:"Custom Domain",isOpen:!0,type:"domain",selectedDomain:e})},[]),[D,I]=(0,d.useState)({title:"",isOpen:!1}),N=(0,d.useMemo)(()=>{var e;return t?(null==t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.name)||(0,x.zN)(t.id):""},[t]),_=(0,d.useMemo)(()=>"log"===s?1:0,[s]),{persistentVolumes:E,immutableVolumes:S}=(0,y.Z)({volumes:null==t?void 0:t.volumes}),[M,R]=(0,d.useState)(),[T,L]=(0,d.useState)(!1),[O,V]=(0,d.useState)(!1);(0,d.useEffect)(()=>{let fetchCost=async()=>{if((null==t?void 0:t.payment)&&l){L(!0);try{let e=await l.getTotalCostByHash(t.payment.type,t.id);R(e)}catch(e){console.error("Error fetching cost:",e)}finally{L(!1)}}};fetchCost()},[t,l]);let A=(0,d.useMemo)(()=>(null==t?void 0:t.time)?Math.floor(Date.now()-1e3*t.time)/1e3:void 0,[null==t?void 0:t.time]),F=(0,d.useMemo)(()=>{var e;return(null==t?void 0:null===(e=t.payment)||void 0===e?void 0:e.type)===j.uG.hold?[{cost:M,paymentType:j.uG.hold,runningTime:A,startTime:t.time,blockchain:t.payment.chain,loading:T}]:[{paymentType:j.uG.hold,loading:!0}]},[M,null==t?void 0:t.payment,A,null==t?void 0:t.time,T]),B=(0,d.useCallback)(async()=>{if(!l)throw u.Z.ConnectYourWallet;if(!t)throw u.Z.FunctionNotFound;try{V(!0),await l.download(t)}finally{V(!1)}},[l,t]),q=(0,d.useMemo)(()=>!l||!t||!!O,[t,l,O]),z=(0,d.useCallback)(e=>{let{title:n,id:i}=e;I({title:n,isOpen:!0,type:"volume",selectedVolumeId:i})},[I]),J=(0,d.useCallback)(e=>{z({title:"Runtime Volume",id:e})},[z]),W=(0,d.useCallback)(e=>{z({title:"Codebase Volume",id:e})},[z]),H=(0,d.useCallback)(e=>{z({title:"Immutable Volume",id:e})},[z]),G=(0,d.useCallback)(()=>{I(e=>({...e,isOpen:!1}))},[]),{handleDownloadLogs:U,isDownloadingLogs:X}=(0,p.Z)({fileName:N,logs:v});return{...f,program:t,name:N,isPersistent:C,isAllocated:b,immutableVolumes:S,persistentVolumes:E,customDomains:k,handleCustomDomainClick:P,paymentData:F,logsDisabled:w,handleDownloadLogs:U,isDownloadingLogs:X,handleDownload:B,downloadDisabled:q,downloadLoading:O,setTabId:o,sliderActiveIndex:_,sidePanel:D,closeSidePanel:G,handleRuntimeVolumeClick:J,handleCodebaseVolumeClick:W,handleImmutableVolumeClick:H,handleBack:()=>{e.push(".")}}}();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("title",{children:"Console | Manage Function | Aleph Cloud"}),(0,t.jsx)("meta",{name:"description",content:"Manage your serverless function on Aleph Cloud"})]}),(0,t.jsx)(f.Z,{entity:i,name:l,type:"function",isAllocated:Z,calculatedStatus:v,showStart:s,startDisabled:A,startLoading:q,onStart:z,showDelete:!0,deleteDisabled:G,deleteLoading:Q,onDelete:$,showStop:s,stopDisabled:L,stopLoading:O,onStop:V,showReboot:s,rebootDisabled:J,rebootLoading:W,onReboot:H,showDownload:!0,downloadDisabled:ee,downloadLoading:en,onDownload:ei,onBack:ey}),(0,t.jsxs)(C,{activeIndex:em,children:[(0,t.jsx)(Slide,{children:(0,t.jsx)(w.Z,{leftColumnElements:[(0,t.jsx)(E,{program:i},"function-details"),s&&(0,t.jsx)(k.V,{onViewLogs:()=>ec("log"),onDownloadLogs:R,downloadingLogs:T,disabled:M},"instance-logs-control"),(0,t.jsx)(et.Z,{payments:_},"instance-payment")],rightColumnElements:[b&&(0,t.jsx)(el.Z,{nodeDetails:b,termsAndConditionsHash:null==i?void 0:null===(n=i.requirements)||void 0===n?void 0:null===(e=n.node)||void 0===e?void 0:e.terms_and_conditions},"instance-hosting-crn"),(0,t.jsx)(B,{loading:!i,runtimeVolumeId:null==i?void 0:i.runtime.ref,comment:null==i?void 0:i.runtime.comment,onRuntimeVolumeClick:ex},"function-runtime"),(0,t.jsx)(K,{loading:!i,codebaseVolumeId:null==i?void 0:i.code.ref,entrypoint:null==i?void 0:i.code.entrypoint,onCodebaseVolumeClick:ep},"function-runtime"),P.length&&(0,t.jsx)(es.Z,{linkedVolumes:P,onImmutableVolumeClick:ej},"instance-linked-volumes"),D.length&&(0,t.jsx)(eo.Z,{persistentVolumes:D},"instance-persistent-storage"),I.length&&(0,t.jsx)(er.Z,{customDomains:I,onCustomDomainClick:N},"function-custom-domains")]})}),(0,t.jsx)(Slide,{children:(0,t.jsxs)(ed,{children:[(0,t.jsx)(F.Z,{onClick:()=>ec("detail"),children:(0,t.jsx)(r.JO,{name:"angle-left",size:"1.3em"})}),(0,t.jsx)(ea,{children:(0,t.jsx)(k.W,{logs:S})})]})})]}),(0,t.jsx)(U.Z,{title:eu.title,isOpen:eu.isOpen,onClose:eh,children:"volume"===eu.type?eu.selectedVolumeId&&(0,t.jsx)(X.Z,{volumeId:eu.selectedVolumeId}):"domain"===eu.type?eu.selectedDomain&&(0,t.jsx)(Y.Z,{domainId:eu.selectedDomain.id}):(0,t.jsx)(t.Fragment,{children:"ERROR"})})]})}var ed=(0,l.ZP)("div")({display:"flex",width:"100%",gap:"2rem",paddingLeft:"3rem",paddingRight:"3rem",paddingTop:"1.5rem",paddingBottom:"1.5rem"}),ea=(0,l.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-gkjpjs-0"})({display:"flex",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.75rem"})}},function(e){e.O(0,[1093,8684,4215,1270,9774,2888,179],function(){return e(e.s=56383)}),_N_E=e.O()}]);