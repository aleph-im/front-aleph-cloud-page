(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1273],{56383:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/computing/function/[hash]",function(){return n(2190)}])},58317:function(e,i,n){"use strict";n.d(i,{Z:function(){return l.Z}});var l=n(62394)},2190:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return ManageFunction}});var l=n(85893),t=n(57833),s=n(9008),o=n.n(s),d=n(73899),r=n(67294),a=n(11163),c=n(33223),m=n(16368),u=n(50586),h=n(57125),x=n(14685),p=n(37850),j=n(60566),y=n(50090),v=n(63831),f=n(30425);let g=t.ZP.div.withConfig({displayName:"styles__StyledSlide",componentId:"sc-1qzr443-0"})([""]),Z=t.ZP.div.withConfig({displayName:"styles__StyledSlider",componentId:"sc-1qzr443-1"})(["",""],e=>{let{theme:i,slidesCount:n,activeIndex:l}=e;return(0,t.iv)(["display:flex;width:","%;transform:translateX(-","%);transition:all ","ms ",";","{flex:0 0 ","%;}"],100*n,l*(100/n),i.transition.duration.normal,i.transition.timing,g,100/n)}),Slider=e=>{let{activeIndex:i,children:n}=e,t=r.Children.count(n);return(0,l.jsx)(b,{children:(0,l.jsx)(Z,{slidesCount:t,activeIndex:i,children:n})})};Slider.displayName="Slider";let Slide=e=>{let{children:i}=e;return(0,l.jsx)(g,{children:i})};var C=(0,r.memo)(Slider),b=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-tu70y8-0"})({width:"100%",overflow:"hidden"}),w=n(25491),k=n(85786),D=n(47104),I=n(76696),N=n(77541),P=n(9911),_=n(33697);let ProgramDetails=e=>{let{program:i}=e,n=(0,d.vx)((null==i?void 0:i.id)||"");return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S,{className:"tp-h7 fs-24",children:"FUNCTION DETAILS"}),(0,l.jsx)(d.Jy,{children:(0,l.jsxs)(L,{children:[(0,l.jsx)(T,{id:P.DA[P.py.Program],color:"main0",size:"6rem"}),(0,l.jsxs)(O,{children:[(0,l.jsxs)(M,{children:[(0,l.jsx)(_.Z,{children:"ITEM HASH"}),i?(0,l.jsx)(I.Z,{iconName:"copy",onClick:n,children:i.id}):(0,l.jsx)(D.Z,{width:"100%"})]}),(0,l.jsxs)(R,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"CORES"}),(0,l.jsx)("div",{children:(0,l.jsx)(V,{children:(null==i?void 0:i.resources)?"".concat(i.resources.vcpus," x86 64bit"):(0,l.jsx)(D.Z,{width:"7rem"})})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"RAM"}),(0,l.jsx)("div",{children:(0,l.jsx)(N.xv,{children:(null==i?void 0:i.resources)?(0,x.Fx)(i.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0}):(0,l.jsx)(D.Z,{width:"4rem"})})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"TIMEOUT"}),(0,l.jsx)("div",{children:(0,l.jsx)(N.xv,{children:i?"".concat(i.resources.seconds,"s"):(0,l.jsx)(D.Z,{width:"6rem"})})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"SIZE"}),(0,l.jsx)("div",{children:(0,l.jsx)(N.xv,{children:i?(0,x.eB)(i.size||0,"MiB"):(0,l.jsx)(D.Z,{width:"6rem"})})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"EXPLORER"}),(0,l.jsx)("div",{children:i?(0,l.jsx)("a",{className:"tp-body1 fs-16",href:i.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,l.jsx)(I.Z,{iconName:"square-up-right",children:(0,l.jsx)(N.xv,{children:(0,x.bs)(i.url,80)})})}):(0,l.jsx)(D.Z,{width:"20rem"})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"API ENTRYPOINT"}),(0,l.jsx)("div",{children:i?(0,l.jsx)("a",{className:"tp-body1 fs-16",href:i.urlVM,target:"_blank",referrerPolicy:"no-referrer",children:(0,l.jsx)(I.Z,{iconName:"square-up-right",children:(0,l.jsx)(N.xv,{children:(0,x.bs)(i.urlVM,80)})})}):(0,l.jsx)(D.Z,{width:"20rem"})})]})]})]})})]})};ProgramDetails.displayName="ProgramDetails";var E=(0,r.memo)(ProgramDetails),S=(0,t.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),L=(0,t.ZP)("div")({display:"flex",gap:"1rem"}),T=(0,t.ZP)(d._7)({minHeight:"7rem",minWidth:"7rem"}),O=(0,t.ZP)("div")({display:"flex",width:"100%",flexDirection:"column",gap:"1rem"}),M=(0,t.ZP)("div")({width:"100%"}),R=(0,t.ZP)("div")({display:"flex",flexWrap:"wrap",gap:"1rem"}),V=(0,t.ZP)(N.xv).withConfig({displayName:"cmp___StyledText",componentId:"sc-1naknab-0"})({display:"flex",alignItems:"center",gap:"0.25rem"}),A=n(29159),B=n(95029);let EntityLinkedRuntime=e=>{let{loading:i,runtimeVolumeId:n,comment:t,onRuntimeVolumeClick:s}=e,o=(0,d.vx)(n||""),a=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(z,{className:"tp-h7 fs-24",children:"LINKED RUNTIME"}),(0,l.jsx)(d.Jy,{children:(0,l.jsx)(J,{children:(0,l.jsxs)(W,{children:[(0,l.jsxs)(A.Z,{disabled:!n,onClick:()=>n&&s(n),children:[(0,l.jsx)(H,{id:P.DA[P.py.Volume],color:"base2",size:"2.5rem"}),(0,l.jsx)(q,{children:(0,l.jsx)("div",{className:"tp-info",children:i?(0,l.jsx)(D.Z,{width:"12rem"}):null!=t?t:(0,x.bs)(n,6,12)})}),(0,l.jsx)(G,{name:"eye",className:"openEntityIcon"})]}),(0,l.jsxs)(B.Z,{onClick:a,disabled:!n,children:[(0,l.jsx)(d.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedRuntime.displayName="EntityLinkedRuntime";var F=(0,r.memo)(EntityLinkedRuntime),z=(0,t.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),J=(0,t.ZP)("div")({display:"flex",flexDirection:"column",gap:"1rem"}),W=(0,t.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),H=(0,t.ZP)(d._7)({minHeight:"3rem",minWidth:"3rem"}),q=(0,t.ZP)("div")({display:"flex",flexDirection:"column",alignItems:"flex-start"}),G=(0,t.ZP)(d.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-1kb32yd-0"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),U=n(58317),X=n(27917),Y=n(14215);let EntityLinkedCodebase=e=>{let{loading:i,codebaseVolumeId:n,entrypoint:t,onCodebaseVolumeClick:s}=e,o=(0,d.vx)(n||""),a=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Q,{className:"tp-h7 fs-24",children:"LINKED CODEBASE"}),(0,l.jsx)(d.Jy,{children:(0,l.jsx)($,{children:(0,l.jsxs)(ee,{children:[(0,l.jsxs)(A.Z,{disabled:!n,onClick:()=>n&&s(n),children:[(0,l.jsx)(ei,{id:P.DA[P.py.Volume],color:"base2",size:"2.5rem"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(_.Z,{children:"ENTRYPOINT"}),(0,l.jsx)(N.xv,{children:!t||i?(0,l.jsx)(D.Z,{width:"6rem"}):t})]}),(0,l.jsx)(en,{name:"eye",className:"openEntityIcon"})]}),(0,l.jsxs)(B.Z,{onClick:a,disabled:!n,children:[(0,l.jsx)(d.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedCodebase.displayName="EntityLinkedCodebase";var K=(0,r.memo)(EntityLinkedCodebase),Q=(0,t.ZP)("div")({marginBottom:"0.5rem",textTransform:"uppercase"}),$=(0,t.ZP)("div")({display:"flex",flexDirection:"column",gap:"1rem"}),ee=(0,t.ZP)("div")({marginTop:"-0.5rem",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),ei=(0,t.ZP)(d._7)({minHeight:"3rem",minWidth:"3rem"}),en=(0,t.ZP)(d.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-beir4t-0"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),el=n(91986),et=n(21204),es=n(73635),eo=n(36943),ed=n(24541),er=n(61424);function ManageFunction(){var e,i;let{program:n,name:t,isPersistent:s,calculatedStatus:g,isAllocated:Z,nodeDetails:b,immutableVolumes:D,persistentVolumes:I,customDomains:N,isLoadingCustomDomains:_,handleCustomDomainClick:S,handleAddDomain:L,paymentData:T,logs:O,logsDisabled:M,handleDownloadLogs:R,isDownloadingLogs:V,stopDisabled:A,stopLoading:z,handleStop:J,startDisabled:W,startLoading:H,handleStart:q,rebootDisabled:G,rebootLoading:Q,handleReboot:$,deleteDisabled:ee,deleteLoading:ei,handleDelete:en,downloadDisabled:em,downloadLoading:eu,handleDownload:eh,setTabId:ex,sliderActiveIndex:ep,sidePanel:ej,closeSidePanel:ey,handleRuntimeVolumeClick:ev,handleCodebaseVolumeClick:ef,handleImmutableVolumeClick:eg,handleBack:eZ}=function(){let e=(0,a.useRouter)(),{hash:i}=e.query,{entities:n}=(0,m.n)({ids:i}),[l]=n||[],t=(0,c.k)(),[s,o]=(0,r.useState)("detail"),d="log"===s,f=(0,h.y)({executable:l,manager:t,subscribeLogs:d}),{logs:g,logsDisabled:Z}=f,C=(0,r.useMemo)(()=>!!(null==l?void 0:l.on.persistent),[l]),b=(0,r.useMemo)(()=>C?f.isAllocated:!!(null==l?void 0:l.confirmed),[f,l,C]),w=(0,r.useMemo)(()=>!l||!b||Z,[b,Z,l]),{customDomains:k,isLoading:D}=(0,v.Z)({entityId:null==l?void 0:l.id}),I=(0,r.useCallback)(e=>{_({title:"Custom Domain",isOpen:!0,type:"domain",selectedDomain:e})},[]),N=(0,r.useCallback)(()=>{_({title:"New Custom Domain",isOpen:!0,type:"newDomain"})},[]),[P,_]=(0,r.useState)({title:"",isOpen:!1}),E=(0,r.useMemo)(()=>{var e;return l?(null==l?void 0:null===(e=l.metadata)||void 0===e?void 0:e.name)||(0,x.zN)(l.id):""},[l]),S=(0,r.useMemo)(()=>"log"===s?1:0,[s]),{persistentVolumes:L,immutableVolumes:T}=(0,y.Z)({volumes:null==l?void 0:l.volumes}),[O,M]=(0,r.useState)(),[R,V]=(0,r.useState)(!1),[A,B]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let fetchCost=async()=>{if((null==l?void 0:l.payment)&&t){V(!0);try{let e=await t.getTotalCostByHash(l.payment.type,l.id);M(e)}catch(e){console.error("Error fetching cost:",e)}finally{V(!1)}}};fetchCost()},[l,t]);let F=(0,r.useMemo)(()=>(null==l?void 0:l.time)?Math.floor(Date.now()-1e3*l.time)/1e3:void 0,[null==l?void 0:l.time]),z=(0,r.useMemo)(()=>{var e;return(null==l?void 0:null===(e=l.payment)||void 0===e?void 0:e.type)===j.uG.hold?[{cost:O,paymentType:j.uG.hold,runningTime:F,startTime:l.time,blockchain:l.payment.chain,loading:R}]:[{paymentType:j.uG.hold,loading:!0}]},[O,null==l?void 0:l.payment,F,null==l?void 0:l.time,R]),J=(0,r.useCallback)(async()=>{if(!t)throw u.Z.ConnectYourWallet;if(!l)throw u.Z.FunctionNotFound;try{B(!0),await t.download(l)}finally{B(!1)}},[t,l]),W=(0,r.useMemo)(()=>!t||!l||!!A,[l,t,A]),H=(0,r.useCallback)(e=>{let{title:i,id:n}=e;_({title:i,isOpen:!0,type:"volume",selectedVolumeId:n})},[_]),q=(0,r.useCallback)(e=>{H({title:"Runtime Volume",id:e})},[H]),G=(0,r.useCallback)(e=>{H({title:"Codebase Volume",id:e})},[H]),U=(0,r.useCallback)(e=>{H({title:"Immutable Volume",id:e})},[H]),X=(0,r.useCallback)(()=>{_(e=>({...e,isOpen:!1}))},[]),{handleDownloadLogs:Y,isDownloadingLogs:K}=(0,p.Z)({fileName:E,logs:g});return{...f,program:l,name:E,isPersistent:C,isAllocated:b,immutableVolumes:T,persistentVolumes:L,customDomains:k,isLoadingCustomDomains:D,handleCustomDomainClick:I,handleAddDomain:N,paymentData:z,logsDisabled:w,handleDownloadLogs:Y,isDownloadingLogs:K,handleDownload:J,downloadDisabled:W,downloadLoading:A,setTabId:o,sliderActiveIndex:S,sidePanel:P,closeSidePanel:X,handleRuntimeVolumeClick:q,handleCodebaseVolumeClick:G,handleImmutableVolumeClick:U,handleBack:()=>{e.push(".")}}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o(),{children:[(0,l.jsx)("title",{children:"Console | Manage Function | Aleph Cloud"}),(0,l.jsx)("meta",{name:"description",content:"Manage your serverless function on Aleph Cloud"})]}),(0,l.jsx)(f.Z,{entity:n,name:t,type:"function",isAllocated:Z,calculatedStatus:g,showStart:s,startDisabled:W,startLoading:H,onStart:q,showDelete:!0,deleteDisabled:ee,deleteLoading:ei,onDelete:en,showStop:s,stopDisabled:A,stopLoading:z,onStop:J,showReboot:s,rebootDisabled:G,rebootLoading:Q,onReboot:$,showDownload:!0,downloadDisabled:em,downloadLoading:eu,onDownload:eh,onBack:eZ}),(0,l.jsxs)(C,{activeIndex:ep,children:[(0,l.jsx)(Slide,{children:(0,l.jsx)(w.Z,{leftColumnElements:[(0,l.jsx)(E,{program:n},"function-details"),s&&(0,l.jsx)(k.V,{onViewLogs:()=>ex("log"),onDownloadLogs:R,downloadingLogs:V,disabled:M},"instance-logs-control"),(0,l.jsx)(el.Z,{payments:T},"instance-payment")],rightColumnElements:[b&&(0,l.jsx)(et.Z,{nodeDetails:b,termsAndConditionsHash:null==n?void 0:null===(i=n.requirements)||void 0===i?void 0:null===(e=i.node)||void 0===e?void 0:e.terms_and_conditions},"instance-hosting-crn"),(0,l.jsx)(F,{loading:!n,runtimeVolumeId:null==n?void 0:n.runtime.ref,comment:null==n?void 0:n.runtime.comment,onRuntimeVolumeClick:ev},"function-runtime"),(0,l.jsx)(K,{loading:!n,codebaseVolumeId:null==n?void 0:n.code.ref,entrypoint:null==n?void 0:n.code.entrypoint,onCodebaseVolumeClick:ef},"function-runtime"),D.length&&(0,l.jsx)(es.Z,{linkedVolumes:D,onImmutableVolumeClick:eg},"instance-linked-volumes"),I.length&&(0,l.jsx)(eo.Z,{persistentVolumes:I},"instance-persistent-storage"),(0,l.jsx)(ed.Z,{isLoadingCustomDomains:_,customDomains:N,onCustomDomainClick:S,onAddDomain:L},"function-custom-domains")]})}),(0,l.jsx)(Slide,{children:(0,l.jsxs)(ea,{children:[(0,l.jsx)(B.Z,{onClick:()=>ex("detail"),children:(0,l.jsx)(d.JO,{name:"angle-left",size:"1.3em"})}),(0,l.jsx)(ec,{children:(0,l.jsx)(k.W,{logs:O})})]})})]}),(0,l.jsx)(U.Z,{title:ej.title,isOpen:ej.isOpen,onClose:ey,children:"volume"===ej.type?ej.selectedVolumeId&&(0,l.jsx)(X.Z,{volumeId:ej.selectedVolumeId}):"domain"===ej.type?ej.selectedDomain&&(0,l.jsx)(Y.Z,{domainId:ej.selectedDomain.id}):"newDomain"===ej.type?(0,l.jsx)(er.ZP,{entityId:null==n?void 0:n.id,entityType:P.sY.Program,onSuccess:ey}):(0,l.jsx)(l.Fragment,{children:"ERROR"})})]})}var ea=(0,t.ZP)("div")({display:"flex",width:"100%",gap:"2rem",paddingLeft:"3rem",paddingRight:"3rem",paddingTop:"1.5rem",paddingBottom:"1.5rem"}),ec=(0,t.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-gkjpjs-0"})({display:"flex",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.75rem"})}},function(e){e.O(0,[7536,1093,8326,1424,4215,1270,9774,2888,179],function(){return e(e.s=56383)}),_N_E=e.O()}]);