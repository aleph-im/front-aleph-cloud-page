(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1273],{56383:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/computing/function/[hash]",function(){return n(95357)}])},33223:function(e,i,n){"use strict";n.d(i,{k:function(){return useProgramManager}});var t=n(28417);function useProgramManager(){let[e]=(0,t.mr)(),{programManager:i}=e.manager;return i}},16368:function(e,i,n){"use strict";n.d(i,{n:function(){return useRequestPrograms}});var t=n(33223),s=n(77205);function useRequestPrograms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,t.k)();return(0,s.F)({...e,manager:i,name:"program"})}},95357:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return ManageFunction}});var t=n(85893),s=n(19521),l=n(9008),o=n.n(l),a=n(9911),d=n(79632),r=n(67294),c=n(11163),m=n(33223),p=n(16368),u=n(50586),h=n(57125),x=n(49107),y=n(37850),f=n(36286),g=n(50090),j=n(1712),v=n(69429),_=n(25491),b=n(16146),C=n(98642),w=n(47104),N=n(76696),k=n(77541);let ProgramDetails=e=>{let{program:i}=e,n=(0,d.vx)((null==i?void 0:i.id)||"");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z,{className:"tp-h7 fs-24",children:"FUNCTION DETAILS"}),(0,t.jsx)(d.Jy,{children:(0,t.jsxs)(D,{children:[(0,t.jsx)(P,{id:a.DA[a.py.Program],color:"main0",size:"6rem"}),(0,t.jsxs)(E,{children:[(0,t.jsxs)(S,{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"ITEM HASH"}),i?(0,t.jsx)(N.Z,{iconName:"copy",onClick:n,children:i.id}):(0,t.jsx)(w.Z,{width:"100%"})]}),(0,t.jsxs)(M,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"CORES"}),(0,t.jsx)("div",{children:(0,t.jsx)(O,{children:(null==i?void 0:i.resources)?"".concat(i.resources.vcpus," x86 64bit"):(0,t.jsx)(w.Z,{width:"7rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"RAM"}),(0,t.jsx)("div",{children:(0,t.jsx)(k.x,{children:(null==i?void 0:i.resources)?(0,x.Fx)(i.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0}):(0,t.jsx)(w.Z,{width:"4rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"TIMEOUT"}),(0,t.jsx)("div",{children:(0,t.jsx)(k.x,{children:i?"".concat(i.resources.seconds,"s"):(0,t.jsx)(w.Z,{width:"6rem"})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"SIZE"}),(0,t.jsx)("div",{children:(0,t.jsx)(k.x,{children:i?(0,x.eB)(i.size||0,"MiB"):(0,t.jsx)(w.Z,{width:"6rem"})})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"EXPLORER"}),(0,t.jsx)("div",{children:i?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:i.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(N.Z,{iconName:"square-up-right",children:(0,t.jsx)(k.x,{children:(0,x.bs)(i.url,80)})})}):(0,t.jsx)(w.Z,{width:"20rem"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"API ENTRYPOINT"}),(0,t.jsx)("div",{children:i?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:i.urlVM,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(N.Z,{iconName:"square-up-right",children:(0,t.jsx)(k.x,{children:(0,x.bs)(i.urlVM,80)})})}):(0,t.jsx)(w.Z,{width:"20rem"})})]})]})]})})]})};ProgramDetails.displayName="ProgramDetails";var I=(0,r.memo)(ProgramDetails),Z=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-1naknab-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),D=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1naknab-1"})({display:"flex",gap:"1rem"}),P=(0,s.ZP)(d._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-1naknab-2"})({minHeight:"7rem",minWidth:"7rem"}),E=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-1naknab-3"})({display:"flex",width:"100%",flexDirection:"column",gap:"1rem"}),S=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-1naknab-4"})({width:"100%"}),M=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-1naknab-5"})({display:"flex",flexWrap:"wrap",gap:"1rem"}),O=(0,s.ZP)(k.x).withConfig({displayName:"cmp___StyledText",componentId:"sc-1naknab-6"})({display:"flex",alignItems:"center",gap:"0.25rem"}),R=n(29159);let EntityLinkedRuntime=e=>{let{loading:i,runtimeVolumeId:n,comment:s,onRuntimeVolumeClick:l}=e,o=(0,d.vx)(n||""),c=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V,{className:"tp-h7 fs-24",children:"LINKED RUNTIME"}),(0,t.jsx)(d.Jy,{children:(0,t.jsx)(L,{children:(0,t.jsxs)(A,{children:[(0,t.jsxs)(R.Z,{disabled:!n,onClick:()=>n&&l(n),children:[(0,t.jsx)(F,{id:a.DA[a.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsx)(B,{children:(0,t.jsx)("div",{className:"tp-info",children:i?(0,t.jsx)(w.Z,{width:"12rem"}):null!=s?s:(0,x.bs)(n,6,12)})}),(0,t.jsx)(J,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(b.L,{onClick:c,disabled:!n,children:[(0,t.jsx)(d.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedRuntime.displayName="EntityLinkedRuntime";var T=(0,r.memo)(EntityLinkedRuntime),V=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-1kb32yd-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),L=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-1kb32yd-1"})({display:"flex",flexDirection:"column",gap:"1rem"}),A=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-1kb32yd-2"})({display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),F=(0,s.ZP)(d._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-1kb32yd-3"})({minHeight:"3rem",minWidth:"3rem"}),B=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-1kb32yd-4"})({display:"flex",flexDirection:"column",alignItems:"flex-start"}),J=(0,s.ZP)(d.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-1kb32yd-5"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),W=n(62394),H=n(27917);let EntityLinkedCodebase=e=>{let{loading:i,codebaseVolumeId:n,entrypoint:s,onCodebaseVolumeClick:l}=e,o=(0,d.vx)(n||""),c=(0,r.useCallback)(e=>{o(),e.preventDefault()},[o]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(z,{className:"tp-h7 fs-24",children:"LINKED CODEBASE"}),(0,t.jsx)(d.Jy,{children:(0,t.jsx)(G,{children:(0,t.jsxs)(U,{children:[(0,t.jsxs)(R.Z,{disabled:!n,onClick:()=>n&&l(n),children:[(0,t.jsx)(X,{id:a.DA[a.py.Volume],color:"base2",size:"2.5rem"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0 fs-12",children:"ENTRYPOINT"}),(0,t.jsx)(k.x,{children:!s||i?(0,t.jsx)(w.Z,{width:"6rem"}):s})]}),(0,t.jsx)(Y,{name:"eye",className:"openEntityIcon"})]}),(0,t.jsxs)(b.L,{onClick:c,disabled:!n,children:[(0,t.jsx)(d.JO,{name:"copy"}),"copy hash"]})]})})})]})};EntityLinkedCodebase.displayName="EntityLinkedCodebase";var q=(0,r.memo)(EntityLinkedCodebase),z=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-beir4t-0"})({marginBottom:"0.5rem",textTransform:"uppercase"}),G=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-beir4t-1"})({display:"flex",flexDirection:"column",gap:"1rem"}),U=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-beir4t-2"})({marginTop:"-0.5rem",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"1rem"}),X=(0,s.ZP)(d._7).withConfig({displayName:"cmp___StyledObjectImg",componentId:"sc-beir4t-3"})({minHeight:"3rem",minWidth:"3rem"}),Y=(0,s.ZP)(d.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-beir4t-4"})({position:"absolute",right:"0.5rem",top:"0.5rem"}),K=n(91986),Q=n(21204),$=n(73635),ee=n(40256);function ManageFunction(){var e,i;let{program:n,name:s,labelVariant:l,isPersistent:w,isAllocated:N,nodeDetails:k,immutableVolumes:Z,persistentVolumes:D,paymentData:P,logs:E,logsDisabled:S,handleDownloadLogs:M,isDownloadingLogs:O,stopDisabled:R,handleStop:V,startDisabled:L,handleStart:A,rebootDisabled:F,handleReboot:B,deleteDisabled:J,handleDelete:z,downloadDisabled:G,handleDownload:U,setTabId:X,sliderActiveIndex:Y,sidePanel:et,closeSidePanel:es,handleRuntimeVolumeClick:el,handleCodebaseVolumeClick:eo,handleImmutableVolumeClick:ea,handleBack:ed}=function(){let e=(0,c.useRouter)(),{hash:i}=e.query,{entities:n}=(0,p.n)({ids:i}),[t]=n||[],s=(0,m.k)(),[l,o]=(0,r.useState)("detail"),a="log"===l,d=(0,h.y)({executable:t,manager:s,subscribeLogs:a}),{logs:j,logsDisabled:v}=d,_=(0,r.useMemo)(()=>!!(null==t?void 0:t.on.persistent),[t]),b=(0,r.useMemo)(()=>_?d.isAllocated:!!(null==t?void 0:t.confirmed),[d,t,_]),C=(0,r.useMemo)(()=>!t||!b||v,[b,v,t]),[w,N]=(0,r.useState)({title:"",isOpen:!1}),k=(0,r.useMemo)(()=>{var e;return t?(null==t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.name)||(0,x.zN)(t.id):""},[t]),I=(0,r.useMemo)(()=>t&&t.time<Date.now()-45e3&&b?"success":"warning",[t,b]),Z=(0,r.useMemo)(()=>"log"===l?1:0,[l]),{persistentVolumes:D,immutableVolumes:P}=(0,g.Z)({volumes:null==t?void 0:t.volumes}),[E,S]=(0,r.useState)(),[M,O]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let fetchCost=async()=>{if((null==t?void 0:t.payment)&&s){O(!0);try{let e=await s.getTotalCostByHash(t.payment.type,t.id);S(e)}catch(e){console.error("Error fetching cost:",e)}finally{O(!1)}}};fetchCost()},[t,s]);let R=(0,r.useMemo)(()=>(null==t?void 0:t.time)?Math.floor(Date.now()-1e3*t.time)/1e3:void 0,[null==t?void 0:t.time]),T=(0,r.useMemo)(()=>{var e;return(null==t?void 0:null===(e=t.payment)||void 0===e?void 0:e.type)===f.uG.hold?[{cost:E,paymentType:f.uG.hold,runningTime:R,startTime:t.time,blockchain:t.payment.chain,loading:M}]:[{paymentType:f.uG.hold,loading:!0}]},[E,null==t?void 0:t.payment,R,null==t?void 0:t.time,M]),V=(0,r.useCallback)(async()=>{if(!s)throw u.Z.ConnectYourWallet;if(!t)throw u.Z.FunctionNotFound;await s.download(t)},[s,t]),L=(0,r.useMemo)(()=>!s||!t,[t,s]),A=(0,r.useCallback)(e=>{let{title:i,id:n}=e;N({title:i,isOpen:!0,type:"volume",selectedVolumeId:n})},[N]),F=(0,r.useCallback)(e=>{A({title:"Runtime Volume",id:e})},[A]),B=(0,r.useCallback)(e=>{A({title:"Codebase Volume",id:e})},[A]),J=(0,r.useCallback)(e=>{A({title:"Immutable Volume",id:e})},[A]),W=(0,r.useCallback)(()=>{N(e=>({...e,isOpen:!1}))},[]),{handleDownloadLogs:H,isDownloadingLogs:q}=(0,y.Z)({fileName:k,logs:j});return{...d,program:t,name:k,labelVariant:I,isPersistent:_,isAllocated:b,immutableVolumes:P,persistentVolumes:D,paymentData:T,logsDisabled:C,handleDownloadLogs:H,isDownloadingLogs:q,handleDownload:V,downloadDisabled:L,setTabId:o,sliderActiveIndex:Z,sidePanel:w,closeSidePanel:W,handleRuntimeVolumeClick:F,handleCodebaseVolumeClick:B,handleImmutableVolumeClick:J,handleBack:()=>{e.push(".")}}}();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o(),{children:[(0,t.jsx)("title",{children:"Console | Manage Function - Aleph Cloud"}),(0,t.jsx)("meta",{name:"description",content:"Manage your serverless function on Aleph Cloud"})]}),(0,t.jsx)(j.Z,{entity:n,name:s,type:a.py.Program,labelVariant:l,isAllocated:N,showStart:w,startDisabled:L,onStart:A,showDelete:!0,deleteDisabled:J,onDelete:z,showStop:w,stopDisabled:R,onStop:V,showReboot:w,rebootDisabled:F,onReboot:B,showDownload:!0,downloadDisabled:G,onDownload:U,onBack:ed}),(0,t.jsxs)(v.i,{activeIndex:Y,children:[(0,t.jsx)(v.M,{children:(0,t.jsx)(_.Z,{leftColumnElements:[(0,t.jsx)(I,{program:n},"function-details"),w&&(0,t.jsx)(C.V,{onViewLogs:()=>X("log"),onDownloadLogs:M,downloadingLogs:O,disabled:S},"instance-logs-control"),(0,t.jsx)(K.Z,{payments:P},"instance-payment")],rightColumnElements:[k&&(0,t.jsx)(Q.Z,{nodeDetails:k,termsAndConditionsHash:null==n?void 0:null===(i=n.requirements)||void 0===i?void 0:null===(e=i.node)||void 0===e?void 0:e.terms_and_conditions},"instance-hosting-crn"),(0,t.jsx)(T,{loading:!n,runtimeVolumeId:null==n?void 0:n.runtime.ref,comment:null==n?void 0:n.runtime.comment,onRuntimeVolumeClick:el},"function-runtime"),(0,t.jsx)(q,{loading:!n,codebaseVolumeId:null==n?void 0:n.code.ref,entrypoint:null==n?void 0:n.code.entrypoint,onCodebaseVolumeClick:eo},"function-runtime"),Z.length>0&&(0,t.jsx)($.Z,{linkedVolumes:Z,onImmutableVolumeClick:ea},"instance-linked-volumes"),D.length>0&&(0,t.jsx)(ee.Z,{persistentVolumes:D},"instance-persistent-storage")]})}),(0,t.jsx)(v.M,{children:(0,t.jsxs)(ei,{children:[(0,t.jsx)(b.L,{onClick:()=>X("detail"),children:(0,t.jsx)(d.JO,{name:"angle-left",size:"1.3em"})}),(0,t.jsx)(en,{children:(0,t.jsx)(C.W,{logs:E})})]})})]}),(0,t.jsx)(W.Z,{title:et.title,isOpen:et.isOpen,onClose:es,children:"volume"===et.type?et.selectedVolumeId&&(0,t.jsx)(H.Z,{volumeId:et.selectedVolumeId}):(0,t.jsx)(t.Fragment,{children:"ERROR"})})]})}var ei=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-gkjpjs-0"})({display:"flex",width:"100%",gap:"2rem",paddingLeft:"3rem",paddingRight:"3rem",paddingTop:"1.5rem",paddingBottom:"1.5rem"}),en=(0,s.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-gkjpjs-1"})({display:"flex",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0.75rem"})}},function(e){e.O(0,[1505,4016,6146,9774,2888,179],function(){return e(e.s=56383)}),_N_E=e.O()}]);