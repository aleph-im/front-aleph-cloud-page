(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{6815:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/console/computing/confidential/[hash]",function(){return i(45963)}])},8252:function(e,n,i){"use strict";i.d(n,{o:function(){return useAuthorization}});var t=i(9754),r=i(67294),a=i(54976);function useAuthorization(){let[{authorization:e},n]=(0,t.mr)();return(0,r.useMemo)(()=>{n(new a._j({features:["confidentials"]}))},[n,!0]),e}},57125:function(e,n,i){"use strict";i.d(n,{y:function(){return useExecutableActions}});var t=i(67294),r=i(79632),a=i(68885),s=i(50586),o=i(36286),l=i(25819),c=i(9754),d=i(72036),m=i(49107),u=i(99978),h=i(86780),p=i(9324),v=i(36541),x=i(11163),f=i(85704),g=i(62283),y=i(82169);let StaticEVMAccount=class StaticEVMAccount extends g.TM{getChainMetadata(){let e=this.chain===l.Ek.AVAX?g.Nd.AVAX:this.chain===l.Ek.BASE?g.Nd.BASE:void 0;if(!e)throw Error("Invalid RPC network");return g.l2[e]}async getChainId(){let e=this.getChain();return l.DR[e].chainId}getChain(){return this.chain}async askPubKey(){}async sign(){return""}constructor(e,n){super(e),this.address=e,this.chain=n,this.wallet=Object.create(g.u6.prototype),this.wallet.connect=async()=>void 0,this.wallet.getCurrentChainId=async()=>this.getChainId();let{rpcUrls:i,chainName:t,chainId:r}=this.getChainMetadata(),a=new y.r(i.at(0),{name:t,chainId:(0,g.RW)(r)});this.wallet.provider=a}};var _=i(9911);function useExecutableActions(e){var n,i;let{manager:g,executable:y,subscribeLogs:j}=e,w=(null==y?void 0:null===(n=y.payment)||void 0===n?void 0:n.type)===o.uG.superfluid,C=null==y?void 0:y.id,N=function(e){let{executable:n,manager:i}=e,[r,a]=(0,t.useState)(void 0);return(0,t.useEffect)(()=>{if(!i||!n||r)return;async function request(){if(!i||!n)return;let e=await i.checkStatus(n);console.log("useExecutableStatus - status",e),a(e)}r||request();let e=setInterval(request,1e4);return()=>clearInterval(e)},[r,n,i]),r}({executable:y,manager:g}),[S,Z]=(0,c.mr)(),{account:I,blockchain:P}=S.connection,{dispatchDeleteEntity:b}=(0,v.w)({entityName:(null==y?void 0:y.type)||""}),D=(0,r.lm)(),[z,M]=(0,t.useState)();(0,t.useEffect)(()=>{let e=!1;return async function(){if(M(void 0),!g||!y)return;let n=await g.getAllocationCRN(y);e||M(n)}(),()=>{e=!0}},[y,g]);let k=(0,t.useMemo)(()=>{if(z)return{name:z.name||z.hash,url:z.address||""}},[z]),R=(0,t.useMemo)(()=>{let{url:e=""}=k||{};return a.B.normalizeUrl(e)},[k]),E=(0,t.useCallback)(e=>{if(!e||e===P)return;let n=l.DR[e];return(null==n?void 0:n.name)||e.toString()},[P]),A=(0,t.useCallback)(async e=>{try{if(!g)throw s.Z.ConnectYourWallet;if(!R||!C)throw s.Z.InvalidNode;await g.sendPostOperation({hostname:R,operation:e,vmId:C})}catch(e){null==D||D.add({variant:"error",title:"Error",text:null==e?void 0:e.message})}},[g,R,D,C]),B=(0,t.useCallback)(async()=>{if(!g)throw s.Z.ConnectYourWallet;if(!y)throw s.Z.InstanceNotFound;if(!w)throw s.Z.StreamNotSupported;try{var e;let n=null===(e=y.payment)||void 0===e?void 0:e.chain,i=E(n);if(i)throw s.Z.NetworkMismatch(i);if(w&&!(0,f.G)(I)||!z)throw s.Z.ConnectYourPaymentWallet;w&&await g.notifyCRNAllocation(z,y.id)}catch(e){null==D||D.add({variant:"error",title:"Error",text:null==e?void 0:e.message})}},[z,y,w,g,D,E,I]),T=!!(null==N?void 0:N.ipv6Parsed),F=!w||!T||!z,q=!w||T||!z,O=!T||!z,G=!y,H=(0,t.useCallback)(()=>A("stop"),[A]),U=(0,t.useCallback)(()=>A("reboot"),[A]),L=function(e){let{nodeUrl:n,vmId:i,tail:a=100,subscribe:s=!0}=e,o=(0,u.U)(),[l,c]=(0,t.useState)([]),[d,h]=(0,t.useState)([]),p=(0,r.$P)(l,200),v=(0,r.$P)(d,200),x=(0,t.useMemo)(()=>p.join("\n"),[p]),f=(0,t.useMemo)(()=>v.join("\n"),[v]),g=(0,t.useMemo)(()=>!o||!n||!i,[o,n,i]);return(0,t.useEffect)(()=>{let e=new m.ol,subscribeFeed=async()=>{if(!s||!o||!n||!i)return;let t=o.subscribeLogs({abort:e.promise,vmId:i,hostname:n});try{for await(let e of t){let n="stdout"===e.type?c:h;n(n=>{let i=n.concat(e.message);return i.slice(Math.max(i.length-a,0))})}}catch(e){console.error(e)}};return subscribeFeed(),()=>e.resolve()},[o,n,i,a,s]),g?void 0:{stdout:x,stderr:f}}({nodeUrl:R,vmId:C,subscribe:j}),W=(0,x.useRouter)(),{next:K,stop:X}=(0,h.A)({}),Y=(0,t.useCallback)(async()=>{if(!g)throw s.Z.ConnectYourWallet;if(!y)throw s.Z.InstanceNotFound;try{var e,n;let i=y.chain||(null===(e=y.payment)||void 0===e?void 0:e.chain),t=(null===(n=y.payment)||void 0===n?void 0:n.type)===o.uG.superfluid,r=E(i);if(r)throw s.Z.NetworkMismatch(r);if(t&&!(0,f.G)(I))throw s.Z.ConnectYourPaymentWallet;let a=t?await (0,d.OH)(I):void 0;b(y.id);try{let e=await g.getDelSteps(y),n=e.map(e=>h.n[e]),i=g.delSteps(y,a);for(;;){let{done:e}=await i.next();if(e)break;await K(n)}}catch(e){throw Z(new p.Wy({name:y.type,entities:[y]})),e}await W.replace(_.cr.console.home)}catch(t){console.error(t);let e=t.message,n=null==t?void 0:t.cause,i="string"==typeof n?n:null==n?void 0:n.message;null==D||D.add({variant:"error",title:"Error",text:e,detail:i})}finally{await X()}},[b,Z,y,g,K,W,X,D,I,E]),V=null==y?void 0:y.address,J=null==y?void 0:null===(i=y.payment)||void 0===i?void 0:i.chain,{data:$}=(0,r.GO)({doRequest:async()=>{if(!g||!y||!w||!V||!J)return;let e=new StaticEVMAccount(V,J);return g.getStreamPaymentDetails(y,e)},onSuccess:()=>null,flushData:!0,triggerOnMount:!0,triggerDeps:[null==y?void 0:y.id,w,V,J]});return{logs:L,nodeDetails:k,streamDetails:$,status:N,isAllocated:T,stopDisabled:F,startDisabled:q,rebootDisabled:O,deleteDisabled:G,logsDisabled:!L,handleStop:H,handleStart:B,handleReboot:U,handleDelete:Y}}},57261:function(e,n,i){"use strict";i.d(n,{G:function(){return useConfidentialManager}});var t=i(9754);function useConfidentialManager(){let[e]=(0,t.mr)(),{confidentialManager:n}=e.manager;return n}},99978:function(e,n,i){"use strict";i.d(n,{U:function(){return useInstanceManager}});var t=i(9754);function useInstanceManager(){let[e]=(0,t.mr)(),{instanceManager:n}=e.manager;return n}},18395:function(e,n,i){"use strict";i.d(n,{p:function(){return useSSHKeyManager}});var t=i(9754);function useSSHKeyManager(){let[e]=(0,t.mr)(),{sshKeyManager:n}=e.manager;return n}},75899:function(e,n,i){"use strict";i.d(n,{x:function(){return useRequestConfidentials}});var t=i(77205),r=i(57261);function useRequestConfidentials(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.G)();return(0,t.F)({...e,manager:n,name:"confidential"})}},68091:function(e,n,i){"use strict";i.d(n,{X:function(){return useRequestSSHKeys}});var t=i(18395),r=i(77205);function useRequestSSHKeys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.p)();return(0,r.F)({...e,manager:n,name:"ssh"})}},45963:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return ManageConfidential}});var t=i(85893),r=i(19521),a=i(34517),s=i(76696),o=i(9008),l=i.n(o),c=i(79632),d=i(9911),m=i(49107),u=i(11505),h=i(41664),p=i.n(h),v=i(93788),x=i(11163),f=i(67294),g=i(75899),y=i(8252),_=i(57125),j=i(57261),w=i(68091),C=i(77541),N=i(99983),S=i(10873);function ManageConfidential(){var e;let{authorized:n,theme:i,confidential:o,status:h,mappedKeys:Q,nodeDetails:ee,handleCopyHash:en,handleCopyConnect:ei,handleCopyIpv6:et,handleBack:er}=function(){let e=(0,r.Fg)(),n=(0,x.useRouter)(),{push:i,query:{hash:t}}=n,{confidentials:a}=(0,y.o)();(0,f.useEffect)(()=>{a||i(d.cr.console.home)},[a,i]);let{entities:s}=(0,g.x)({ids:t}),[o]=s||[],l=(0,j.G)(),m=(0,_.y)({executable:o,manager:l,subscribeLogs:!1}),{status:u}=m,{entities:h}=(0,w.X)(),p=(0,f.useMemo)(()=>(null==o?void 0:o.authorized_keys)&&h?o.authorized_keys.map(e=>h.find(n=>n.key===e)):[],[o,h]),v=(0,c.vx)((null==o?void 0:o.id)||""),C=(0,c.vx)((null==u?void 0:u.ipv6Parsed)||""),N=(0,c.vx)("ssh root@".concat(null==u?void 0:u.ipv6Parsed));return{...m,authorized:a,theme:e,confidential:o,status:u,mappedKeys:p,handleCopyHash:v,handleCopyConnect:N,handleCopyIpv6:C,handleBack:()=>{i(".")}}}();if(!n)return;if(!o)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.Z,{handleBack:er}),(0,t.jsx)(N.F,{children:(0,t.jsx)(Z,{children:"Loading..."})})]});let ea=(null==o?void 0:null===(e=o.metadata)||void 0===e?void 0:e.name)||(0,m.zN)(o.id),es=d.K_[o.type],eo=o.volumes;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l(),{children:[(0,t.jsx)("title",{children:"Console | Manage Confidential | Aleph Cloud"}),(0,t.jsx)("meta",{name:"description",content:"Manage your confidential instance on Aleph Cloud"})]}),(0,t.jsx)(v.Z,{handleBack:er}),(0,t.jsx)(I,{children:(0,t.jsxs)(N.F,{children:[(0,t.jsx)(P,{children:(0,t.jsxs)(b,{children:[(0,t.jsx)(D,{name:"alien-8bit",className:"text-main0"}),(0,t.jsx)("div",{className:"tp-body2",children:ea}),(0,t.jsx)(z,{kind:"secondary",variant:o.time<Date.now()-45e3&&(null==h?void 0:h.ipv6Parsed)?"success":"warning",children:(null==h?void 0:h.ipv6Parsed)?"READY":(0,t.jsxs)(M,{children:[(0,t.jsx)(k,{children:"CONFIRMING"}),(0,t.jsx)(u.s5,{strokeColor:i.color.base2,width:".8rem"})]})})]})}),(0,t.jsxs)(c.Jy,{children:[(0,t.jsxs)(R,{children:[(0,t.jsx)(E,{variant:"accent",children:es}),(0,t.jsxs)(A,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"ITEM HASH"}),(0,t.jsx)(s.Z,{iconName:"copy",onClick:en,children:o.id})]})]}),(0,t.jsx)(C.Z,{}),(0,t.jsxs)(B,{children:[(0,t.jsxs)(T,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"CORES"}),(0,t.jsx)("div",{children:(0,t.jsxs)(C.x,{children:[o.resources.vcpus," x86 64bit"]})})]}),(0,t.jsxs)(F,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"RAM"}),(0,t.jsx)("div",{children:(0,t.jsx)(C.x,{children:(0,m.Fx)(o.resources.memory,{from:"MiB",to:"GiB",displayUnit:!0})})})]}),(0,t.jsxs)(q,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"HDD"}),(0,t.jsx)("div",{children:(0,t.jsx)(C.x,{children:(0,m.Fx)(o.size,{from:"MiB",to:"GiB",displayUnit:!0})})})]})]}),(0,t.jsxs)(O,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"EXPLORER"}),(0,t.jsx)("div",{children:(0,t.jsx)("a",{className:"tp-body1 fs-16",href:o.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(C.x,{children:(0,m.bs)(o.url,80)})})})})]}),(0,t.jsx)(C.Z,{}),(0,t.jsxs)(G,{children:[(0,t.jsx)(c.DU,{type:"h7",as:"h2",color:"main0",children:"Connection methods"}),(0,t.jsxs)(H,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"SSH COMMAND"}),(0,t.jsx)("div",{children:h?(0,t.jsx)(s.Z,{iconName:"copy",onClick:ei,children:(0,t.jsxs)(C.x,{children:[">_ ssh root@",h.ipv6Parsed]})}):(0,t.jsxs)(U,{children:[(0,t.jsx)(L,{className:"tp-body1 fs-16 text-main2",children:"Allocating"}),(0,t.jsx)(u.g4,{width:".8rem",height:"1rem",color:i.color.main2})]})})]}),(0,t.jsxs)(W,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"IPv6"}),(0,t.jsx)("div",{children:h&&(0,t.jsx)(s.Z,{iconName:"copy",onClick:et,children:(0,t.jsx)(C.x,{children:h.ipv6Parsed})})})]})]}),(0,t.jsxs)(K,{children:[(0,t.jsx)(c.DU,{type:"h7",as:"h2",color:"main0",children:"Accessible for"}),(0,t.jsx)(X,{children:Q.map((e,n)=>e&&(0,t.jsxs)(Y,{children:[(0,t.jsxs)("div",{className:"tp-info text-main0",children:["SSH KEY #",n+1]}),(0,t.jsx)(p(),{className:"tp-body1 fs-16",href:"?hash="+e.id,referrerPolicy:"no-referrer",children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(C.x,{children:e.label})})})]},null==e?void 0:e.id))})]}),ee&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{}),(0,t.jsx)(c.DU,{type:"h7",as:"h2",color:"main0",children:"Current CRN"}),(0,t.jsxs)(V,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"NAME"}),(0,t.jsx)("div",{children:(0,t.jsx)(C.x,{children:ee.name})})]}),(0,t.jsxs)(J,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"URL"}),(0,t.jsx)("div",{children:(0,t.jsx)("a",{className:"tp-body1 fs-16",href:ee.url,target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(s.Z,{iconName:"square-up-right",children:(0,t.jsx)(C.x,{children:(0,m.bs)(ee.url,80)})})})})]})]}),eo.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C.Z,{}),(0,t.jsx)(c.DU,{type:"h7",as:"h2",color:"main0",children:"Linked Storage(s)"}),(0,t.jsx)(S.Z,{volumes:eo})]})]}),(0,t.jsx)($,{children:(0,t.jsx)(a.Z,{variant:"primary",href:"https://docs.aleph.im/computing/confidential/",target:"_blank",children:"Create new confidential instance"})})]})})]})}var Z=(0,r.ZP)(c.Jy).withConfig({displayName:"cmp___StyledNoisyContainer",componentId:"sc-nxv6z8-0"})({marginTop:"1rem",marginBottom:"1rem"}),I=(0,r.ZP)("section").withConfig({displayName:"cmp___StyledSection",componentId:"sc-nxv6z8-1"})({paddingLeft:"0px",paddingRight:"0px",paddingBottom:"1.5rem",paddingTop:"5rem","@media (min-width: 48rem)":{paddingTop:"2.5rem",paddingBottom:"2.5rem"}}),P=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv",componentId:"sc-nxv6z8-2"})({display:"flex",flexDirection:"column",flexWrap:"wrap",justifyContent:"space-between",gap:"1rem",paddingBottom:"1.25rem","@media (min-width: 48rem)":{flexDirection:"row"}}),b=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv2",componentId:"sc-nxv6z8-3"})({display:"flex",alignItems:"center"}),D=(0,r.ZP)(c.JO).withConfig({displayName:"cmp___StyledIcon",componentId:"sc-nxv6z8-4"})({marginRight:"1rem"}),z=(0,r.ZP)(c.__).withConfig({displayName:"cmp___StyledLabel",componentId:"sc-nxv6z8-5"})({marginLeft:"1rem"}),M=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv3",componentId:"sc-nxv6z8-6"})({display:"flex",alignItems:"center"}),k=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv4",componentId:"sc-nxv6z8-7"})({marginRight:"0.5rem"}),R=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv5",componentId:"sc-nxv6z8-8"})({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),E=(0,r.ZP)(c.Vp).withConfig({displayName:"cmp___StyledTag",componentId:"sc-nxv6z8-9"})({marginRight:"1rem",whiteSpace:"nowrap"}),A=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv6",componentId:"sc-nxv6z8-10"})({flex:"1 1 auto"}),B=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv7",componentId:"sc-nxv6z8-11"})({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex"}),T=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv8",componentId:"sc-nxv6z8-12"})({marginRight:"1.25rem"}),F=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv9",componentId:"sc-nxv6z8-13"})({marginRight:"1.25rem"}),q=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv10",componentId:"sc-nxv6z8-14"})({marginRight:"1.25rem"}),O=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv11",componentId:"sc-nxv6z8-15"})({marginRight:"1.25rem"}),G=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv12",componentId:"sc-nxv6z8-16"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),H=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv13",componentId:"sc-nxv6z8-17"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),U=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv14",componentId:"sc-nxv6z8-18"})({display:"flex",alignItems:"flex-end"}),L=(0,r.ZP)("span").withConfig({displayName:"cmp___StyledSpan",componentId:"sc-nxv6z8-19"})({marginRight:"0.25rem"}),W=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv15",componentId:"sc-nxv6z8-20"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),K=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv16",componentId:"sc-nxv6z8-21"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),X=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv17",componentId:"sc-nxv6z8-22"})({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex"}),Y=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv18",componentId:"sc-nxv6z8-23"})({marginRight:"1.25rem"}),V=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv19",componentId:"sc-nxv6z8-24"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),J=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv20",componentId:"sc-nxv6z8-25"})({marginTop:"1.25rem",marginBottom:"1.25rem"}),$=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv21",componentId:"sc-nxv6z8-26"})({marginTop:"5rem",textAlign:"center"})}},function(e){e.O(0,[1505,9512,9774,2888,179],function(){return e(e.s=6815)}),_N_E=e.O()}]);