"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4215],{14215:function(e,n,i){i.d(n,{Z:function(){return w}});var t=i(85893),r=i(57833),a=i(67294),s=i(73899),o=i(76696),c=i(77541),l=i(14685),d=i(11163),m=i(80380),u=i(25093),h=i(36924),x=i(36541),f=i(50586),p=i(86780),g=i(64688),j=i(57966),v=i(9911),y=i(47104),N=i(41664),Z=i.n(N);let DomainDetail=e=>{let{domainId:n,showDelete:i=!1}=e,{domain:r,status:N,rules:w,refEntity:L,handleDelete:G,disabledDelete:H,handleUpdate:W,disabledUpdate:J,handleRetry:K,handleCopyHash:V,handleCopyRef:Y}=function(e){let{domainId:n}=e,i=(0,d.useRouter)(),[{connection:{account:t}}]=(0,u.mr)(),{dispatchDeleteEntity:r}=(0,x.w)({entityName:"domain"}),{entities:o}=(0,h.d)({ids:n}),[c]=o||[],l=(0,g.S)(null==c?void 0:c.ref),y=function(e){let[n,i]=(0,a.useState)(void 0),t=(0,m.A)();return(0,a.useEffect)(()=>{if(!t||!e)return;async function request(){if(!t||!e)return;let n=await t.checkStatus(e);i(n)}request();let n=setInterval(request,1e4);return()=>clearInterval(n)},[e,t]),n}(c),N=(0,j.w)(c),Z=(0,m.A)(),{next:w,stop:D,noti:P}=(0,p.A)({}),k=(0,a.useMemo)(()=>!c,[c]),T=(0,a.useCallback)(async()=>{if(!Z)throw f.Z.ConnectYourWallet;if(!c)throw f.Z.DomainNotFound;let e=await Z.getDelSteps(),n=e.map(e=>p.n[e]),t=Z.delSteps(c);try{for(;;){let{done:e}=await t.next();if(e)break;await w(n)}r(c.id),await i.replace(v.cr.console.domain.home)}catch(t){console.error(t);let e=t.message,n=null==t?void 0:t.cause,i="string"==typeof n?n:null==n?void 0:n.message;null==P||P.add({variant:"error",title:"Error",text:e,detail:i})}finally{await D()}},[r,Z,c,w,i,D,P]),S=(0,a.useMemo)(()=>!c,[c]),C=(0,a.useCallback)(()=>{if(!c)throw f.Z.DomainNotFound;let e=new URLSearchParams({name:c.id,target:c.target,ref:c.ref});i.push("".concat(v.cr.console.domain.new,"/?").concat(e.toString()))},[i,c]),E=(0,a.useCallback)(async()=>{if(!Z)throw f.Z.ConnectYourWallet;if(!c)throw f.Z.DomainNotFound;try{await Z.retry(c),await i.replace("/")}catch(e){}},[c,Z,i]),b=(0,s.vx)((null==l?void 0:l.id)||""),R=(0,s.vx)((null==c?void 0:c.ref)||"");return{domain:c,status:y,rules:N,refEntity:l,account:t,handleDelete:T,disabledDelete:k,handleUpdate:C,disabledUpdate:S,handleRetry:E,handleCopyHash:b,handleCopyRef:R}}({domainId:n});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(D,{children:[(0,t.jsxs)(P,{children:[(0,t.jsx)(k,{name:"input-text",className:"text-main0"}),(0,t.jsx)("div",{className:"tp-body2",children:r?r.name||(0,l.zN)(r.id):(0,t.jsx)(y.Z,{width:"10rem"})}),(0,t.jsx)(T,{kind:"secondary",variant:(null==N?void 0:N.status)?"success":"error",children:(null==N?void 0:N.status)?"DOMAIN RECORDS CONFIGURED":"DOMAIN RECORDS NOT CONFIGURED"})]}),(0,t.jsxs)(S,{children:[(0,t.jsx)(s.zx,{kind:"default",variant:"tertiary",size:"md",onClick:()=>W(),disabled:J,children:"Update"}),i&&(0,t.jsx)(s.zx,{kind:"functional",variant:"error",size:"md",onClick:G,disabled:H,children:(0,t.jsx)(s.JO,{name:"trash"})})]})]}),(0,t.jsxs)(s.Jy,{children:[(0,t.jsxs)(C,{children:[(0,t.jsx)(E,{variant:"accent",children:r?v.K_[r.type]:(0,t.jsx)(y.Z,{width:"5rem",height:"1.3rem"})}),(0,t.jsxs)(b,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"NAME"}),r?(0,t.jsx)("a",{className:"tp-body1 fs-16",href:"https://".concat(r.name),target:"_blank",referrerPolicy:"no-referrer",children:(0,t.jsx)(o.Z,{iconName:"square-up-right",children:(0,t.jsx)(c.xv,{children:r.name})})}):(0,t.jsx)(c.xv,{children:(0,t.jsx)(y.Z,{width:"12rem"})})]})]}),(0,t.jsx)(c.Z0,{}),(0,t.jsxs)(R,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"TARGET"}),(0,t.jsx)("div",{children:(0,t.jsx)(c.xv,{children:r?r.target&&v.Ni[r.target]||"-":(0,t.jsx)(y.Z,{width:"5rem"})})})]}),(0,t.jsxs)(I,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"UPDATED ON"}),(0,t.jsx)("div",{children:r?(0,t.jsx)(c.xv,{className:"fs-10 tp-body1",children:r.date}):(0,t.jsx)(y.Z,{width:"5rem"})})]})]}),(0,t.jsxs)(M,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"REF"}),(0,t.jsx)("div",{children:(0,t.jsx)(o.Z,{iconName:"copy",onClick:Y,children:(0,t.jsx)(c.xv,{children:r?r.ref:(0,t.jsx)(y.Z,{width:"12rem"})})})})]}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z0,{}),(0,t.jsx)(s.DU,{type:"h7",as:"h2",color:"main0",children:"Status"}),(0,t.jsxs)(A,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"STATUS"}),(0,t.jsx)(c.xv,{children:(0,t.jsxs)(F,{children:[(0,t.jsx)(s.vo,{kind:N.status?"success":"warning",title:""}),N.status?"Properly configured":"Manual configuration is required"]})})]}),r&&!N.status&&w&&w.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(_,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"PENDING STEPS"}),w.map(e=>{let n=N.tasks_status[e.name];return(0,t.jsx)(c.xv,{children:(0,t.jsxs)(O,{children:[(0,t.jsx)(s.vo,{kind:n?"success":"warning",title:""}),(0,t.jsx)("div",{children:e.info})]})},e.name)})]}),(0,t.jsxs)(B,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"FINAL STEP"}),(0,t.jsx)(c.xv,{children:"After configuring the domain records you can retry to link them again here"})]}),(0,t.jsx)(U,{children:(0,t.jsx)(s.zx,{onClick:K,size:"md",variant:"secondary",color:"main0",kind:"default",children:"Retry"})})]})]}),r&&L?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z0,{}),(0,t.jsxs)(s.DU,{type:"h7",as:"h2",color:"main0",children:["Linked ",v.Ni[r.target]]}),(0,t.jsxs)(q,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"Target Resource"}),(0,t.jsx)(Z(),{className:"tp-body1 fs-16",href:("instance"===r.target?v.cr.console.computing.instances.home:"confidential"===r.target?v.cr.console.computing.confidentials.home:"program"===r.target?v.cr.console.computing.functions.home:v.cr.console.storage.volumes.home)+"/".concat(L.id),children:(0,t.jsx)(o.Z,{iconName:"square-up-right",children:"Details"})})]}),(0,t.jsxs)(z,{children:[(0,t.jsx)("div",{className:"tp-info text-main0",children:"ITEM HASH"}),(0,t.jsx)(o.Z,{iconName:"copy",onClick:V,children:L.id})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z0,{}),(0,t.jsx)(s.DU,{type:"h7",as:"h2",color:"main0",children:"Linked Resource"}),(0,t.jsx)(c.xv,{children:"The target resource is missing or has been deleted. "})]})]})]})};DomainDetail.displayName="DomainDetail";var w=(0,a.memo)(DomainDetail),D=(0,r.ZP)("div")({display:"flex",justifyContent:"space-between",paddingBottom:"1.25rem"}),P=(0,r.ZP)("div")({display:"flex",flexWrap:"wrap",alignItems:"center"}),k=(0,r.ZP)(s.JO)({marginRight:"1rem"}),T=(0,r.ZP)(s.__)({marginLeft:"1rem",marginTop:"0.25rem"}),S=(0,r.ZP)("div")({marginLeft:"0.5rem",display:"flex",flexWrap:"wrap",justifyContent:"flex-end",gap:"0.5rem","@media (min-width: 36rem)":{gap:"1rem"}}),C=(0,r.ZP)("div")({display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden"}),E=(0,r.ZP)(s.Vp)({marginRight:"1rem",whiteSpace:"nowrap"}),b=(0,r.ZP)("div")({flex:"1 1 auto"}),R=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem",display:"flex",flexDirection:"row"}),I=(0,r.ZP)("div")({paddingLeft:"3rem"}),M=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),A=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),F=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),_=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),O=(0,r.ZP)("div")({marginTop:"0.5rem",display:"flex"}),B=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),U=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),q=(0,r.ZP)("div")({marginTop:"1.25rem",marginBottom:"1.25rem"}),z=(0,r.ZP)("div").withConfig({displayName:"cmp___StyledDiv14",componentId:"sc-1nvdr5g-0"})({marginTop:"1.25rem",marginBottom:"1.25rem"})},64688:function(e,n,i){i.d(n,{S:function(){return useHashToEntity}});var t=i(67294),r=i(25093),a=i(9911),s=i(14685),o=i(1801);function useHashToEntity(e){let[n,i]=(0,t.useState)(void 0),c=function(e){let[n,i]=(0,t.useState)(void 0),r=(0,o.c)();return(0,t.useEffect)(()=>{if(!e){i(void 0);return}async function fetchMessage(e){if(!r)return;let n=await r.get(e),t=(0,s.gE)(n);i(t)}(async function(e){!function(e){let[,n,t]=e.split("/");return!!("string"==typeof n&&"string"==typeof t&&Object.values(a.py).includes(n))&&(i(n),!0)}(e)&&fetchMessage(e)})(e)},[e,r]),n}(e),l=function(e){let[n]=(0,r.mr)(),{domainManager:i,sshKeyManager:s,volumeManager:o,programManager:c,instanceManager:l,gpuInstanceManager:d,websiteManager:m,confidentialManager:u}=n.manager,h=(0,t.useMemo)(()=>({[a.py.Domain]:i,[a.py.SSHKey]:s,[a.py.Volume]:o,[a.py.Instance]:l,[a.py.GpuInstance]:d,[a.py.Program]:c,[a.py.Website]:m,[a.py.Confidential]:u}),[i,s,o,l,d,c,m,u]);if(e)return h[e]}(c);return(0,t.useEffect)(()=>{if(!e){i(void 0);return}(async function(e){if(!l)return;let n=await l.get(e);i(n)})(e)},[e,l]),n}},1801:function(e,n,i){i.d(n,{c:function(){return useMessageManager}});var t=i(25093);function useMessageManager(){let[e]=(0,t.mr)(),{messageManager:n}=e.manager;return n}},36924:function(e,n,i){i.d(n,{d:function(){return useRequestDomains}});var t=i(80380),r=i(77205);function useRequestDomains(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,t.A)();return(0,r.F)({...e,manager:n,name:"domain"})}}}]);